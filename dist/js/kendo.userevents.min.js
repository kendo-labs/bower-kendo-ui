/**
 * Copyright 2014 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Copyright 2014 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.core.min"],e)}(function(){return function(e){function t(e,t){var n=e.x.location,i=e.y.location,r=t.x.location,a=t.y.location,o=n-r,s=i-a;return{center:{x:(n+r)/2,y:(i+a)/2},distance:Math.sqrt(o*o+s*s)}}function n(e){var t,n,i,r=[],a=e.originalEvent,s=e.currentTarget,l=0;if(e.api)r.push({id:2,event:e,target:e.target,currentTarget:e.target,location:e});else if(e.type.match(/touch/))for(n=a?a.changedTouches:[],t=n.length;t>l;l++)i=n[l],r.push({location:i,event:e,target:i.target,currentTarget:s,id:i.identifier});else o.pointers||o.msPointers?r.push({location:a,event:e,target:e.target,currentTarget:s,id:a.pointerId}):r.push({id:1,event:e,target:e.target,currentTarget:s,location:e});return r}function i(t){var n,i,r;t.preventDefault(),n=e(t.data.root),i=n.closest(".k-widget").parent(),i[0]||(i=n.parent()),r=e.extend(!0,{},t,{target:n[0]}),i.trigger(e.Event(t.type,r))}function r(e){for(var t=a.eventMap.up.split(" "),n=0,i=t.length;i>n;n++)e(t[n])}var a=window.kendo,o=a.support,s=window.document,l=a.Class,c=a.Observable,u=e.now,d=e.extend,p=o.mobileOS,f=p&&p.android,h=800,m=o.browser.msie?5:0,g="press",v="hold",_="select",w="start",b="move",k="end",y="cancel",x="tap",C="release",T="gesturestart",S="gesturechange",D="gestureend",E="gesturetap",F=l.extend({init:function(e,t){var n=this;n.axis=e,n._updateLocationData(t),n.startLocation=n.location,n.velocity=n.delta=0,n.timeStamp=u()},move:function(e){var t=this,n=e["page"+t.axis],i=u(),r=i-t.timeStamp||1;(n||!f)&&(t.delta=n-t.location,t._updateLocationData(e),t.initialDelta=n-t.startLocation,t.velocity=t.delta/r,t.timeStamp=i)},_updateLocationData:function(e){var t=this,n=t.axis;t.location=e["page"+n],t.client=e["client"+n],t.screen=e["screen"+n]}}),A=l.extend({init:function(e,t,n){d(this,{x:new F("X",n.location),y:new F("Y",n.location),userEvents:e,target:t,currentTarget:n.currentTarget,initialTouch:n.target,id:n.id,pressEvent:n,_moved:!1,_finished:!1})},press:function(){this._holdTimeout=setTimeout(e.proxy(this,"_hold"),this.userEvents.minHold),this._trigger(g,this.pressEvent)},_hold:function(){this._trigger(v,this.pressEvent)},move:function(e){var t=this;if(!t._finished){if(t.x.move(e.location),t.y.move(e.location),!t._moved){if(t._withinIgnoreThreshold())return;if(P.current&&P.current!==t.userEvents)return t.dispose();t._start(e)}t._finished||t._trigger(b,e)}},end:function(e){var t=this;t.endTime=u(),t._finished||(t._finished=!0,t._moved?t._trigger(k,e):t._trigger(x,e),clearTimeout(t._holdTimeout),t._trigger(C,e),t.dispose())},dispose:function(){var t=this.userEvents,n=t.touches;this._finished=!0,this.pressEvent=null,clearTimeout(this._holdTimeout),n.splice(e.inArray(this,n),1)},skip:function(){this.dispose()},cancel:function(){this.dispose()},isMoved:function(){return this._moved},_start:function(e){clearTimeout(this._holdTimeout),this.startTime=u(),this._moved=!0,this._trigger(w,e)},_trigger:function(e,t){var n=this,i=t.event,r={touch:n,x:n.x,y:n.y,target:n.target,event:i};n.userEvents.notify(e,r)&&i.preventDefault()},_withinIgnoreThreshold:function(){var e=this.x.initialDelta,t=this.y.initialDelta;return Math.sqrt(e*e+t*t)<=this.userEvents.threshold}}),P=c.extend({init:function(t,n){var i,l,u,p=this,f=a.guid();n=n||{},i=p.filter=n.filter,p.threshold=n.threshold||m,p.minHold=n.minHold||h,p.touches=[],p._maxTouches=n.multiTouch?2:1,p.allowSelection=n.allowSelection,p.captureUpIfMoved=n.captureUpIfMoved,p.eventNS=f,t=e(t).handler(p),c.fn.init.call(p),d(p,{element:t,surface:n.global?e(s.documentElement):e(n.surface||t),stopPropagation:n.stopPropagation,pressed:!1}),p.surface.handler(p).on(a.applyEventMap("move",f),"_move").on(a.applyEventMap("up cancel",f),"_end"),t.on(a.applyEventMap("down",f),i,"_start"),(o.pointers||o.msPointers)&&t.css("-ms-touch-action","pinch-zoom double-tap-zoom"),n.preventDragEvent&&t.on(a.applyEventMap("dragstart",f),a.preventDefault),t.on(a.applyEventMap("mousedown selectstart",f),i,{root:t},"_select"),p.captureUpIfMoved&&o.eventCapture&&(l=p.surface[0],u=e.proxy(p.preventIfMoving,p),r(function(e){l.addEventListener(e,u,!0)})),p.bind([g,v,x,w,b,k,C,y,T,S,D,E,_],n)},preventIfMoving:function(e){this._isMoved()&&e.preventDefault()},destroy:function(){var e,t=this;t._destroyed||(t._destroyed=!0,t.captureUpIfMoved&&o.eventCapture&&(e=t.surface[0],r(function(n){e.removeEventListener(n,t.preventIfMoving)})),t.element.kendoDestroy(t.eventNS),t.surface.kendoDestroy(t.eventNS),t.element.removeData("handler"),t.surface.removeData("handler"),t._disposeAll(),t.unbind(),delete t.surface,delete t.element,delete t.currentTarget)},capture:function(){P.current=this},cancel:function(){this._disposeAll(),this.trigger(y)},notify:function(e,n){var i=this,r=i.touches;if(this._isMultiTouch()){switch(e){case b:e=S;break;case k:e=D;break;case x:e=E}d(n,{touches:r},t(r[0],r[1]))}return this.trigger(e,n)},press:function(e,t,n){this._apiCall("_start",e,t,n)},move:function(e,t){this._apiCall("_move",e,t)},end:function(e,t){this._apiCall("_end",e,t)},_isMultiTouch:function(){return this.touches.length>1},_maxTouchesReached:function(){return this.touches.length>=this._maxTouches},_disposeAll:function(){for(var e=this.touches;e.length>0;)e.pop().dispose()},_isMoved:function(){return e.grep(this.touches,function(e){return e.isMoved()}).length},_select:function(e){(!this.allowSelection||this.trigger(_,{event:e}))&&i(e)},_start:function(t){var i,r,a=this,o=0,s=a.filter,l=n(t),c=l.length,u=t.which;if(!(u&&u>1||a._maxTouchesReached()))for(P.current=null,a.currentTarget=t.currentTarget,a.stopPropagation&&t.stopPropagation();c>o&&!a._maxTouchesReached();o++)r=l[o],i=s?e(r.currentTarget):a.element,i.length&&(r=new A(a,i,r),a.touches.push(r),r.press(),a._isMultiTouch()&&a.notify("gesturestart",{}))},_move:function(e){this._eachTouch("move",e)},_end:function(e){this._eachTouch("end",e)},_eachTouch:function(e,t){var i,r,a,o,s=this,l={},c=n(t),u=s.touches;for(i=0;u.length>i;i++)r=u[i],l[r.id]=r;for(i=0;c.length>i;i++)a=c[i],o=l[a.id],o&&o[e](a)},_apiCall:function(t,n,i,r){this[t]({api:!0,pageX:n,pageY:i,clientX:n,clientY:i,target:e(r||this.element)[0],stopPropagation:e.noop,preventDefault:e.noop})}});P.minHold=function(e){h=e},a.getTouches=n,a.touchDelta=t,a.UserEvents=P}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});