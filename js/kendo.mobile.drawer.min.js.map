{"version":3,"file":"kendo.mobile.drawer.min.js","sources":["kendo.mobile.drawer.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.mobile.drawer',[ \"kendo.mobile.view\", \"kendo.userevents\" ], f);\n})(function() {\n\nvar __meta__ = {\n    id: \"mobile.drawer\",\n    name: \"Drawer\",\n    category: \"mobile\",\n    description: \"The Kendo Mobile Drawer widget provides slide to reveal global application toolbox\",\n    depends: [ \"mobile.view\", \"userevents\" ]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        mobile = kendo.mobile,\n        os = kendo.support.mobileOS,\n        Transition = kendo.effects.Transition,\n        roleSelector = kendo.roleSelector,\n        AXIS = \"x\",\n        ui = mobile.ui,\n        SWIPE_TO_OPEN = !(os.ios && os.majorVersion == 7 && !os.appMode),\n        BEFORE_SHOW = \"beforeShow\",\n        INIT = \"init\",\n        SHOW = \"show\",\n        HIDE = \"hide\",\n        AFTER_HIDE = \"afterHide\",\n        NULL_VIEW = { enable: $.noop };\n\n    var Drawer = ui.View.extend({\n        init: function(element, options) {\n            // move the drawer to the top, in order to hide it\n            $(element).parent().prepend(element);\n\n            mobile.ui.Widget.fn.init.call(this, element, options);\n\n            if (!this.options.$angular) {\n                this._layout();\n                this._scroller();\n            }\n\n            this._model();\n\n            var pane = this.element.closest(roleSelector(\"pane\")).data(\"kendoMobilePane\"),\n                userEvents;\n\n            if (pane) {\n                this.pane = pane;\n                this.pane.bind(\"viewShow\", function(e) {\n                    drawer._viewShow(e);\n                });\n\n                this.pane.bind(\"sameViewRequested\", function() {\n                    drawer.hide();\n                });\n\n                userEvents = this.userEvents = new kendo.UserEvents(pane.element, {\n                    fastTap: true,\n                    filter: roleSelector(\"view splitview\"),\n                    allowSelection: true\n                });\n\n            } else {\n                this.currentView = NULL_VIEW;\n                var container = $(this.options.container);\n\n                if (!container) {\n                    throw new Error(\"The drawer needs a container configuration option set.\");\n                }\n\n                userEvents = this.userEvents = new kendo.UserEvents(container, { fastTap: true, allowSelection: true });\n                this._attachTransition(container);\n            }\n\n            var drawer = this;\n\n            var hide = function(e) {\n                if (drawer.visible) {\n                    drawer.hide();\n                    e.preventDefault();\n                }\n            };\n\n            if (this.options.swipeToOpen && SWIPE_TO_OPEN) {\n                userEvents.bind(\"press\", function() { drawer.transition.cancel(); });\n                userEvents.bind(\"start\", function(e) { drawer._start(e); });\n                userEvents.bind(\"move\", function(e) { drawer._update(e); });\n                userEvents.bind(\"end\", function(e) { drawer._end(e); });\n                userEvents.bind(\"tap\", hide);\n            } else {\n                userEvents.bind(\"press\", hide);\n            }\n\n            this.leftPositioned = this.options.position === \"left\";\n\n            this.visible = false;\n\n            this.element.hide().addClass(\"km-drawer\").addClass(this.leftPositioned ? \"km-left-drawer\" : \"km-right-drawer\");\n            this.trigger(INIT);\n        },\n\n        options: {\n            name: \"Drawer\",\n            position: \"left\",\n            views: [],\n            swipeToOpenViews: [],\n            swipeToOpen: true,\n            title: \"\",\n            container: null\n        },\n\n        events: [\n            BEFORE_SHOW,\n            HIDE,\n            AFTER_HIDE,\n            INIT,\n            SHOW\n        ],\n\n        show: function() {\n            if (this._activate()) {\n                this._show();\n            }\n        },\n\n        hide: function() {\n            if (!this.currentView) {\n                return;\n            }\n\n            this.currentView.enable();\n\n            Drawer.current = null;\n            this._moveViewTo(0);\n            this.trigger(HIDE, { view: this });\n        },\n\n        // Alias in order to support popover/modalview etc. interface\n        openFor: function() {\n            if (this.visible) {\n                this.hide();\n            } else {\n                this.show();\n            }\n        },\n\n        destroy: function() {\n            ui.View.fn.destroy.call(this);\n            this.userEvents.destroy();\n        },\n\n        _activate: function() {\n            if (this.visible) {\n                return true;\n            }\n\n            var visibleOnCurrentView = this._currentViewIncludedIn(this.options.views);\n\n            if (!visibleOnCurrentView || this.trigger(BEFORE_SHOW, { view: this })) {\n                return false;\n            }\n\n            this._setAsCurrent();\n            this.element.show();\n\n            this.trigger(SHOW, { view: this });\n            this._invokeNgController();\n            return true;\n        },\n\n        _currentViewIncludedIn: function(views) {\n            if (!this.pane || !views.length) {\n                return true;\n            }\n\n            var view = this.pane.view();\n            return $.inArray(view.id.replace('#', ''), views) > -1 || $.inArray(view.element.attr(\"id\"), views) > -1;\n        },\n\n        _show: function() {\n            this.currentView.enable(false);\n\n            this.visible = true;\n            var offset = this.element.width();\n\n            if (!this.leftPositioned) {\n                offset = -offset;\n            }\n\n            this._moveViewTo(offset);\n        },\n\n        _setAsCurrent: function() {\n            if (Drawer.last !== this) {\n                if (Drawer.last) {\n                    Drawer.last.element.hide();\n                }\n                this.element.show();\n            }\n\n            Drawer.last = this;\n            Drawer.current = this;\n        },\n\n        _moveViewTo: function(offset) {\n            this.userEvents.cancel();\n            this.transition.moveTo({ location: offset, duration: 400, ease: Transition.easeOutExpo });\n        },\n\n        _viewShow: function(e) {\n            if (this.currentView) {\n                this.currentView.enable();\n            }\n\n            if (this.currentView === e.view) {\n                this.hide();\n                return;\n            }\n\n            this.currentView = e.view;\n            this._attachTransition(e.view.element);\n        },\n\n        _attachTransition: function(element) {\n            var that = this,\n                movable = this.movable,\n                currentOffset = movable && movable.x;\n\n\n            if (this.transition) {\n                this.transition.cancel();\n                this.movable.moveAxis(\"x\", 0);\n            }\n\n            movable = this.movable = new kendo.ui.Movable(element);\n\n            this.transition = new Transition({\n                axis: AXIS,\n                movable: this.movable,\n                onEnd: function() {\n                    if (movable[AXIS] === 0) {\n                        element[0].style.cssText = \"\";\n                        that.element.hide();\n                        that.trigger(AFTER_HIDE);\n                        that.visible = false;\n                    }\n                }\n            });\n\n            if (currentOffset) {\n                element.addClass(\"k-fx-hidden\");\n                kendo.animationFrame(function() {\n                    element.removeClass(\"k-fx-hidden\");\n                    that.movable.moveAxis(AXIS, currentOffset);\n                    that.hide();\n                });\n            }\n        },\n\n        _start: function(e) {\n            var userEvents = e.sender;\n\n            // ignore non-horizontal swipes\n            if (Math.abs(e.x.velocity) < Math.abs(e.y.velocity) || kendo.triggeredByInput(e.event) || !this._currentViewIncludedIn(this.options.swipeToOpenViews)) {\n                userEvents.cancel();\n                return;\n            }\n\n            var leftPositioned = this.leftPositioned,\n                visible = this.visible,\n                canMoveLeft = leftPositioned && visible || !leftPositioned && !Drawer.current,\n                canMoveRight = !leftPositioned && visible || leftPositioned && !Drawer.current,\n                leftSwipe = e.x.velocity < 0;\n\n            if ((canMoveLeft && leftSwipe) || (canMoveRight && !leftSwipe)) {\n                if (this._activate()) {\n                    userEvents.capture();\n                    return;\n                }\n            }\n\n            userEvents.cancel();\n        },\n\n        _update: function(e) {\n            var movable = this.movable,\n                newPosition = movable.x + e.x.delta,\n                limitedPosition;\n\n            if (this.leftPositioned) {\n                limitedPosition = Math.min(Math.max(0, newPosition), this.element.width());\n            } else {\n                limitedPosition = Math.max(Math.min(0, newPosition), -this.element.width());\n            }\n\n            this.movable.moveAxis(AXIS, limitedPosition);\n            e.event.preventDefault();\n            e.event.stopPropagation();\n        },\n\n        _end: function(e) {\n            var velocity = e.x.velocity,\n                pastHalf = Math.abs(this.movable.x) > this.element.width() / 2,\n                velocityThreshold = 0.8,\n                shouldShow;\n\n            if (this.leftPositioned) {\n                shouldShow = velocity > -velocityThreshold && (velocity > velocityThreshold || pastHalf);\n            } else {\n                shouldShow = velocity < velocityThreshold && (velocity < -velocityThreshold || pastHalf);\n            }\n\n            if (shouldShow) {\n                this._show();\n            } else {\n                this.hide();\n            }\n        }\n    });\n\n    ui.plugin(Drawer);\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","$","window","kendo","jQuery","undefined","mobile","os","support","mobileOS","Transition","effects","roleSelector","AXIS","ui","SWIPE_TO_OPEN","ios","majorVersion","appMode","BEFORE_SHOW","INIT","SHOW","HIDE","AFTER_HIDE","NULL_VIEW","enable","noop","Drawer","View","extend","init","element","options","parent","prepend","Widget","fn","call","this","$angular","_layout","_scroller","_model","pane","closest","data","userEvents","bind","e","drawer","_viewShow","hide","UserEvents","fastTap","filter","allowSelection","currentView","container","Error","_attachTransition","visible","preventDefault","swipeToOpen","transition","cancel","_start","_update","_end","leftPositioned","position","addClass","trigger","views","swipeToOpenViews","title","events","show","_activate","_show","current","_moveViewTo","view","openFor","destroy","visibleOnCurrentView","_currentViewIncludedIn","_setAsCurrent","_invokeNgController","length","inArray","replace","attr","offset","width","last","moveTo","location","duration","ease","easeOutExpo","that","movable","currentOffset","x","moveAxis","Movable","axis","onEnd","style","cssText","animationFrame","removeClass","sender","Math","abs","velocity","y","triggeredByInput","event","canMoveLeft","canMoveRight","leftSwipe","capture","newPosition","delta","limitedPosition","min","max","stopPropagation","pastHalf","velocityThreshold","shouldShow","plugin","amd","a1","a2","a3"],"mappings":"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"}