{"version":3,"file":"kendo.mobile.view.min.js","sources":["kendo.mobile.view.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.mobile.view',[ \"kendo.core\", \"kendo.fx\", \"kendo.mobile.scroller\", \"kendo.view\" ], f);\n})(function() {\n\nvar __meta__ = {\n    id: \"mobile.view\",\n    name: \"View\",\n    category: \"mobile\",\n    description: \"Mobile View\",\n    depends: [ \"core\", \"fx\", \"mobile.scroller\", \"view\" ],\n    hidden: true\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        mobile = kendo.mobile,\n        ui = mobile.ui,\n        attr = kendo.attr,\n        Widget = ui.Widget,\n        ViewClone = kendo.ViewClone,\n        INIT = \"init\",\n        UI_OVERLAY = '<div style=\"height: 100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 20000; display: none\"></div>',\n        BEFORE_SHOW = \"beforeShow\",\n        SHOW = \"show\",\n        AFTER_SHOW = \"afterShow\",\n        BEFORE_HIDE = \"beforeHide\",\n        TRANSITION_END = \"transitionEnd\",\n        TRANSITION_START = \"transitionStart\",\n        HIDE = \"hide\",\n        DESTROY = \"destroy\",\n        attrValue = kendo.attrValue,\n        roleSelector = kendo.roleSelector,\n        directiveSelector = kendo.directiveSelector,\n        compileMobileDirective = kendo.compileMobileDirective;\n\n    function initPopOvers(element) {\n        var popovers = element.find(roleSelector(\"popover\")),\n            idx, length,\n            roles = ui.roles;\n\n        for (idx = 0, length = popovers.length; idx < length; idx ++) {\n            kendo.initWidget(popovers[idx], {}, roles);\n        }\n    }\n\n    function preventScrollIfNotInput(e) {\n        if (!kendo.triggeredByInput(e)) {\n            e.preventDefault();\n        }\n    }\n\n    var View = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n            this.params = {};\n\n            $.extend(this, options);\n\n            this.transition = this.transition || this.defaultTransition;\n\n            this._id();\n\n            if (!this.options.$angular) {\n                this._layout();\n                this._overlay();\n                this._scroller();\n                this._model();\n            } else {\n                this._overlay();\n            }\n        },\n\n        events: [\n            INIT,\n            BEFORE_SHOW,\n            SHOW,\n            AFTER_SHOW,\n            BEFORE_HIDE,\n            HIDE,\n            DESTROY,\n            TRANSITION_START,\n            TRANSITION_END\n        ],\n\n        options: {\n            name: \"View\",\n            title: \"\",\n            layout: null,\n            getLayout: $.noop,\n            reload: false,\n            transition: \"\",\n            defaultTransition: \"\",\n            useNativeScrolling: false,\n            stretch: false,\n            zoom: false,\n            model: null,\n            modelScope: window,\n            scroller: {},\n            initWidgets: true\n        },\n\n        enable: function(enable) {\n            if (typeof enable == \"undefined\") {\n                enable = true;\n            }\n\n            if (enable) {\n                this.overlay.hide();\n            } else {\n                this.overlay.show();\n            }\n        },\n\n        destroy: function() {\n            if (this.layout) {\n                this.layout.detach(this);\n            }\n\n            this.trigger(DESTROY);\n\n\n            Widget.fn.destroy.call(this);\n\n            if (this.scroller) {\n                this.scroller.destroy();\n            }\n\n            if (this.options.$angular) {\n                this.element.scope().$destroy();\n            }\n\n            kendo.destroy(this.element);\n        },\n\n        purge: function() {\n            this.destroy();\n            this.element.remove();\n        },\n\n        triggerBeforeShow: function() {\n            if (this.trigger(BEFORE_SHOW, { view: this })) {\n                return false;\n            }\n            return true;\n        },\n\n        triggerBeforeHide: function() {\n            if (this.trigger(BEFORE_HIDE, { view: this })) {\n                return false;\n            }\n            return true;\n        },\n\n        showStart: function() {\n            var element = this.element;\n\n            element.css(\"display\", \"\");\n\n            if (!this.inited) {\n                this.inited = true;\n                this.trigger(INIT, { view: this });\n            } else { // skip the initial controller update\n                this._invokeNgController();\n            }\n\n            if (this.layout) {\n                this.layout.attach(this);\n            }\n\n            this._padIfNativeScrolling();\n            this.trigger(SHOW, { view: this });\n            kendo.resize(element);\n        },\n\n        showEnd: function() {\n            this.trigger(AFTER_SHOW, { view: this });\n            this._padIfNativeScrolling();\n        },\n\n        hideEnd: function() {\n            var that = this;\n            that.element.hide();\n            that.trigger(HIDE, { view: that });\n\n            if (that.layout) {\n                that.layout.trigger(HIDE, { view: that, layout: that.layout });\n            }\n        },\n\n        beforeTransition: function(type) {\n            this.trigger(TRANSITION_START, { type: type });\n        },\n\n        afterTransition: function(type) {\n            this.trigger(TRANSITION_END, { type: type });\n        },\n\n        _padIfNativeScrolling: function() {\n            if (mobile.appLevelNativeScrolling()) {\n                var isAndroid = kendo.support.mobileOS && kendo.support.mobileOS.android,\n                    skin = mobile.application.skin() || \"\",\n                    isAndroidForced = mobile.application.os.android || (skin.indexOf(\"android\") > -1),\n                    hasPlatformIndependentSkin = skin === \"flat\" || (skin.indexOf(\"material\") > -1),\n                    topContainer = (isAndroid || isAndroidForced) && (!hasPlatformIndependentSkin) ? \"footer\" : \"header\",\n                    bottomContainer = (isAndroid || isAndroidForced) && (!hasPlatformIndependentSkin) ? \"header\" : \"footer\";\n\n                this.content.css({\n                    paddingTop: this[topContainer].height(),\n                    paddingBottom: this[bottomContainer].height()\n                });\n            }\n        },\n\n        contentElement: function() {\n            var that = this;\n\n            return that.options.stretch ? that.content : that.scrollerContent;\n        },\n\n        clone: function() {\n            return new ViewClone(this);\n        },\n\n        _scroller: function() {\n            var that = this;\n\n            if (mobile.appLevelNativeScrolling()) {\n                return;\n            }\n            if (that.options.stretch) {\n                that.content.addClass(\"km-stretched-view\");\n            } else {\n                that.content.kendoMobileScroller($.extend(that.options.scroller, { zoom: that.options.zoom, useNative: that.options.useNativeScrolling }));\n\n                that.scroller = that.content.data(\"kendoMobileScroller\");\n                that.scrollerContent = that.scroller.scrollElement;\n            }\n\n            // prevent accidental address bar display when pulling the header\n            if (kendo.support.kineticScrollNeeded) {\n                $(that.element).on(\"touchmove\", \".km-header\", preventScrollIfNotInput);\n                if (!that.options.useNativeScrolling && !that.options.stretch) {\n                    $(that.element).on(\"touchmove\", \".km-content\", preventScrollIfNotInput);\n                }\n            }\n        },\n\n        _model: function() {\n            var that = this,\n                element = that.element,\n                model = that.options.model;\n\n            if (typeof model === \"string\") {\n                model = kendo.getter(model)(that.options.modelScope);\n            }\n\n            that.model = model;\n\n            initPopOvers(element);\n\n            that.element.css(\"display\", \"\");\n            if (that.options.initWidgets) {\n                if (model) {\n                    kendo.bind(element, model, ui, kendo.ui, kendo.dataviz.ui);\n                } else {\n                    mobile.init(element.children());\n                }\n            }\n            that.element.css(\"display\", \"none\");\n        },\n\n        _id: function() {\n            var element = this.element,\n                idAttrValue = element.attr(\"id\") || \"\";\n\n            this.id = attrValue(element, \"url\") || \"#\" + idAttrValue;\n\n            if (this.id == \"#\") {\n                this.id = kendo.guid();\n                element.attr(\"id\", this.id);\n            }\n        },\n\n        _layout: function() {\n            var contentSelector = roleSelector(\"content\"),\n                element = this.element;\n\n            element.addClass(\"km-view\");\n\n            this.header = element.children(roleSelector(\"header\")).addClass(\"km-header\");\n            this.footer = element.children(roleSelector(\"footer\")).addClass(\"km-footer\");\n\n            if (!element.children(contentSelector)[0]) {\n              element.wrapInner(\"<div \" + attr(\"role\") + '=\"content\"></div>');\n            }\n\n            this.content = element.children(roleSelector(\"content\"))\n                                .addClass(\"km-content\");\n\n            this.element.prepend(this.header).append(this.footer);\n\n\n            this.layout = this.options.getLayout(this.layout);\n\n            if (this.layout) {\n                this.layout.setup(this);\n            }\n        },\n\n        _overlay: function() {\n            this.overlay = $(UI_OVERLAY).appendTo(this.element);\n        },\n\n        _invokeNgController: function() {\n            var controller,\n                scope;\n\n            if (this.options.$angular) {\n                controller = this.element.controller();\n                scope = this.options.$angular[0];\n\n                if (controller) {\n                    var callback = this._callController.bind(this, controller, scope);\n\n                    if (/^\\$(digest|apply)$/.test(scope.$$phase)) {\n                        callback();\n                    } else {\n                        scope.$apply(callback);\n                    }\n                }\n            }\n        },\n\n        _callController: function(controller, scope) {\n            this.element.injector().invoke(controller.constructor, controller, { $scope: scope });\n        }\n    });\n\n    function initWidgets(collection) {\n        collection.each(function() {\n            kendo.initWidget($(this), {}, ui.roles);\n        });\n    }\n\n    var Layout = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n\n            element = this.element;\n\n            this.header = element.children(this._locate(\"header\")).addClass(\"km-header\");\n            this.footer = element.children(this._locate(\"footer\")).addClass(\"km-footer\");\n            this.elements = this.header.add(this.footer);\n\n            initPopOvers(element);\n\n            if (!this.options.$angular) {\n                kendo.mobile.init(this.element.children());\n            }\n            this.element.detach();\n            this.trigger(INIT, { layout: this });\n        },\n\n        _locate: function(selectors) {\n            return this.options.$angular ? directiveSelector(selectors) : roleSelector(selectors);\n        },\n\n        options: {\n            name: \"Layout\",\n            id: null,\n            platform: null\n        },\n\n        events: [\n            INIT,\n            SHOW,\n            HIDE\n        ],\n\n        setup: function(view) {\n            if (!view.header[0]) { view.header = this.header; }\n            if (!view.footer[0]) { view.footer = this.footer; }\n        },\n\n        detach: function(view) {\n            var that = this;\n            if (view.header === that.header && that.header[0]) {\n                view.element.prepend(that.header.detach()[0].cloneNode(true));\n            }\n\n            if (view.footer === that.footer && that.footer.length) {\n                view.element.append(that.footer.detach()[0].cloneNode(true));\n            }\n        },\n\n        attach: function(view) {\n            var that = this,\n                previousView = that.currentView;\n\n            if (previousView) {\n                that.detach(previousView);\n            }\n\n            if (view.header === that.header) {\n                that.header.detach();\n                view.element.children(roleSelector(\"header\")).remove();\n                view.element.prepend(that.header);\n            }\n\n            if (view.footer === that.footer) {\n                that.footer.detach();\n                view.element.children(roleSelector(\"footer\")).remove();\n                view.element.append(that.footer);\n            }\n\n            that.trigger(SHOW, { layout: that, view: view });\n            that.currentView = view;\n        }\n    });\n\n    var Observable = kendo.Observable,\n        bodyRegExp = /<body[^>]*>(([\\u000a\\u000d\\u2028\\u2029]|.)*)<\\/body>/i,\n        LOAD_START = \"loadStart\",\n        LOAD_COMPLETE = \"loadComplete\",\n        SHOW_START = \"showStart\",\n        SAME_VIEW_REQUESTED = \"sameViewRequested\",\n        VIEW_SHOW = \"viewShow\",\n        VIEW_TYPE_DETERMINED = \"viewTypeDetermined\",\n        AFTER = \"after\";\n\n    var ViewEngine = Observable.extend({\n        init: function(options) {\n            var that = this,\n                views,\n                errorMessage,\n                container,\n                collection;\n\n            Observable.fn.init.call(that);\n\n            $.extend(that, options);\n            that.sandbox = $(\"<div />\");\n            container = that.container;\n\n            views = that._hideViews(container);\n            that.rootView = views.first();\n\n            if (!that.rootView[0] && options.rootNeeded) {\n                if (container[0] == kendo.mobile.application.element[0]) {\n                    errorMessage = 'Your kendo mobile application element does not contain any direct child elements with data-role=\"view\" attribute set. Make sure that you instantiate the mobile application using the correct container.';\n                } else {\n                    errorMessage = 'Your pane element does not contain any direct child elements with data-role=\"view\" attribute set.';\n                }\n                throw new Error(errorMessage);\n            }\n\n            that.layouts = {};\n\n            that.viewContainer = new kendo.ViewContainer(that.container);\n\n            that.viewContainer.bind(\"accepted\", function(e) {\n                e.view.params = that.params;\n            });\n\n            that.viewContainer.bind(\"complete\", function(e) {\n                that.trigger(VIEW_SHOW, { view: e.view });\n            });\n\n            that.viewContainer.bind(AFTER, function() {\n                that.trigger(AFTER);\n            });\n\n            this.getLayoutProxy = this._getLayout.bind(this);\n            that._setupLayouts(container);\n\n            collection = container.children(that._locate(\"modalview drawer\"));\n            if (that.$angular) {\n\n                that.$angular[0].viewOptions = {\n                    defaultTransition: that.transition,\n                    loader: that.loader,\n                    container: that.container,\n                    getLayout: that.getLayoutProxy\n                };\n\n                collection.each(function(idx, element) {\n                    compileMobileDirective($(element), options.$angular[0]);\n                });\n            } else {\n                initWidgets(collection);\n            }\n\n            this.bind(this.events, options);\n        },\n\n        events: [\n            SHOW_START,\n            AFTER,\n            VIEW_SHOW,\n            LOAD_START,\n            LOAD_COMPLETE,\n            SAME_VIEW_REQUESTED,\n            VIEW_TYPE_DETERMINED\n        ],\n\n        destroy: function() {\n            kendo.destroy(this.container);\n\n            for (var id in this.layouts) {\n                this.layouts[id].destroy();\n            }\n        },\n\n        view: function() {\n            return this.viewContainer.view;\n        },\n\n        showView: function(url, transition, params) {\n            url = url.replace(new RegExp(\"^\" + this.remoteViewURLPrefix), \"\");\n            if (url === \"\" && this.remoteViewURLPrefix) {\n                url = \"/\";\n            }\n\n            if (url.replace(/^#/, \"\") === this.url) {\n                this.trigger(SAME_VIEW_REQUESTED);\n                return false;\n            }\n\n            this.trigger(SHOW_START);\n\n            var that = this,\n                showClosure = function(view) {\n                    return that.viewContainer.show(view, transition, url);\n                },\n                element = that._findViewElement(url),\n                view = kendo.widgetInstance(element);\n\n            that.url = url.replace(/^#/, \"\");\n\n            that.params = params;\n\n            if (view && view.reload) {\n                view.purge();\n                element = [];\n            }\n\n            this.trigger(VIEW_TYPE_DETERMINED, { remote: element.length === 0, url: url });\n\n            if (element[0]) {\n                if (!view) {\n                    view = that._createView(element);\n                }\n\n                return showClosure(view);\n            } else {\n                if (this.serverNavigation) {\n                    location.href = url;\n                } else {\n                    that._loadView(url, showClosure);\n                }\n                return true;\n            }\n        },\n\n        append: function(html, url) {\n            var sandbox = this.sandbox,\n                urlPath = (url || \"\").split(\"?\")[0],\n                container = this.container,\n                views,\n                modalViews,\n                view;\n\n            if (bodyRegExp.test(html)) {\n                html = RegExp.$1;\n            }\n\n            sandbox[0].innerHTML = html;\n\n            container.append(sandbox.children(\"script, style\"));\n\n            views = this._hideViews(sandbox);\n            view = views.first();\n\n            // Generic HTML content found as remote view - no remote view markers\n            if (!view.length) {\n                views = view = sandbox.wrapInner(\"<div data-role=view />\").children(); // one element\n            }\n\n            if (urlPath) {\n                view.hide().attr(attr(\"url\"), urlPath);\n            }\n\n            this._setupLayouts(sandbox);\n\n            modalViews = sandbox.children(this._locate(\"modalview drawer\"));\n\n            container.append(sandbox.children(this._locate(\"layout modalview drawer\")).add(views));\n\n            // Initialize the modalviews after they have been appended to the final container\n            initWidgets(modalViews);\n\n            return this._createView(view);\n        },\n\n        _locate: function(selectors) {\n            return this.$angular ? directiveSelector(selectors) : roleSelector(selectors);\n        },\n\n        _findViewElement: function(url) {\n            var element,\n                urlPath = url.split(\"?\")[0];\n\n            if (!urlPath) {\n                return this.rootView;\n            }\n\n            element = this.container.children(\"[\" + attr(\"url\") + \"='\" + urlPath + \"']\");\n\n            // do not try to search for \"#/foo/bar\" id, jQuery throws error\n            if (!element[0] && urlPath.indexOf(\"/\") === -1) {\n                element = this.container.children(urlPath.charAt(0) === \"#\" ? urlPath : \"#\" + urlPath);\n            }\n\n            return element;\n        },\n\n        _createView: function(element) {\n            if (this.$angular) {\n                return compileMobileDirective(element, this.$angular[0]);\n            } else {\n                return kendo.initWidget(element, {\n                    defaultTransition: this.transition,\n                    loader: this.loader,\n                    container: this.container,\n                    getLayout: this.getLayoutProxy,\n                    modelScope: this.modelScope,\n                    reload: attrValue(element, \"reload\")\n                }, ui.roles);\n            }\n        },\n\n        _getLayout: function(name) {\n            if (name === \"\") {\n                return null;\n            }\n\n            return name ? this.layouts[name] : this.layouts[this.layout];\n        },\n\n        _loadView: function(url, callback) {\n            if (this._xhr) {\n                this._xhr.abort();\n            }\n\n            this.trigger(LOAD_START);\n\n            this._xhr = $.get(kendo.absoluteURL(url, this.remoteViewURLPrefix), \"html\")\n                .always(this._xhrComplete.bind(this, callback, url));\n        },\n\n        _xhrComplete: function(callback, url, response) {\n            var success = true;\n\n            if (typeof response === \"object\") {\n                if (response.status === 0) {\n                    if (response.responseText && response.responseText.length > 0) {\n                        success = true;\n                        response = response.responseText;\n                    } else { // request has been aborted for real\n                        return;\n                    }\n                }\n            }\n\n            this.trigger(LOAD_COMPLETE);\n\n            if (success) {\n                callback(this.append(response, url));\n            }\n        },\n\n        _hideViews: function(container) {\n            return container.children(this._locate(\"view splitview\")).hide();\n        },\n\n        _setupLayouts: function(element) {\n            var that = this,\n                layout;\n\n            element.children(that._locate(\"layout\")).each(function() {\n                if (that.$angular) {\n                    layout = compileMobileDirective($(this), that.$angular[0]);\n                } else {\n                    layout = kendo.initWidget($(this), {}, ui.roles);\n                }\n\n                var platform = layout.options.platform;\n\n                if (!platform || platform === mobile.application.os.name) {\n                    that.layouts[layout.options.id] = layout;\n                } else {\n                    layout.destroy();\n                }\n            });\n\n        }\n    });\n\n    kendo.mobile.ViewEngine = ViewEngine;\n\n    ui.plugin(View);\n    ui.plugin(Layout);\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","hidden","$","window","kendo","jQuery","undefined","mobile","ui","attr","Widget","ViewClone","INIT","UI_OVERLAY","BEFORE_SHOW","SHOW","AFTER_SHOW","BEFORE_HIDE","TRANSITION_END","TRANSITION_START","HIDE","DESTROY","attrValue","roleSelector","directiveSelector","compileMobileDirective","initPopOvers","element","popovers","find","idx","length","roles","initWidget","preventScrollIfNotInput","e","triggeredByInput","preventDefault","View","extend","init","options","fn","call","this","params","transition","defaultTransition","_id","$angular","_layout","_overlay","_scroller","_model","events","title","layout","getLayout","noop","reload","useNativeScrolling","stretch","zoom","model","modelScope","scroller","initWidgets","enable","overlay","hide","show","destroy","detach","trigger","scope","$destroy","purge","remove","triggerBeforeShow","view","triggerBeforeHide","showStart","css","inited","_invokeNgController","attach","_padIfNativeScrolling","resize","showEnd","hideEnd","that","beforeTransition","type","afterTransition","appLevelNativeScrolling","isAndroid","support","mobileOS","android","skin","application","isAndroidForced","os","indexOf","hasPlatformIndependentSkin","topContainer","bottomContainer","content","paddingTop","height","paddingBottom","contentElement","scrollerContent","clone","addClass","kendoMobileScroller","useNative","data","scrollElement","kineticScrollNeeded","on","getter","bind","dataviz","children","idAttrValue","guid","contentSelector","header","footer","wrapInner","prepend","append","setup","appendTo","controller","callback","_callController","test","$$phase","$apply","injector","invoke","constructor","$scope","collection","each","Layout","_locate","elements","add","selectors","platform","cloneNode","previousView","currentView","Observable","bodyRegExp","LOAD_START","LOAD_COMPLETE","SHOW_START","SAME_VIEW_REQUESTED","VIEW_SHOW","VIEW_TYPE_DETERMINED","AFTER","ViewEngine","views","errorMessage","container","sandbox","_hideViews","rootView","first","rootNeeded","Error","layouts","viewContainer","ViewContainer","getLayoutProxy","_getLayout","_setupLayouts","viewOptions","loader","showView","url","replace","RegExp","remoteViewURLPrefix","showClosure","_findViewElement","widgetInstance","remote","_createView","serverNavigation","location","href","_loadView","html","urlPath","split","modalViews","$1","innerHTML","charAt","_xhr","abort","get","absoluteURL","always","_xhrComplete","response","success","status","responseText","plugin","amd","a1","a2","a3"],"mappings":"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"}