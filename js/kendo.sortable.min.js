/**
 * Copyright 2025 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("kendo.draganddrop.js")):"function"==typeof define&&define.amd?define(["exports","kendo.draganddrop.min"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).kendosortable=e.kendosortable||{},e.kendosortable.js={}))}(this,(function(e){!function(e){var t=window.kendo,n=t.ui.Widget,i=t._outerWidth,r=t._outerHeight,o=t.keys,s=".kendoSortable",a="keydown"+s,l="focus"+s,d="blur"+s,c="ref-sortable-item",h="["+c+"]",u="start",g="beforeMove",f="move",p="end",m="change",_="navigate",b="cancel",v="sort",x="remove",y="receive";function T(e){return e.clone()}function w(e){return e.clone().removeAttr("id").css("visibility","hidden")}var C=n.extend({init:function(e,t){var i=this;n.fn.init.call(i,e,t),i.options.placeholder||(i.options.placeholder=w),i.options.hint||(i.options.hint=T),i.draggable=i._createDraggable(),i._assignRefAttribute();const r=i._items();if(i.options.navigatable){r.filter(i.options.disabled).attr("aria-disabled",!0),r.not(i.options.disabled).attr("aria-disabled",!1),i.element.attr("role")||i.element.attr("role","list"),r.each((function(e,t){t.getAttribute("role")||t.setAttribute("role","listitem"),t.setAttribute("aria-label",`${t.textContent.trim()}, ${"true"===t.getAttribute("aria-disabled")?"disabled":"enabled"}`)})),i._attatchNavigatableHandlers();const e=r.first();i._toggleTabIndex(e),r.find(":kendoFocusable").attr("tabindex",-1)}},events:[u,g,f,p,m,_,b],options:{name:"Sortable",hint:null,placeholder:null,filter:">*",navigatable:!1,holdToDrag:!1,disabled:null,container:null,connectWith:null,handler:null,cursorOffset:null,axis:null,ignore:null,autoScroll:!1,cursor:"auto",moveOnDragEnter:!1,allowTouchActions:!1},_attatchNavigatableHandlers:function(){const e=this;e._keydownHandler=e._keydown.bind(e),e._blurHandler=e._blur.bind(e),e._focusHandler=e._focus.bind(e),e.element.on(a,h,e._keydownHandler).on(d,h,e._blurHandler).on(l,h,e._focusHandler)},_focus:function(t){const n=this;e(t.target).is(h)&&(n._toggleFocus(e(t.target)),n._preventNavigate||n.trigger(_,{item:e(t.target)}))},_toggleTabIndex:function(e){const t=this._items();t.length&&(t.attr("tabindex",-1),e.attr("tabindex",0))},_toggleFocus:function(e){const t=this._items();t.length&&(t.removeClass("k-focus"),e.addClass("k-focus"))},_swap:function(e,t,n){const i=this;if(!e.is(i.options.disabled)&&t.length){t[n](e);const r="after"===n?i.indexOf(e)-1:i.indexOf(e)+1;const o=i.indexOf(e);i._toggleTabIndex(e),e.trigger("focus"),this.trigger(m,{item:e,oldIndex:r,newIndex:o,action:v})}},_navigate:function(e,t){let n=t;return n="next"===e?n.next(h):n.prev(h),!!n.length&&(this._toggleTabIndex(n),n.trigger("focus"),n)},_keydown:function(t){const n=this,i=t.keyCode,r=e(t.target),s=r.next(),a=r.prev(),l=r.find(":kendoFocusable");let d=!1;let c;if(n._preventNavigate=!1,n._lastFocusedSortableItem){if(i===o.LEFT||i===o.UP||i===o.RIGHT||i===o.DOWN)return;if(i===o.TAB){const e=t.shiftKey;const i=n._lastFocusedSortableItem.find(":kendoFocusable");const o=i.first();const s=i.last();if(!i.length)return;!e&&r.is(s)&&(o.focus(),d=!0),e&&r.is(o)&&(s.focus(),d=!0)}}if(i!=o.RIGHT&&i!=o.DOWN||(t.ctrlKey?(n._preventNavigate=!0,n._swap(r,s,"after"),d=!0):r.is(h)&&!r.is(n._items().last())&&(c=n._navigate("next",r),d=c)),i!=o.LEFT&&i!=o.UP||(t.ctrlKey?(n._preventNavigate=!0,n._swap(r,a,"before"),d=!0):r.is(h)&&!r.is(n._items().first())&&(c=n._navigate("prev",r),d=c)),i==o.ENTER){if(r.is(n.options.disabled)||0===r.find("input").length)return;if(n._lastFocusedSortableItem=r,!l.length)return;r.find(":kendoFocusable").attr("tabindex",0),r.removeClass("k-focus"),r.attr("tabindex",-1),l.first().trigger("focus"),d=!0}if(i==o.ESC){n._preventNavigate=!0;let e=n._lastFocusedSortableItem;if(e||(e=r.closest(h)),!e.length)return;n.element.find(":kendoFocusable").attr("tabindex",-1),n._toggleTabIndex(e),e.trigger("focus"),n._lastFocusedSortableItem&&delete n._lastFocusedSortableItem,d=!0}d&&(t.preventDefault(),t.stopPropagation())},_blur:function(t){e(t.target).removeClass("k-focus")},_detatchNavigatableHandlers:function(){const e=this;e.options.navigatable&&(e.element.off(s),e._keydownHandler=null,e._blurHandler=null,e._focusHandler=null)},_assignRefAttribute:function(){this._items().attr(c,"")},destroy:function(){this._detatchNavigatableHandlers(),this.draggable.destroy(),n.fn.destroy.call(this)},_createDraggable:function(){var n=this,i=n.element,r=n.options;return new t.ui.Draggable(i,{filter:r.filter,hint:t.isFunction(r.hint)?r.hint:e(r.hint),holdToDrag:r.holdToDrag,container:r.container?e(r.container):null,cursorOffset:r.cursorOffset,axis:r.axis,ignore:r.ignore,autoScroll:r.autoScroll,dragstart:n._dragstart.bind(n),dragcancel:n._dragcancel.bind(n),drag:n._drag.bind(n),dragend:n._dragend.bind(n),allowTouchActions:r.allowTouchActions})},_dragstart:function(n){var i=this.draggedElement=n.currentTarget,r=this.options.disabled,o=this.options.handler,s=this.options.placeholder,a=this.placeholder=t.isFunction(s)?e(s.call(this,i)):e(s);r&&i.is(r)||o&&!e(n.initialTarget).is(o)||this.trigger(u,{item:i,draggableEvent:n})?n.preventDefault():(i.css("display","none"),i.before(a),this._setCursor())},_dragcancel:function(){this._cancel(),this.trigger(b,{item:this.draggedElement}),this._resetCursor()},_drag:function(t){var n,i,r,o,s,a=this.draggedElement,l=this._findTarget(t),d={left:t.x.location,top:t.y.location},c={x:t.x.delta,y:t.y.delta},h=this.options.axis,u=this.options.moveOnDragEnter,g={item:a,list:this,draggableEvent:t};if("x"!==h&&"y"!==h){if(l){if(n=this._getElementCenter(l.element),i={left:Math.round(d.left-n.left),top:Math.round(d.top-n.top)},e.extend(g,{target:l.element}),l.appendToBottom)return void this._movePlaceholder(l,null,g);if(l.appendAfterHidden&&this._movePlaceholder(l,"next",g),this._isFloating(l.element)?c.x<0&&u||!u&&i.left<0?r="prev":(c.x>0&&u||!u&&i.left>0)&&(r="next"):c.y<0&&u||!u&&i.top<0?r="prev":(c.y>0&&u||!u&&i.top>0)&&(r="next"),r){for(o=(s="prev"===r?jQuery.fn.prev:jQuery.fn.next).call(l.element);o.length&&!o.is(":visible");)o=s.call(o);o[0]!=this.placeholder[0]&&this._movePlaceholder(l,r,g)}}}else this._movementByAxis(h,d,c[h],g)},_dragend:function(t){var n,i,r,o,s=this.placeholder,a=this.draggedElement,l=this.indexOf(a),d=this.indexOf(s),c=this.options.connectWith;this._resetCursor(),r={action:v,item:a,oldIndex:l,newIndex:d,draggableEvent:t},d>=0?i=this.trigger(p,r):(n=s.parents(c).getKendoSortable(),r.action=x,o=e.extend({},r,{action:y,oldIndex:-1,newIndex:n.indexOf(s)}),i=!(!this.trigger(p,r)&&!n.trigger(p,o))),i||d===l?this._cancel():(s.replaceWith(a),a.show(),this.draggable.dropped=!0,r={action:-1!=this.indexOf(a)?v:x,item:a,oldIndex:l,newIndex:this.indexOf(a),draggableEvent:t},this.trigger(m,r),n&&(o=e.extend({},r,{action:y,oldIndex:-1,newIndex:n.indexOf(a)}),n.trigger(m,o)))},_findTarget:function(t){var n,i,r=this._findElementUnderCursor(t),o=this.options.connectWith;return e.contains(this.element[0],r)?(i=(n=this.items()).filter(r)[0]||n.has(r)[0])?{element:e(i),sortable:this}:null:this.element[0]==r&&this._isEmpty()?{element:this.element,sortable:this,appendToBottom:!0}:this.element[0]==r&&this._isLastHidden()?{element:i=this.items().eq(0),sortable:this,appendAfterHidden:!0}:o?this._searchConnectedTargets(r,t):void 0},_findElementUnderCursor:function(n){var i=t.elementUnderCursor(n),r=n.sender;return function(t,n){try{return e.contains(t,n)||t==n}catch(e){return!1}}(r.hint[0],i)&&(r.hint.hide(),(i=t.elementUnderCursor(n))||(i=t.elementUnderCursor(n)),r.hint.show()),i},_searchConnectedTargets:function(t,n){var i,r,o,s=e(this.options.connectWith);for(var a=0;a<s.length;a++)if(i=s.eq(a).getKendoSortable(),e.contains(s[a],t)){if(i)return(o=(r=i.items()).filter(t)[0]||r.has(t)[0])?(i.placeholder=this.placeholder,{element:e(o),sortable:i}):null}else if(s[a]==t){if(i&&i._isEmpty())return{element:s.eq(a),sortable:i,appendToBottom:!0};if(this._isCursorAfterLast(i,n))return{element:o=i.items().last(),sortable:i}}},_isCursorAfterLast:function(e,n){var o,s=e.items().last(),a=n.x.location,l=n.y.location;return(o=t.getOffset(s)).top+=r(s),o.left+=i(s),(this._isFloating(s)?o.left-a:o.top-l)<0},_movementByAxis:function(t,n,i,r){var o,s="x"===t?n.left:n.top,a=i<0?this.placeholder.prev():this.placeholder.next(),l=this.items();a.length&&!a.is(":visible")&&(a=i<0?a.prev():a.next()),l.filter(a).length&&(e.extend(r,{target:a}),(o=this._getElementCenter(a))&&(o="x"===t?o.left:o.top),a.length&&i<0&&s-o<0?this._movePlaceholder({element:a,sortable:this},"prev",r):a.length&&i>0&&s-o>0&&this._movePlaceholder({element:a,sortable:this},"next",r))},_movePlaceholder:function(e,t,n){var i=this.placeholder;e.sortable.trigger(g,n)||(t?"prev"===t?e.element.before(i):"next"===t&&e.element.after(i):e.element.append(i),e.sortable.trigger(f,n))},_setCursor:function(){var t,n=this.options.cursor;n&&"auto"!==n&&(t=e(document.body),this._originalCursorType=t.css("cursor"),t.css({cursor:n}))},_resetCursor:function(){this._originalCursorType&&(e(document.body).css("cursor",this._originalCursorType),this._originalCursorType=null)},_getElementCenter:function(e){var n=e.length?t.getOffset(e):null;return n&&(n.top+=r(e)/2,n.left+=i(e)/2),n},_isFloating:function(e){var t=/left|right/.test(e.css("float"));var n=/inline|table-cell/.test(e.css("display"));var i=/flex/.test(e.parent().css("display"))&&(/row|row-reverse/.test(e.parent().css("flex-direction"))||!e.parent().css("flex-direction"));return t||n||i},_cancel:function(){this.draggedElement&&(this.draggedElement.show(),this.placeholder.remove(),this.draggable.dropped=!0)},_items:function(){var e=this.options.filter;return e?this.element.find(e):this.element.children()},indexOf:function(e){var t=this._items(),n=this.placeholder,i=this.draggedElement;return n&&e[0]==n[0]?t.not(i).index(e):t.not(n).index(e)},items:function(){var e=this.placeholder,t=this._items();return e&&(t=t.not(e)),t},_isEmpty:function(){return!this.items().length},_isLastHidden:function(){return 1===this.items().length&&this.items().is(":hidden")}});t.ui.plugin(C)}(window.kendo.jQuery);var t=kendo;e.__meta__={id:"sortable",name:"Sortable",category:"framework",depends:["draganddrop"]},e.default=t,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=kendo.sortable.min.js.map
