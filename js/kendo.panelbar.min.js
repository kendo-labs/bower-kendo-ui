/**
 * Copyright 2014 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Copyright 2014 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.core.min"],e)}(function(){return function(e,t){function n(t){t=e(t),t.children(v).children(".k-icon").remove(),t.filter(":has(.k-panel),:has(.k-content)").children(".k-link:not(:has([class*=k-i-arrow]))").each(function(){var t=e(this),n=t.parent();t.append("<span class='k-icon "+(n.hasClass(I)?"k-i-arrow-n k-panelbar-collapse":"k-i-arrow-s k-panelbar-expand")+"'/>")})}function i(t){t=e(t),t.filter(".k-first:not(:first-child)").removeClass(x),t.filter(".k-last:not(:last-child)").removeClass(m),t.filter(":first-child").addClass(x),t.filter(":last-child").addClass(m)}var r=window.kendo,a=r.ui,o=r.keys,s=e.extend,l=e.each,u=r.template,c=a.Widget,d=/^(ul|a|div)$/i,h=".kendoPanelBar",f="img",p="href",m="k-last",g="k-link",v="."+g,_="error",w=".k-item",b=".k-group",y=b+":visible",k="k-image",x="k-first",C="expand",T="select",S="k-content",F="activate",D="collapse",E="mouseenter",M="mouseleave",A="contentLoad",I="k-state-active",O="> .k-panel",P="> .k-content",H="k-state-focused",z="k-state-disabled",N="k-state-selected",B="."+N,V="k-state-highlight",R=w+":not(.k-state-disabled)",L=R+" > .k-link",W=w+".k-state-disabled > .k-link",j="> li > "+B+", .k-panel > li > "+B,U="k-state-default",q="aria-disabled",Y="aria-expanded",G="aria-hidden",$="aria-selected",Q=":visible",K=":empty",J="single",Z={content:u("<div role='region' class='k-content'#= contentAttributes(data) #>#= content(item) #</div>"),group:u("<ul role='group' aria-hidden='true' class='#= groupCssClass(group) #'#= groupAttributes(group) #>#= renderItems(data) #</ul>"),itemWrapper:u("<#= tag(item) # class='#= textClass(item, group) #' #= contentUrl(item) ##= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:u("<li role='menuitem' #=aria(item)#class='#= wrapperCssClass(group, item) #'>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, panelBar: panelBar, group: { expanded: item.expanded } }) ## } else if (item.content || item.contentUrl) { ##= renderContent(data) ## } #</li>"),image:u("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:u("<span class='#= arrowClass(item) #'></span>"),sprite:u("<span class='k-sprite #= spriteCssClass #'></span>"),empty:u("")},X={aria:function(e){var t="";return(e.items||e.content||e.contentUrl)&&(t+=Y+"='"+(e.expanded?"true":"false")+"' "),e.enabled===!1&&(t+=q+"='true'"),t},wrapperCssClass:function(e,t){var n="k-item",i=t.index;return n+=t.enabled===!1?" "+z:t.expanded===!0?" "+I:" k-state-default",0===i&&(n+=" k-first"),i==e.length-1&&(n+=" k-last"),t.cssClass&&(n+=" "+t.cssClass),n},textClass:function(e,t){var n=g;return t.firstLevel&&(n+=" k-header"),n},textAttributes:function(e){return e.url?" href='"+e.url+"'":""},arrowClass:function(e){var t="k-icon";return t+=e.expanded?" k-i-arrow-n k-panelbar-collapse":" k-i-arrow-s k-panelbar-expand"},text:function(e){return e.encoded===!1?e.text:r.htmlEncode(e.text)},tag:function(e){return e.url||e.contentUrl?"a":"span"},groupAttributes:function(e){return e.expanded!==!0?" style='display:none'":""},groupCssClass:function(){return"k-group k-panel"},contentAttributes:function(e){return e.item.expanded!==!0?" style='display:none'":""},content:function(e){return e.content?e.content:e.contentUrl?"":"&nbsp;"},contentUrl:function(e){return e.contentUrl?'href="'+e.contentUrl+'"':""}},et=c.extend({init:function(t,n){var i,a=this;c.fn.init.call(a,t,n),t=a.wrapper=a.element.addClass("k-widget k-reset k-header k-panelbar"),n=a.options,t[0].id&&(a._itemId=t[0].id+"_pb_active"),a._tabindex(),a._initData(n),a._updateClasses(),a._animations(n),t.on("click"+h,L,function(t){a._click(e(t.currentTarget))&&t.preventDefault()}).on(E+h+" "+M+h,L,a._toggleHover).on("click"+h,W,!1).on("keydown"+h,e.proxy(a._keydown,a)).on("focus"+h,function(){var e=a.select();a._current(e[0]?e:a._first())}).on("blur"+h,function(){a._current(null)}).attr("role","menu"),i=t.find("li."+I+" > ."+S),i[0]&&a.expand(i.parent(),!1),r.notify(a)},events:[C,D,T,F,_,A],options:{name:"PanelBar",animation:{expand:{effects:"expand:vertical",duration:200},collapse:{duration:200}},expandMode:"multiple"},destroy:function(){c.fn.destroy.call(this),this.element.off(h),r.destroy(this.element)},_initData:function(e){var t=this;e.dataSource&&(t.element.empty(),t.append(e.dataSource,t.element))},setOptions:function(e){var t=this.options.animation;this._animations(e),e.animation=s(!0,t,e.animation),"dataSource"in e&&this._initData(e),c.fn.setOptions.call(this,e)},expand:function(t,n){var i=this,r={};return n=n!==!1,t=this.element.find(t),t.each(function(a,o){o=e(o);var s=o.find(O).add(o.find(P));if(!o.hasClass(z)&&s.length>0){if(i.options.expandMode==J&&i._collapseAllExpanded(o))return i;t.find("."+V).removeClass(V),o.addClass(V),n||(r=i.options.animation,i.options.animation={expand:{effects:{}},collapse:{hide:!0,effects:{}}}),i._triggerEvent(C,o)||i._toggleItem(o,!1),n||(i.options.animation=r)}}),i},collapse:function(t,n){var i=this,r={};return n=n!==!1,t=i.element.find(t),t.each(function(t,a){a=e(a);var o=a.find(O).add(a.find(P));!a.hasClass(z)&&o.is(Q)&&(a.removeClass(V),n||(r=i.options.animation,i.options.animation={expand:{effects:{}},collapse:{hide:!0,effects:{}}}),i._triggerEvent(D,a)||i._toggleItem(a,!0),n||(i.options.animation=r))}),i},_toggleDisabled:function(e,t){e=this.element.find(e),e.toggleClass(U,t).toggleClass(z,!t).attr(q,!t)},select:function(n){var i=this;return n===t?i.element.find(j).parent():(i.element.find(n).each(function(){var n=e(this),r=n.children(v);return n.hasClass(z)?i:(i._triggerEvent(T,n)||i._updateSelected(r),t)}),i)},enable:function(e,t){return this._toggleDisabled(e,t!==!1),this},disable:function(e){return this._toggleDisabled(e,!1),this},append:function(e,t){t=this.element.find(t);var r=this._insert(e,t,t.length?t.find(O):null);return l(r.items,function(){r.group.append(this),i(this)}),n(t),i(r.group.find(".k-first, .k-last")),r.group.height("auto"),this},insertBefore:function(e,t){t=this.element.find(t);var n=this._insert(e,t,t.parent());return l(n.items,function(){t.before(this),i(this)}),i(t),n.group.height("auto"),this},insertAfter:function(e,t){t=this.element.find(t);var n=this._insert(e,t,t.parent());return l(n.items,function(){t.after(this),i(this)}),i(t),n.group.height("auto"),this},remove:function(e){e=this.element.find(e);var t=this,r=e.parentsUntil(t.element,w),a=e.parent("ul");return e.remove(),!a||a.hasClass("k-panelbar")||a.children(w).length||a.remove(),r.length&&(r=r.eq(0),n(r),i(r)),t},reload:function(t){var n=this;t=n.element.find(t),t.each(function(){var t=e(this);n._ajaxRequest(t,t.children("."+S),!t.is(Q))})},_first:function(){return this.element.children(R).first()},_last:function(){var e=this.element.children(R).last(),t=e.children(y);return t[0]?t.children(R).last():e},_current:function(e){var n=this,i=n._focused,r=n._itemId;return e===t?i:(n.element.removeAttr("aria-activedescendant"),i&&(i[0].id===r&&i.removeAttr("id"),i.children(v).removeClass(H)),e&&(r=e[0].id||r,e.attr("id",r).children(v).addClass(H),n.element.attr("aria-activedescendant",r)),n._focused=e,t)},_keydown:function(e){var t=this,n=e.keyCode,i=t._current();e.target==e.currentTarget&&(n==o.DOWN||n==o.RIGHT?(t._current(t._nextItem(i)),e.preventDefault()):n==o.UP||n==o.LEFT?(t._current(t._prevItem(i)),e.preventDefault()):n==o.ENTER||n==o.SPACEBAR?(t._click(i.children(v)),e.preventDefault()):n==o.HOME?(t._current(t._first()),e.preventDefault()):n==o.END&&(t._current(t._last()),e.preventDefault()))},_nextItem:function(e){if(!e)return this._first();var t=e.children(y),n=e.next();return t[0]&&(n=t.children("."+x)),n[0]||(n=e.parent(y).parent(w).next()),n[0]&&n.is(":visible")||(n=this._first()),n.hasClass(z)&&(n=this._nextItem(n)),n},_prevItem:function(e){if(!e)return this._last();var t,n=e.prev();if(n[0])for(t=n;t[0];)t=t.children(y).children("."+m),t[0]&&(n=t);else n=e.parent(y).parent(w),n[0]||(n=this._last());return n.hasClass(z)&&(n=this._prevItem(n)),n},_insert:function(t,n,i){var r,a,o=this,l=e.isPlainObject(t),u=n&&n[0];return u||(i=o.element),a={firstLevel:i.hasClass("k-panelbar"),expanded:i.parent().hasClass(I),length:i.children().length},u&&!i.length&&(i=e(et.renderGroup({group:a})).appendTo(n)),l||e.isArray(t)?(r=e.map(l?[t]:t,function(t,n){return"string"==typeof t?e(t):e(et.renderItem({group:a,item:s(t,{index:n})}))}),u&&n.attr(Y,!1)):(r="string"==typeof t&&"<"!=t[0]?o.element.find(t):e(t),o._updateItemsClasses(r)),{items:r,group:i}},_toggleHover:function(t){var n=e(t.currentTarget);n.parents("li."+z).length||n.toggleClass("k-state-hover",t.type==E)},_updateClasses:function(){var t,r,a=this;t=a.element.find("li > ul").not(function(){return e(this).parentsUntil(".k-panelbar","div").length}).addClass("k-group k-panel").attr("role","group"),t.parent().attr(Y,!1).not("."+I).children("ul").attr(G,!0).hide(),r=a.element.add(t).children(),a._updateItemsClasses(r),n(r),i(r)},_updateItemsClasses:function(e){for(var t=e.length,n=0;t>n;n++)this._updateItemClasses(e[n],n)},_updateItemClasses:function(t,n){var i,a,o=this._selected,s=this.options.contentUrls,l=s&&s[n],u=this.element[0];t=e(t).addClass("k-item").attr("role","menuitem"),r.support.browser.msie&&t.css("list-style-position","inside").css("list-style-position",""),t.children(f).addClass(k),a=t.children("a").addClass(g),a[0]&&(a.attr("href",l),a.children(f).addClass(k)),t.filter(":not([disabled]):not([class*=k-state])").addClass("k-state-default"),t.filter("li[disabled]").addClass("k-state-disabled").attr(q,!0).removeAttr("disabled"),t.children("div").addClass(S).attr("role","region").attr(G,!0).hide().parent().attr(Y,!1),a=t.children(B),a[0]&&(o&&o.removeAttr($).children(B).removeClass(N),a.addClass(N),this._selected=t.attr($,!0)),t.children(v)[0]||(i="<span class='"+g+"'/>",s&&s[n]&&t[0].parentNode==u&&(i='<a class="k-link k-header" href="'+s[n]+'"/>'),t.contents().filter(function(){return!(this.nodeName.match(d)||3==this.nodeType&&!e.trim(this.nodeValue))}).wrapAll(i)),t.parent(".k-panelbar")[0]&&t.children(v).addClass("k-header")},_click:function(e){var t,n,i,r,a,o,s,l=this,u=l.element;if(!e.parents("li."+z).length&&e.closest(".k-widget")[0]==u[0]){if(a=e.closest(v),o=a.closest(w),l._updateSelected(a),n=o.find(O).add(o.find(P)),i=a.attr(p),r=i&&("#"==i.charAt(i.length-1)||-1!=i.indexOf("#"+l.element[0].id+"-")),t=!(!r&&!n.length),n.data("animating"))return t;if(l._triggerEvent(T,o)&&(t=!0),t!==!1)return l.options.expandMode==J&&l._collapseAllExpanded(o)?t:(n.length&&(s=n.is(Q),l._triggerEvent(s?D:C,o)||(t=l._toggleItem(o,s))),t)}},_toggleItem:function(e,n){var i,r,a=this,o=e.find(O),s=e.find(v),l=s.attr(p);return o.length?(this._toggleGroup(o,n),i=!0):(r=e.children("."+S),r.length&&(i=!0,r.is(K)&&l!==t?a._ajaxRequest(e,r,n):a._toggleGroup(r,n))),i},_toggleGroup:function(e,t){var n=this,i=n.options.animation,r=i.expand,a=s({},i.collapse),o=a&&"effects"in a;e.is(Q)==t&&(e.parent().attr(Y,!t).attr(G,t).toggleClass(U,t).toggleClass(I,!t).find("> .k-link > .k-icon").toggleClass("k-i-arrow-n",!t).toggleClass("k-panelbar-collapse",!t).toggleClass("k-i-arrow-s",t).toggleClass("k-panelbar-expand",t),r=t?s(o?a:s({reverse:!0},r),{hide:!0}):s({complete:function(e){n._triggerEvent(F,e.closest(w))}},r),e.kendoStop(!0,!0).kendoAnimate(r))},_collapseAllExpanded:function(n){var i,r,a=this,o=!1;return n.children(v).hasClass("k-header")?(r=n.find(O).add(n.find(P)),r.is(Q)&&(o=!0),r.is(Q)||0===r.length||(i=e(a.element).children(),i.find(O).add(i.find(P)).filter(function(){return e(this).is(Q)}).each(function(t,n){n=e(n),o=a._triggerEvent(D,n.closest(w)),o||a._toggleGroup(n,!0)})),o):t},_ajaxRequest:function(t,n,i){var r=this,a=t.find(".k-panelbar-collapse, .k-panelbar-expand"),o=t.find(v),s=setTimeout(function(){a.addClass("k-loading")},100),l={},u=o.attr(p);e.ajax({type:"GET",cache:!1,url:u,dataType:"html",data:l,error:function(e,t){a.removeClass("k-loading"),r.trigger(_,{xhr:e,status:t})&&this.complete()},complete:function(){clearTimeout(s),a.removeClass("k-loading")},success:function(e){try{n.html(e)}catch(a){var o=window.console;o&&o.error&&o.error(a.name+": "+a.message+" in "+u),this.error(this.xhr,"error")}r._toggleGroup(n,i),r.trigger(A,{item:t[0],contentElement:n[0]})}})},_triggerEvent:function(e,t){var n=this;return n.trigger(e,{item:t[0]})},_updateSelected:function(e){var t=this,n=t.element,i=e.parent(w),r=t._selected;r&&r.removeAttr($),t._selected=i.attr($,!0),n.find(j).removeClass(N),n.find("> ."+V+", .k-panel > ."+V).removeClass(V),e.addClass(N),e.parentsUntil(n,w).filter(":has(.k-header)").addClass(V),t._current(i)},_animations:function(e){e&&"animation"in e&&!e.animation&&(e.animation={expand:{effects:{}},collapse:{hide:!0,effects:{}}})}});s(et,{renderItem:function(e){e=s({panelBar:{},group:{}},e);var t=Z.empty,n=e.item;return Z.item(s(e,{image:n.imageUrl?Z.image:t,sprite:n.spriteCssClass?Z.sprite:t,itemWrapper:Z.itemWrapper,renderContent:et.renderContent,arrow:n.items||n.content||n.contentUrl?Z.arrow:t,subGroup:et.renderGroup},X))},renderGroup:function(e){return Z.group(s({renderItems:function(e){for(var t="",n=0,i=e.items,r=i?i.length:0,a=s({length:r},e.group);r>n;n++)t+=et.renderItem(s(e,{group:a,item:s({index:n},i[n])}));return t}},e,X))},renderContent:function(e){return Z.content(s(e,X))}}),r.ui.plugin(et)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});