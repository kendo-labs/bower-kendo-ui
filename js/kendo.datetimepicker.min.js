/**
 * Copyright 2014 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(e,define){define(["./kendo.datepicker.min","./kendo.timepicker.min"],e)}(function(){return function(e,t){function n(e){var t=new Date(2100,0,1);return t.setMinutes(-e),t}function i(e){e.preventDefault()}function r(t){var n,i=o.getCulture(t.culture).calendars.standard.patterns;t.format=c(t.format||i.g),t.timeFormat=n=c(t.timeFormat||i.t),o.DateView.normalize(t),-1===e.inArray(n,t.parseFormats)&&t.parseFormats.splice(1,0,n)}var o=window.kendo,a=o.TimeView,s=o.parseDate,l=o._activeElement,c=o._extractFormat,d=o.calendar,h=d.isInRange,u=d.restrictValue,f=d.isEqualDatePart,p=a.getMilliseconds,g=o.ui,m=g.Widget,v="open",y="close",w="change",_=".kendoDateTimePicker",x="click"+_,b="disabled",k="readonly",C="k-state-default",S="k-state-focused",T="k-state-hover",A="k-state-disabled",D="mouseenter"+_+" mouseleave"+_,P="mousedown"+_,E="month",M="<span/>",I="aria-activedescendant",L="aria-expanded",B="aria-hidden",z="aria-owns",R="aria-disabled",F="aria-readonly",O=Date,N=new O(1900,0,1),V=new O(2099,11,31),H={view:"date"},U={view:"time"},W=e.extend,j=m.extend({init:function(e,t){var n,i=this;m.fn.init.call(i,e,t),e=i.element,t=i.options,t.min=s(e.attr("min"))||s(t.min),t.max=s(e.attr("max"))||s(t.max),r(t),i._wrapper(),i._views(),i._icons(),i._reset(),i._template();try{e[0].setAttribute("type","text")}catch(a){e[0].type="text"}e.addClass("k-input").attr({role:"combobox","aria-expanded":!1}),i._midnight=p(t.min)+p(t.max)===0,n=e.is("[disabled]"),n?i.enable(!1):i.readonly(e.is("[readonly]")),i._old=i._update(t.value||i.element.val()),i._oldText=e.val(),o.notify(i)},options:{name:"DateTimePicker",value:null,format:"",timeFormat:"",culture:"",parseFormats:[],dates:[],min:new O(N),max:new O(V),interval:30,height:200,footer:"",start:E,depth:E,animation:{},month:{},ARIATemplate:'Current focused date is #=kendo.toString(data.current, "d")#'},events:[v,y,w],setOptions:function(e){var t,n,i,a=this,l=a._value;m.fn.setOptions.call(a,e),e=a.options,e.min=t=s(e.min),e.max=n=s(e.max),r(e),i=e.value||a._value||a.dateView._current,t&&!f(t,i)&&(t=new O(N)),n&&!f(n,i)&&(n=new O(V)),a.dateView.setOptions(e),a.timeView.setOptions(W({},e,{format:e.timeFormat,min:t,max:n})),l&&(a.element.val(o.toString(l,e.format,e.culture)),a._updateARIA(l))},_editable:function(t){var n=this,r=n.element.off(_),a=n._dateIcon.off(_),s=n._timeIcon.off(_),c=n._inputWrapper.off(_),d=t.readonly,h=t.disable;d||h?(c.addClass(h?A:C).removeClass(h?C:A),r.attr(b,h).attr(k,d).attr(R,h).attr(F,d)):(c.addClass(C).removeClass(A).on(D,n._toggleHover),r.removeAttr(b).removeAttr(k).attr(R,!1).attr(F,!1).on("keydown"+_,e.proxy(n._keydown,n)).on("focus"+_,function(){n._inputWrapper.addClass(S)}).on("focusout"+_,function(){n._inputWrapper.removeClass(S),r.val()!==n._oldText&&n._change(r.val()),n.close("date"),n.close("time")}),a.on(P,i).on(x,function(){n.toggle("date"),o.support.touch||r[0]===l()||r.focus()}),s.on(P,i).on(x,function(){n.toggle("time"),o.support.touch||r[0]===l()||r.focus()}))},readonly:function(e){this._editable({readonly:e===t?!0:e,disable:!1})},enable:function(e){this._editable({readonly:!1,disable:!(e=e===t?!0:e)})},destroy:function(){var e=this;m.fn.destroy.call(e),e.dateView.destroy(),e.timeView.destroy(),e.element.off(_),e._dateIcon.off(_),e._timeIcon.off(_),e._inputWrapper.off(_),e._form&&e._form.off("reset",e._resetHandler)},close:function(e){"time"!==e&&(e="date"),this[e+"View"].close()},open:function(e){"time"!==e&&(e="date"),this[e+"View"].open()},min:function(e){return this._option("min",e)},max:function(e){return this._option("max",e)},toggle:function(e){var t="timeView";"time"!==e?e="date":t="dateView",this[e+"View"].toggle(),this[t].close()},value:function(e){var n=this;return e===t?n._value:(n._old=n._update(e),null===n._old&&n.element.val(""),n._oldText=n.element.val(),t)},_change:function(e){var t=this;e=t._update(e),+t._old!=+e&&(t._old=e,t._oldText=t.element.val(),t.trigger(w),t.element.trigger(w))},_option:function(e,i){var r,o,a=this,l=a.options,c=a.timeView,d=c.options,h=a._value||a._old;if(i===t)return l[e];if(i=s(i,l.parseFormats,l.culture)){if(l.min.getTime()===l.max.getTime()&&(d.dates=[]),l[e]=new O(i.getTime()),a.dateView[e](i),a._midnight=p(l.min)+p(l.max)===0,h&&(r=f(l.min,h),o=f(l.max,h)),r||o){if(d[e]=i,r&&!o&&(d.max=n(l.interval)),o){if(a._midnight)return c.dataBind([V]),t;r||(d.min=N)}}else d.max=V,d.min=N;c.bind()}},_toggleHover:function(t){e(t.currentTarget).toggleClass(T,"mouseenter"===t.type)},_update:function(t){var i,r,a,l,c,d=this,p=d.options,g=p.min,m=p.max,v=p.dates,y=d.timeView,w=d._value,_=s(t,p.parseFormats,p.culture),x=null===_&&null===w||_ instanceof Date&&w instanceof Date;return+_===+w&&x?(c=o.toString(_,p.format,p.culture),c!==t&&d.element.val(null===_?t:c),_):(null!==_&&f(_,g)?_=u(_,g,m):h(_,g,m)||(_=null),d._value=_,y.value(_),d.dateView.value(_),_&&(a=d._old,r=y.options,v[0]&&(v=e.grep(v,function(e){return f(_,e)}),v[0]&&(y.dataBind(v),l=!0)),l||(f(_,g)&&(r.min=g,r.max=n(p.interval),i=!0),f(_,m)&&(d._midnight?(y.dataBind([V]),l=!0):(r.max=m,i||(r.min=N),i=!0))),!l&&(!a&&i||a&&!f(a,_))&&(i||(r.max=V,r.min=N),y.bind())),d.element.val(_?o.toString(_,p.format,p.culture):t),d._updateARIA(_),_)},_keydown:function(e){var t=this,n=t.dateView,i=t.timeView,r=t.element.val(),a=n.popup.visible();e.altKey&&e.keyCode===o.keys.DOWN?t.toggle(a?"time":"date"):a?(n.move(e),t._updateARIA(n._current)):i.popup.visible()?i.move(e):e.keyCode===o.keys.ENTER&&r!==t._oldText&&t._change(r)},_views:function(){var e,t,n,i,r,l,c=this,d=c.element,u=c.options,f=d.attr("id");c.dateView=e=new o.DateView(W({},u,{id:f,anchor:c.wrapper,change:function(){var t,n=e.calendar.value(),i=+n,r=+u.min,o=+u.max;(i===r||i===o)&&(t=new O(+c._value),t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),h(t,r,o)&&(n=t)),c._change(n),c.close("date")},close:function(e){c.trigger(y,H)?e.preventDefault():(d.attr(L,!1),n.attr(B,!0),t.popup.visible()||d.removeAttr(z))},open:function(t){c.trigger(v,H)?t.preventDefault():(c.element.val()!==c._oldText&&(l=s(d.val(),u.parseFormats,u.culture),c.dateView[l?"current":"value"](l)),n.attr(B,!1),d.attr(L,!0).attr(z,e._dateViewID),c._updateARIA(l))}})),n=e.div,r=u.min.getTime(),c.timeView=t=new a({id:f,value:u.value,anchor:c.wrapper,animation:u.animation,format:u.timeFormat,culture:u.culture,height:u.height,interval:u.interval,min:new O(N),max:new O(V),dates:r===u.max.getTime()?[new Date(r)]:[],parseFormats:u.parseFormats,change:function(n,i){n=t._parse(n),u.min>n?(n=new O(+u.min),t.options.min=n):n>u.max&&(n=new O(+u.max),t.options.max=n),i?(c._timeSelected=!0,c._change(n)):(d.val(o.toString(n,u.format,u.culture)),e.value(n),c._updateARIA(n))},close:function(t){c.trigger(y,U)?t.preventDefault():(i.attr(B,!0),d.attr(L,!1),e.popup.visible()||d.removeAttr(z))},open:function(e){t._adjustListWidth(),c.trigger(v,U)?e.preventDefault():(i.attr(B,!1),d.attr(L,!0).attr(z,t._timeViewID),t.options.active(t.current()))},active:function(e){d.removeAttr(I),e&&d.attr(I,t._optionID)}}),i=t.ul},_icons:function(){var t,n=this,i=n.element;t=i.next("span.k-select"),t[0]||(t=e('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span><span unselectable="on" class="k-icon k-i-clock">select</span></span>').insertAfter(i)),t=t.children(),n._dateIcon=t.eq(0).attr({role:"button","aria-controls":n.dateView._dateViewID}),n._timeIcon=t.eq(1).attr({role:"button","aria-controls":n.timeView._timeViewID})},_wrapper:function(){var t,n=this,i=n.element;t=i.parents(".k-datetimepicker"),t[0]||(t=i.wrap(M).parent().addClass("k-picker-wrap k-state-default"),t=t.wrap(M).parent()),t[0].style.cssText=i[0].style.cssText,i.css({width:"100%",height:i[0].style.height}),n.wrapper=t.addClass("k-widget k-datetimepicker k-header").addClass(i[0].className),n._inputWrapper=e(t[0].firstChild)},_reset:function(){var t=this,n=t.element,i=n.attr("form"),r=i?e("#"+i):n.closest("form");r[0]&&(t._resetHandler=function(){t.value(n[0].defaultValue)},t._form=r.on("reset",t._resetHandler))},_template:function(){this._ariaTemplate=o.template(this.options.ARIATemplate)},_updateARIA:function(e){var t,n=this,i=n.dateView.calendar;n.element.removeAttr(I),i&&(t=i._cell,t.attr("aria-label",n._ariaTemplate({current:e||i.current()})),n.element.attr(I,t.attr("id")))}});g.plugin(j)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});