{"version":3,"file":"kendo.list.min.js","sources":["kendo.list.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.list',[ \"kendo.data\", \"kendo.popup\" ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"list\",\n    name: \"List\",\n    category: \"framework\",\n    depends: [ \"data\", \"popup\" ],\n    hidden: true\n};\n\n/*jshint evil: true*/\n(function($, undefined) {\n    var kendo = window.kendo,\n        ui = kendo.ui,\n        outerHeight = kendo._outerHeight,\n        percentageUnitsRegex = /^\\d+(\\.\\d+)?%$/i,\n        Widget = ui.Widget,\n        keys = kendo.keys,\n        support = kendo.support,\n        htmlEncode = kendo.htmlEncode,\n        activeElement = kendo._activeElement,\n        outerWidth = kendo._outerWidth,\n        ObservableArray = kendo.data.ObservableArray,\n        ID = \"id\",\n        CHANGE = \"change\",\n        FOCUSED = \"k-focus\",\n        HOVER = \"k-hover\",\n        KSELECTED = \"k-selected\",\n        LOADING = \"k-i-loading k-input-loading-icon\",\n        LIST = \"k-list\",\n        TABLE = \"k-table\",\n        DATA_TABLE = \"k-data-table\",\n        TABLE_MD = \"k-table-md\",\n        LIST_UL = \"k-list-ul\",\n        TABLE_LIST = \"k-table-list\",\n        FIXED_GROUP_HEADER = \".k-list-group-sticky-header\",\n        GROUP_LABEL = \".k-list-item-group-label\",\n        ITEMSELECTOR = \".k-list-item\",\n        OPEN = \"open\",\n        CLOSE = \"close\",\n        CASCADE = \"cascade\",\n        SELECT = \"select\",\n        CLICK = \"click\",\n        MOUSELEAVE = \"mouseleave\",\n        MOUSEENTER = \"mouseenter\",\n        ACTIVATE = \"activate\",\n        DEACTIVATE = \"deactivate\",\n        DATA_BINDING = \"dataBinding\",\n        DATA_BOUND = \"dataBound\",\n        SELECTED_ITEM_CHANGE = \"selectedItemChange\",\n        SELECTED = \"selected\",\n        REQUESTSTART = \"requestStart\",\n        REQUESTEND = \"requestEnd\",\n        BLUR = \"blur\",\n        FOCUS = \"focus\",\n        FOCUSOUT = \"focusout\",\n        extend = $.extend,\n        isArray = Array.isArray,\n        browser = support.browser,\n        HIDDENCLASS = \"k-hidden\",\n        WIDTH = \"width\",\n        TEXT = \"text\",\n        VALUE = \"value\",\n        isIE = browser.msie,\n        quotRegExp = /\"/g,\n        alternativeNames = {\n            \"ComboBox\": [ \"DropDownList\", \"MultiColumnComboBox\" ],\n            \"DropDownList\": [ \"ComboBox\", \"MultiColumnComboBox\" ],\n            \"MultiColumnComboBox\": [ \"ComboBox\", \"DropDownList\" ]\n        },\n\n        UL_EL = '<ul unselectable=\"on\"/>',\n        LIST_EL = \"<div class='k-list'/>\",\n        NO_DATA_EL = '<div class=\"k-no-data\" style=\"display: none;\"></div>',\n        LIST_FOOTER_EL = '<div class=\"k-list-footer\"></div>',\n        TABLE_FOOTER_EL = '<div class=\"k-table-footer\">' +\n                '<span class=\"k-table-td\"></span>' +\n            '</div>',\n        MOUSEDOWN = \"mousedown\",\n        LIST_SUFFIX = \"-list\",\n        LISTBOX_SUFFIX = \"_listbox\",\n        ARIA_LABELLEDBY = \"aria-labelledby\",\n        ARIA_LABEL = \"aria-label\",\n        ARIA_ACTIVEDESCENDANT = \"aria-activedescendant\",\n        ARIA_AUTOCOMPLETE = \"aria-autocomplete\",\n        ARIA_CONTROLS = \"aria-controls\",\n        ARIA_LIVE = \"aria-live\",\n        ARIA_EXPANDED = \"aria-expanded\",\n        ARIA_HIDDEN = \"aria-hidden\",\n        ARIA_BUSY = \"aria-busy\",\n        ARIA_MULTISELECTABLE = \"aria-multiselectable\",\n        ARIA_SELECTED = \"aria-selected\",\n        GROUP_ROW_SEL = \".k-table-group-row\";\n\n    var List = kendo.ui.DataBoundWidget.extend({\n        init: function(element, options) {\n            var that = this,\n                id;\n\n            Widget.fn.init.call(that, element, options);\n            element = that.element;\n            options = that.options;\n\n            that._isSelect = element.is(SELECT);\n\n            if (that._isSelect && that.element[0].length) {\n                if (!options.dataSource) {\n                    options.dataTextField = options.dataTextField || TEXT;\n                    options.dataValueField = options.dataValueField || VALUE;\n                }\n            }\n\n            that._listSize = kendo.cssProperties.getValidClass({\n                widget: \"List\",\n                propName: \"size\",\n                value: options.size\n            });\n\n            that.ul = $(UL_EL).attr({\n                tabIndex: -1,\n                \"aria-hidden\": true\n            });\n\n            that.list = $(LIST_EL)\n                .addClass(that._listSize)\n                .append(that.ul);\n\n            id = element.attr(ID);\n\n            if (!id) {\n                id = kendo.guid();\n            }\n\n            that.list.attr(ID, id + LIST_SUFFIX);\n            that.ul.attr(ID, id + LISTBOX_SUFFIX);\n\n            if (options.columns && options.columns.length) {\n                that.list.removeClass(LIST).addClass(DATA_TABLE);\n                that.list.removeClass(that._listSize).addClass(TABLE_MD);\n\n                that.ul.removeClass(LIST_UL).addClass(TABLE);\n\n                that._columnsHeader();\n            }\n\n            that._header();\n            that._noData();\n            that._footer();\n            that._accessors();\n            that._initValue();\n        },\n\n        options: {\n            valuePrimitive: false,\n            footerTemplate: \"\",\n            headerTemplate: \"\",\n            noDataTemplate: true,\n            size: \"medium\",\n            messages: {\n                \"noData\": \"No data found.\",\n                \"clear\": \"clear\"\n            }\n        },\n\n        setOptions: function(options) {\n            Widget.fn.setOptions.call(this, options);\n\n            if (options && options.enable !== undefined) {\n                options.enabled = options.enable;\n            }\n\n            if (options.columns && options.columns.length) {\n                this._columnsHeader();\n            }\n\n            this._header();\n            this._noData();\n            this._footer();\n\n            this._renderFooter();\n            this._renderNoData();\n        },\n\n        focus: function() {\n            this._focused.trigger(FOCUS);\n        },\n\n        readonly: function(readonly) {\n            this._editable({\n                readonly: readonly === undefined ? true : readonly,\n                disable: false\n            });\n        },\n\n        enable: function(enable) {\n            this._editable({\n                readonly: false,\n                disable: !(enable = enable === undefined ? true : enable)\n            });\n        },\n\n        _header: function() {\n            var list = this;\n            var header = $(list.header);\n            var template = list.options.headerTemplate;\n\n            this._angularElement(header, \"cleanup\");\n            kendo.destroy(header);\n            header.remove();\n\n            if (!template) {\n                list.header = null;\n                return;\n            }\n\n            var headerTemplate = typeof template !== \"function\" ? kendo.template(template) : template;\n            header = $(headerTemplate({}));\n\n            list.header = header[0] ? header : null;\n\n            if (list.list.parent.length > 0) {\n                list.list.before(header);\n            }\n\n            this._angularElement(list.header, \"compile\");\n        },\n\n        _columnsHeader: function() {\n            var list = this;\n            var columnsHeader = $(list.columnsHeader);\n\n            this._angularElement(columnsHeader, \"cleanup\");\n            kendo.destroy(columnsHeader);\n            columnsHeader.remove();\n\n            var header = \"<div class='k-table-header'><div class='k-table-header-wrap'><table class='k-table' role='presentation'>\";\n            var colGroup = \"<colgroup>\";\n            var row = \"<tr class='k-table-row'>\";\n\n            for (var idx = 0; idx < this.options.columns.length; idx++) {\n                var currentColumn = this.options.columns[idx];\n                var title = currentColumn.title || currentColumn.field || \"\";\n                var template = currentColumn.headerTemplate || title;\n                var columnsHeaderTemplate = typeof template !== \"function\" ? kendo.template(template) : template;\n                var currentWidth = currentColumn.width;\n                var currentWidthInt = parseInt(currentWidth, 10);\n                var widthStyle = '';\n\n                if (currentWidth && !isNaN(currentWidthInt)) {\n                    widthStyle += \"style='width:\";\n                    widthStyle += currentWidthInt;\n                    widthStyle += percentageUnitsRegex.test(currentWidth) ? \"%\" : \"px\";\n                    widthStyle += \";'\";\n                }\n\n                colGroup += \"<col \" + widthStyle + \"/>\";\n\n                row += \"<th class='k-table-th'>\";\n                row += columnsHeaderTemplate(currentColumn);\n                row += \"</th>\";\n            }\n            colGroup += \"</colgroup>\";\n            row += \"</tr>\";\n            header += colGroup;\n            header += \"<thead class='k-table-thead'>\";\n            header += row;\n            header += \"</thead></table></div></div>\";\n\n            list.columnsHeader = columnsHeader = $(header);\n            list.list.prepend(columnsHeader);\n\n            this._angularElement(list.columnsHeader, \"compile\");\n        },\n\n        _noData: function() {\n            var list = this;\n            var noData = $(list.noData);\n            var template = list.options.noDataTemplate === true ? list.options.messages.noData : list.options.noDataTemplate;\n\n            list.angular(\"cleanup\", function() { return { elements: noData }; });\n            kendo.destroy(noData);\n            noData.remove();\n\n            if (!template) {\n                list.noData = null;\n                return;\n            }\n\n            list.noData = $(NO_DATA_EL).appendTo(list.list);\n            list.noDataTemplate = typeof template !== \"function\" ? kendo.template(template) : template;\n        },\n\n        _footer: function() {\n            var list = this;\n            var footer = $(list.footer);\n            var template = list.options.footerTemplate;\n            var footerEl = this.options.columns && this.options.columns.length ? TABLE_FOOTER_EL : LIST_FOOTER_EL;\n\n            this._angularElement(footer, \"cleanup\");\n            kendo.destroy(footer);\n            footer.remove();\n\n            if (!template) {\n                list.footer = null;\n                return;\n            }\n\n            list.footer = $(footerEl).appendTo(list.list);\n            list.footerTemplate = typeof template !== \"function\" ? kendo.template(template) : template;\n        },\n\n        _listOptions: function(options) {\n            var that = this;\n            var currentOptions = that.options;\n            var virtual = currentOptions.virtual;\n            var changeEventOption = { change: that._listChange.bind(that) };\n            var listBoundHandler = that._listBound.bind(that);\n            var focusedElm = that._focused;\n            var inputId = that.element.attr(\"id\");\n            var labelElm = $(\"label[for=\\\"\" + that.element.attr(\"id\") + \"\\\"]\");\n            var labelledBy = focusedElm.attr(ARIA_LABELLEDBY);\n\n            if (!labelledBy && labelElm.length) {\n                labelledBy = labelElm.attr(\"id\") || that._generateLabelId(labelElm, inputId || kendo.guid());\n            }\n\n            virtual = typeof virtual === \"object\" ? virtual : {};\n\n            options = $.extend({\n                autoBind: false,\n                selectable: true,\n                dataSource: that.dataSource,\n                click: that._click.bind(that),\n                activate: that._activateItem.bind(that),\n                columns: currentOptions.columns,\n                deactivate: that._deactivateItem.bind(that),\n                dataBinding: function() {\n                    that.trigger(DATA_BINDING);\n                },\n                dataBound: listBoundHandler,\n                height: currentOptions.height,\n                dataValueField: currentOptions.dataValueField,\n                dataTextField: currentOptions.dataTextField,\n                groupTemplate: currentOptions.groupTemplate,\n                fixedGroupTemplate: currentOptions.fixedGroupTemplate,\n                template: currentOptions.template,\n                ariaLabel: focusedElm.attr(ARIA_LABEL),\n                ariaLabelledBy: labelledBy,\n                listSize: that._listSize\n            }, options, virtual, changeEventOption);\n\n            if (!options.template) {\n                options.template = \"#:\" + kendo.expr(options.dataTextField, \"data\") + \"#\";\n            }\n\n            if (currentOptions.$angular) {\n                options.$angular = currentOptions.$angular;\n            }\n\n            return options;\n        },\n\n        _initList: function() {\n            var that = this;\n            var listOptions = that._listOptions({\n                selectedItemChange: that._listChange.bind(that)\n            });\n\n            if (!that.options.virtual) {\n                that.listView = new kendo.ui.StaticList(that.ul, listOptions);\n            } else {\n                that.listView = new kendo.ui.VirtualList(that.ul, listOptions);\n                that.list.addClass(\"k-virtual-list\");\n            }\n\n            that.listView.bind(\"listBound\", that._listBound.bind(that));\n            that._setListValue();\n        },\n\n        _setListValue: function(value) {\n            value = value || this.options.value;\n\n            if (value !== undefined) {\n                this.listView.value(value)\n                    .done(this._updateSelectionState.bind(this));\n            }\n        },\n\n        _updateSelectionState: $.noop,\n\n        _listMousedown: function(e) {\n            if (!this.filterInput || this.filterInput[0] !== e.target) {\n                e.preventDefault();\n            }\n        },\n\n        _isFilterEnabled: function() {\n            var filter = this.options.filter;\n            return filter && filter !== \"none\";\n        },\n\n        _hideClear: function() {\n            var list = this;\n\n            if (list._clear) {\n                list._clear.addClass(HIDDENCLASS);\n            }\n        },\n\n        _showClear: function() {\n            if (this._clear) {\n                this._clear.removeClass(HIDDENCLASS);\n            }\n        },\n\n        _clearValue: function() {\n            this._clearText();\n            this._accessor(\"\");\n            this.listView.value([]);\n\n            if (this._isSelect) {\n                this._customOption = undefined;\n            }\n\n            if (this._isFilterEnabled() && !this.options.enforceMinLength) {\n                this._filter({ word: \"\", open: false });\n\n                if (this.options.highlightFirst) {\n                    this.listView.focus(0);\n                }\n            }\n            this._change();\n        },\n\n        _clearText: function() {\n            this.text(\"\");\n        },\n\n        _clearFilter: function() {\n            if (!this.options.virtual) {\n                this.listView.bound(false);\n            }\n\n            this._filterSource();\n        },\n\n        _filterSource: function(filter, force) {\n            var that = this;\n            var options = that.options;\n            var isMultiColumnFiltering = options.filterFields && filter && filter.logic && filter.filters && filter.filters.length;\n            var dataSource = that.dataSource;\n            var expression = extend({}, dataSource.filter() || {});\n            var resetPageSettings = filter || (expression.filters && expression.filters.length && !filter);\n\n            var removed = removeFiltersForField(expression, options.dataTextField);\n\n            this._clearFilterExpressions(expression);\n\n            if ((filter || removed) && that.trigger(\"filtering\", { filter: filter })) {\n                return $.Deferred().reject().promise();\n            }\n\n            var newExpression = {\n                filters: [],\n                logic: \"and\"\n            };\n\n            if (isMultiColumnFiltering) {\n                newExpression.filters.push(filter);\n            } else {\n                this._pushFilterExpression(newExpression, filter);\n            }\n\n            if (isValidFilterExpr(expression)) {\n                if (newExpression.logic === expression.logic) {\n                    newExpression.filters = newExpression.filters.concat(expression.filters);\n                } else {\n                    newExpression.filters.push(expression);\n                }\n            }\n\n            if (that._cascading) {\n                this.listView.setDSFilter(newExpression);\n            }\n\n            var dataSourceState = extend({}, {\n                page: resetPageSettings ? 1 : dataSource.page(),\n                pageSize: resetPageSettings ? dataSource.options.pageSize : dataSource.pageSize(),\n                sort: dataSource.sort(),\n                filter: dataSource.filter(),\n                group: dataSource.group(),\n                aggregate: dataSource.aggregate()\n            }, { filter: newExpression });\n\n            return dataSource[force ? \"read\" : \"query\"](dataSource._mergeState(dataSourceState));\n        },\n\n        _pushFilterExpression: function(newExpression, filter) {\n            if (isValidFilterExpr(filter) && filter.value !== \"\") {\n                newExpression.filters.push(filter);\n            }\n        },\n\n        _clearFilterExpressions: function(expression) {\n            if (!expression.filters) {\n                return;\n            }\n\n            var filtersToRemove;\n\n            for (var i = 0; i < expression.filters.length; i++) {\n                if (\"fromFilter\" in expression.filters[i]) {\n                    filtersToRemove = i;\n                }\n            }\n\n            if (!isNaN(filtersToRemove)) {\n                expression.filters.splice(filtersToRemove, 1);\n            }\n        },\n\n        _angularElement: function(element, action) {\n            if (!element) {\n                return;\n            }\n\n            this.angular(action, function() {\n                return { elements: element };\n            });\n        },\n\n        _renderNoData: function() {\n            var list = this;\n            var noData = list.noData;\n\n            if (!noData) {\n                return;\n            }\n\n            this._angularElement(noData, \"cleanup\");\n            noData.html(list.noDataTemplate({ instance: list }));\n            this._angularElement(noData, \"compile\");\n        },\n\n        _toggleNoData: function(show) {\n            $(this.noData).toggle(show);\n        },\n\n        _toggleHeader: function(show) {\n            var groupHeader = this.listView.content.prev(FIXED_GROUP_HEADER);\n            groupHeader.toggle(show);\n        },\n\n        _renderFooter: function() {\n            var list = this,\n                footer = list.footer ? this.options.columns && this.options.columns.length ? list.footer.children().first() : list.footer : null;\n\n            if (!footer) {\n                return;\n            }\n\n            this._angularElement(footer, \"cleanup\");\n            footer.html(list.footerTemplate({ instance: list }));\n            this._angularElement(footer, \"compile\");\n        },\n\n        _allowOpening: function() {\n            return this.options.noDataTemplate || this.dataSource.flatView().length;\n        },\n\n        _initValue: function() {\n            var that = this,\n                value = that.options.value;\n\n            if (value !== null) {\n                that.element.val(value);\n            } else {\n                value = that._accessor();\n                that.options.value = value;\n            }\n\n            that._old = value;\n        },\n\n        _ignoreCase: function() {\n            var that = this,\n                model = that.dataSource.reader.model,\n                field;\n\n            if (model && model.fields) {\n                field = model.fields[that.options.dataTextField];\n\n                if (field && field.type && field.type !== \"string\") {\n                    that.options.ignoreCase = false;\n                }\n            }\n        },\n\n        _focus: function(candidate) {\n            return this.listView.focus(candidate);\n        },\n\n        _filter: function(options) {\n            var that = this;\n            var widgetOptions = that.options;\n            var word = options.word;\n            var filterFields = widgetOptions.filterFields;\n            var field = widgetOptions.dataTextField;\n            var expression;\n\n            if (filterFields && filterFields.length) {\n                expression = {\n                    logic: \"or\",\n                    filters: [],\n                    fromFilter: true\n                };\n                for (var i = 0; i < filterFields.length; i++) {\n                    this._pushFilterExpression(expression, that._buildExpression(word, filterFields[i]));\n                }\n            } else {\n                expression = that._buildExpression(word, field);\n            }\n\n            that._open = options.open;\n            that._filterSource(expression);\n        },\n\n        _buildExpression: function(value, field) {\n            var that = this;\n            var widgetOptions = that.options;\n            var ignoreCase = widgetOptions.ignoreCase;\n            var accentFoldingFiltering = that.dataSource.options.accentFoldingFiltering;\n\n            return {\n                value: ignoreCase ? (accentFoldingFiltering ? value.toLocaleLowerCase(accentFoldingFiltering) : value.toLowerCase()) : value,\n                field: field,\n                operator: widgetOptions.filter,\n                ignoreCase: ignoreCase\n            };\n        },\n\n        _clearButton: function() {\n            var list = this;\n            var clearTitle = list.options.messages.clear;\n\n            if (!list._clear) {\n                list._clear = $('<span unselectable=\"on\" class=\"k-clear-value\" title=\"' + clearTitle + '\"><span class=\"k-icon k-i-x\"></span></span>').attr({\n                    \"role\": \"button\",\n                    \"tabIndex\": -1\n                });\n            }\n\n            if (!list.options.clearButton) {\n                list._clear.remove();\n            }\n            this._hideClear();\n        },\n\n        search: function(word) {\n            var options = this.options;\n\n            word = typeof word === \"string\" ? word : this._inputValue();\n\n            clearTimeout(this._typingTimeout);\n\n            if ((!options.enforceMinLength && !word.length) || word.length >= options.minLength) {\n                this._state = \"filter\";\n                if (this.listView) {\n                    this.listView._emptySearch = !kendo.trim(word).length;\n                }\n\n                if (!this._isFilterEnabled()) {\n                    this._searchByWord(word);\n                } else {\n                    this._filter({ word: word, open: true });\n                }\n            }\n        },\n\n        current: function(candidate) {\n            return this._focus(candidate);\n        },\n\n        items: function() {\n            return this.ul[0].children;\n        },\n\n        destroy: function() {\n            var that = this;\n            var ns = that.ns;\n\n            Widget.fn.destroy.call(that);\n\n            that._unbindDataSource();\n\n            that.listView.destroy();\n            that.list.off(ns);\n\n            that.popup.destroy();\n\n            if (that._form) {\n                that._form.off(\"reset\", that._resetHandler);\n            }\n        },\n\n        dataItem: function(index) {\n            var that = this;\n\n            if (index === undefined) {\n                return that.listView.selectedDataItems()[0];\n            }\n\n            if (typeof index !== \"number\") {\n                if (that.options.virtual) {\n                    return that.dataSource.getByUid($(index).data(\"uid\"));\n                }\n\n                index = $(that.items()).index(index);\n            }\n\n            return that.dataSource.flatView()[index];\n        },\n\n        _activateItem: function() {\n            var current = this.listView.focus();\n            if (current && this.popup.visible()) {\n                this._focused.add(this.filterInput).attr(ARIA_ACTIVEDESCENDANT, current.attr(\"id\"));\n            }\n        },\n\n        _deactivateItem: function() {\n            this._focused.add(this.filterInput).removeAttr(ARIA_ACTIVEDESCENDANT);\n        },\n\n        _accessors: function() {\n            var that = this;\n            var element = that.element;\n            var options = that.options;\n            var getter = kendo.getter;\n            var textField = element.attr(kendo.attr(\"text-field\"));\n            var valueField = element.attr(kendo.attr(\"value-field\"));\n\n            if (!options.dataTextField && textField) {\n                options.dataTextField = textField;\n            }\n\n            if (!options.dataValueField && valueField) {\n                options.dataValueField = valueField;\n            }\n\n            that._text = getter(options.dataTextField);\n            that._value = getter(options.dataValueField);\n        },\n\n        _aria: function(id) {\n            var that = this,\n                options = that.options,\n                element = that._focused,\n                autocomplete;\n\n            if (options.suggest !== undefined) {\n                if (options.filter === \"none\") {\n                    if (options.suggest === true) {\n                        autocomplete = \"inline\";\n                    } else {\n                        autocomplete = \"none\";\n                    }\n                } else {\n                    if (options.suggest === true) {\n                        autocomplete = \"both\";\n                    } else {\n                        autocomplete = \"list\";\n                    }\n                }\n\n                element.attr(ARIA_AUTOCOMPLETE, autocomplete);\n            }\n\n            id = id ? id + \" \" + that.ul[0].id : that.ul[0].id;\n\n            element.attr({\n                \"aria-owns\": id,\n                \"aria-controls\": id\n            });\n\n            if (that.filterInput && that.filterInput.length > 0) {\n                that.filterInput.attr(ARIA_CONTROLS, id);\n            }\n\n            that.ul.attr(ARIA_LIVE, !that._isFilterEnabled() ? \"off\" : \"polite\");\n\n            that._ariaLabel(that._focused);\n        },\n\n        _blur: function() {\n            var that = this;\n\n            that._change();\n            that.close();\n            that._userTriggered = false;\n        },\n\n        _isValueChanged: function(value) {\n            return value !== unifyType(this._old, typeof value);\n        },\n\n        _change: function() {\n            var that = this;\n            var index = that.selectedIndex;\n            var optionValue = that.options.value;\n            var value = that.value();\n            var trigger;\n\n            if (that._isSelect && !that.listView.bound() && optionValue) {\n                value = optionValue;\n            }\n\n            if (that._isValueChanged(value)) {\n                trigger = true;\n            } else if (that._valueBeforeCascade !== undefined && that._valueBeforeCascade !== unifyType(that._old, typeof that._valueBeforeCascade) && that._userTriggered) {\n                trigger = true;\n            } else if (index !== undefined && index !== that._oldIndex && !that.listView.isFiltered()) {\n                trigger = true;\n            }\n\n            if (trigger) {\n\n                if (that._old === null || that._old === \"\" || value === \"\") {\n                    that._valueBeforeCascade = that._old = value;\n                } else {\n                    if (that.dataItem()) {\n                        that._valueBeforeCascade = that._old = that.options.dataValueField ? that.dataItem()[that.options.dataValueField] : that.dataItem();\n                    } else {\n                        that._valueBeforeCascade = that._old = null;\n                    }\n                }\n                that._oldIndex = index;\n\n                if (!that._typing) {\n                    // trigger the DOM change event so any subscriber gets notified\n                    that.element.trigger(CHANGE);\n                }\n\n                that.trigger(CHANGE);\n            }\n\n            that.typing = false;\n        },\n\n        _data: function() {\n            return this.dataSource.view();\n        },\n\n        _enable: function() {\n            var that = this,\n                options = that.options,\n                disabled = that.element.is(\"[disabled]\");\n\n            if (options.enable !== undefined) {\n                options.enabled = options.enable;\n            }\n\n            if (!options.enabled || disabled) {\n                that.enable(false);\n            } else {\n                that.readonly(that.element.is(\"[readonly]\"));\n            }\n        },\n\n        _dataValue: function(dataItem) {\n            var value = this._value(dataItem);\n\n            if (value === undefined) {\n                value = this._text(dataItem);\n            }\n\n            return value;\n        },\n\n        _offsetHeight: function() {\n            var offsetHeight = 0;\n            var siblings = this.listView.content.parent().prevAll(\":visible\");\n\n            siblings.each(function() {\n                var element = $(this);\n\n                offsetHeight += outerHeight(element, true);\n            });\n\n            return offsetHeight;\n        },\n\n        _height: function(length) {\n            var that = this;\n            var list = that.list;\n            var height = that.options.height;\n            var visible = that.popup.visible();\n            var isMccb = this.options.columns && this.options.columns.length;\n            var offsetTop, popups;\n\n            if (length || that.options.noDataTemplate) {\n                // Check where animation container stays\n                popups = list.parent().add(list.closest(\".k-animation-container\")).show();\n\n                if (!list.parent().is(\":visible\")) {\n                    popups.hide();\n                    return;\n                }\n\n                height = that.listView.content[0].scrollHeight > height ? height : \"auto\";\n\n                popups.height(height);\n\n                if (height !== \"auto\") {\n                    offsetTop = that._offsetHeight();\n\n                    height = height - offsetTop;\n\n                    if (isMccb) {\n                        height = height - (outerHeight($(that.footer)) || 0) - (outerHeight($(that.columnsHeader)) || 0);\n                    }\n                }\n\n                if (isMccb) {\n                    that.listView.content.outerHeight(height);\n                } else {\n                    that.listView.content.parent().outerHeight(height);\n                }\n\n                if (!visible) {\n                    popups.hide();\n                }\n            }\n\n            return height;\n        },\n\n        _openHandler: function(e) {\n            var current;\n\n            this._adjustListWidth();\n\n            if (this.trigger(OPEN)) {\n                e.preventDefault();\n            } else {\n                this._focused.attr(ARIA_EXPANDED, true);\n                this.ul.attr(ARIA_HIDDEN, false);\n\n                current = this.listView.focus();\n                if (current) {\n                    this._focused.add(this.filterInput).attr(ARIA_ACTIVEDESCENDANT, current.attr(\"id\"));\n                }\n            }\n        },\n\n        _adjustListWidth: function() {\n            var that = this,\n                list = that.list.parent(),\n                width = list[0].style.width,\n                wrapper = that.wrapper,\n                computedStyle, computedWidth;\n\n            if (!list.data(WIDTH) && width) {\n                return;\n            }\n\n            computedStyle = window.getComputedStyle ? window.getComputedStyle(wrapper[0], null) : 0;\n            computedWidth = parseFloat(computedStyle && computedStyle.width) || outerWidth(wrapper);\n\n            if (computedStyle && browser.msie) { // getComputedStyle returns different box in IE.\n                computedWidth += parseFloat(computedStyle.paddingLeft) + parseFloat(computedStyle.paddingRight) + parseFloat(computedStyle.borderLeftWidth) + parseFloat(computedStyle.borderRightWidth);\n            }\n\n            if (list.css(\"box-sizing\") !== \"border-box\") {\n                width = computedWidth - (outerWidth(list) - list.width());\n            } else {\n                width = computedWidth;\n            }\n\n            list.css({\n                fontFamily: wrapper.css(\"font-family\"),\n                width: that.options.autoWidth ? \"auto\" : width,\n                minWidth: width,\n                whiteSpace: that.options.autoWidth ? \"nowrap\" : \"normal\"\n            })\n            .data(WIDTH, width);\n\n            return true;\n        },\n\n        _closeHandler: function(e) {\n            if (this.trigger(CLOSE)) {\n                e.preventDefault();\n            } else {\n                this._focused.attr(ARIA_EXPANDED, false);\n                this.ul.attr(ARIA_HIDDEN, true);\n                this._focused.add(this.filterInput).removeAttr(ARIA_ACTIVEDESCENDANT);\n            }\n        },\n\n        _focusItem: function() {\n            var listView = this.listView;\n            var noFocusedItem = !listView.focus();\n            var index = last(listView.select());\n\n            if (index === undefined && this.options.highlightFirst && noFocusedItem) {\n                index = 0;\n            }\n\n            if (index !== undefined) {\n                listView.focus(index);\n            } else if (noFocusedItem) {\n                listView.scrollToIndex(0);\n            }\n        },\n\n        _calculateGroupPadding: function(height) {\n            var li = this.ul.children(\".k-first\").first();\n            var groupHeader = this.listView.content.prev(FIXED_GROUP_HEADER);\n            var padding = 0;\n            var direction = 'right';\n\n            if (groupHeader[0] && groupHeader[0].style.display !== \"none\") {\n                if (height !== \"auto\") {\n                    padding = kendo.support.scrollbar();\n                }\n\n                if (this.element.parents('.k-rtl').length) {\n                    direction = 'left';\n                }\n\n                padding += parseFloat(li.css(\"border-\" + direction + \"-width\"), 10) + parseFloat(li.children(GROUP_LABEL).css(\"padding-\" + direction), 10);\n                groupHeader.css(\"padding-\" + direction, padding);\n            }\n        },\n\n        _calculatePopupHeight: function(force) {\n            var height = this._height(this.dataSource.flatView().length || force);\n            this._calculateGroupPadding(height);\n            this._calculateColumnsHeaderPadding(height);\n        },\n\n        _calculateColumnsHeaderPadding: function(height) {\n            if (this.options.columns && this.options.columns.length) {\n                var list = this;\n                var isRtl = support.isRtl(list.wrapper);\n                var scrollbar = kendo.support.scrollbar();\n\n                list.columnsHeader.css((isRtl ? \"padding-left\" : \"padding-right\"), height !== \"auto\" ? scrollbar : 0);\n            }\n        },\n\n        _refreshScroll: function() {\n            var listView = this.listView;\n            var enableYScroll = listView.element.height() > listView.content.height();\n\n            if (this.options.autoWidth) {\n                listView.content.css({\n                    overflowX: \"hidden\",\n                    overflowY: enableYScroll ? \"scroll\" : \"auto\"\n                });\n            }\n        },\n\n        _resizePopup: function(force) {\n            if (this.options.virtual) {\n                return;\n            }\n\n            if (!this.popup.element.is(\":visible\")) {\n                this.popup.one(\"open\", (function(force) {\n                    return (function() {\n                        this._calculatePopupHeight(force);\n                    }).bind(this);\n                }).call(this, force));\n\n                this.popup.one(ACTIVATE, this._refreshScroll.bind(this));\n            } else {\n                this._calculatePopupHeight(force);\n            }\n        },\n\n        _popup: function() {\n            var list = this;\n\n            list.list.wrap(\"<div>\");\n\n            list.popup = new ui.Popup(list.list.parent(), extend({}, list.options.popup, {\n                anchor: list.wrapper,\n                open: list._openHandler.bind(list),\n                close: list._closeHandler.bind(list),\n                animation: list.options.animation,\n                isRtl: support.isRtl(list.wrapper),\n                autosize: list.options.autoWidth\n            }));\n\n            list.popup.element.prepend(list.header)\n                .on(MOUSEDOWN + this.ns, this._listMousedown.bind(this));\n        },\n\n        _toggleHover: function(e) {\n            $(e.currentTarget).toggleClass(HOVER, e.type === MOUSEENTER);\n        },\n\n        _toggle: function(open, preventFocus) {\n            var that = this;\n            var touchEnabled = support.mobileOS && (support.touch || support.MSPointers || support.pointers);\n\n            open = open !== undefined ? open : !that.popup.visible();\n\n            if (!preventFocus && !touchEnabled && that._focused[0] !== activeElement()) {\n                that._prevent = true;\n                that._focused.trigger(FOCUS);\n                that._prevent = false;\n            }\n\n            that[open ? OPEN : CLOSE]();\n        },\n\n        _triggerCascade: function() {\n            var that = this;\n\n            if (!that._cascadeTriggered || that.value() !== unifyType(that._cascadedValue, typeof that.value())) {\n                that._cascadedValue = that.value();\n                that._cascadeTriggered = true;\n                that.trigger(CASCADE, { userTriggered: that._userTriggered });\n            }\n        },\n\n        _triggerChange: function() {\n            if (this._valueBeforeCascade !== this.value()) {\n                this.trigger(CHANGE);\n            }\n        },\n\n        _unbindDataSource: function() {\n            var that = this;\n\n            that.dataSource.unbind(REQUESTSTART, that._requestStartHandler)\n                           .unbind(REQUESTEND, that._requestEndHandler)\n                           .unbind(\"error\", that._errorHandler);\n        },\n\n        requireValueMapper: function(options, value) {\n            var hasValue = (options.value instanceof Array ? options.value.length : options.value) || (value instanceof Array ? value.length : value);\n            if (hasValue && options.virtual && typeof options.virtual.valueMapper !== \"function\") {\n                throw new Error(\"ValueMapper is not provided while the value is being set. See http://docs.telerik.com/kendo-ui/controls/editors/combobox/virtualization#the-valuemapper-function\");\n            }\n        }\n    });\n\n    function unifyType(value, type) {\n        if (value !== undefined && value !== \"\" && value !== null) {\n            if (type === \"boolean\") {\n                if (typeof value !== \"boolean\") {\n                    value = value.toString().toLowerCase() === \"true\";\n                }\n                value = Boolean(value);\n            } else if (type === \"number\") {\n                value = Number(value);\n            } else if (type === \"string\") {\n                value = value.toString();\n            }\n        }\n\n        return value;\n    }\n\n    extend(List, {\n        inArray: function(node, parentNode) {\n            var idx, length, siblings = parentNode.children;\n\n            if (!node || node.parentNode !== parentNode) {\n                return -1;\n            }\n\n            for (idx = 0, length = siblings.length; idx < length; idx++) {\n                if (node === siblings[idx]) {\n                    return idx;\n                }\n            }\n\n            return -1;\n        },\n        unifyType: unifyType\n    });\n\n    kendo.ui.List = List;\n\n    ui.Select = List.extend({\n        init: function(element, options) {\n            List.fn.init.call(this, element, options);\n            this._initial = this.element.val();\n        },\n\n        setDataSource: function(dataSource) {\n            var that = this;\n            var parent;\n\n            that.options.dataSource = dataSource;\n\n            that._dataSource();\n\n            if (that.listView.bound()) {\n                that._initialIndex = null;\n                that.listView._current = null;\n            }\n\n            that.listView.setDataSource(that.dataSource);\n\n            if (that.options.autoBind) {\n                that.dataSource.fetch();\n            }\n\n            parent = that._parentWidget();\n\n            if (parent) {\n                that._cascadeSelect(parent);\n            }\n        },\n\n        close: function() {\n            this.popup.close();\n        },\n\n        select: function(candidate) {\n            var that = this;\n\n            if (candidate === undefined) {\n                return that.selectedIndex;\n            } else {\n                return that._select(candidate).done(function() {\n                    that._cascadeValue = that._old = that._accessor();\n                    that._oldIndex = that.selectedIndex;\n                });\n            }\n        },\n\n        _accessor: function(value, idx) {\n            return this[this._isSelect ? \"_accessorSelect\" : \"_accessorInput\"](value, idx);\n        },\n\n        _accessorInput: function(value) {\n            var element = this.element[0];\n\n            if (value === undefined) {\n                return element.value;\n            } else {\n                if (value === null) {\n                    value = \"\";\n                }\n                element.value = value;\n            }\n        },\n\n        _accessorSelect: function(value, idx) {\n            var element = this.element[0];\n            var hasValue;\n\n            if (value === undefined) {\n                return getSelectedOption(element).value || \"\";\n            }\n\n            getSelectedOption(element).selected = false;\n\n            if (idx === undefined) {\n                idx = -1;\n            }\n\n            hasValue = (value !== null && value !== \"\");\n\n            if (hasValue && idx == -1) {\n                this._custom(value);\n            } else {\n                if (value) {\n                    element.value = value;\n                } else {\n                    element.selectedIndex = idx;\n                }\n            }\n        },\n\n        _syncValueAndText: function() {\n            return true;\n        },\n\n        _custom: function(value) {\n            var that = this;\n            var element = that.element;\n            var custom = that._customOption;\n\n            if (!custom) {\n                custom = $(\"<option/>\");\n                that._customOption = custom;\n\n                element.append(custom);\n            }\n\n            custom.text(value);\n            custom[0].selected = true;\n        },\n\n        _hideBusy: function() {\n            var that = this;\n            clearTimeout(that._busy);\n            that._arrowIcon.removeClass(LOADING);\n            that._focused.attr(ARIA_BUSY, false);\n            that._busy = null;\n            that._showClear();\n        },\n\n        _showBusy: function(e) {\n            var that = this;\n\n            if (e.isDefaultPrevented()) {\n                return;\n            }\n\n            that._request = true;\n\n            if (that._busy) {\n                return;\n            }\n\n            that._busy = setTimeout(function() {\n                if (that._arrowIcon) { //destroyed after request start\n                    that._focused.attr(ARIA_BUSY, true);\n                    that._arrowIcon.addClass(LOADING);\n                    that._hideClear();\n                }\n            }, 100);\n        },\n\n        _requestEnd: function() {\n            this._request = false;\n            this._hideBusy();\n        },\n\n        _dataSource: function() {\n            var that = this,\n                element = that.element,\n                options = that.options,\n                dataSource = options.dataSource || {},\n                idx;\n\n            dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n\n            if (that._isSelect) {\n                idx = element[0].selectedIndex;\n                if (idx > -1) {\n                    options.index = idx;\n                }\n\n                dataSource.select = element;\n                dataSource.fields = [{ field: options.dataTextField },\n                                     { field: options.dataValueField }];\n            }\n\n            if (that.dataSource) {\n                that._unbindDataSource();\n            } else {\n                that._requestStartHandler = that._showBusy.bind(that);\n                that._requestEndHandler = that._requestEnd.bind(that);\n                that._errorHandler = that._hideBusy.bind(that);\n            }\n\n            that.dataSource = kendo.data.DataSource.create(dataSource)\n                                   .bind(REQUESTSTART, that._requestStartHandler)\n                                   .bind(REQUESTEND, that._requestEndHandler)\n                                   .bind(\"error\", that._errorHandler);\n        },\n\n        _firstItem: function() {\n            this.listView.focusFirst();\n        },\n\n        _lastItem: function() {\n            this.listView.focusLast();\n        },\n\n        _nextItem: function() {\n            return this.listView.focusNext();\n        },\n\n        _prevItem: function() {\n            return this.listView.focusPrev();\n        },\n\n        _getNormalizedDataItem: function(candidate) {\n            var that = this,\n                listView = that.listView,\n                isIndex = typeof candidate === \"number\",\n                hasOptionLabel = that.optionLabel && that.optionLabel.length,\n                index;\n\n            if (isIndex) {\n                index = hasOptionLabel ? --candidate : candidate;\n            } else {\n                index = listView.getElementIndex(candidate);\n            }\n\n            return listView.dataItemByIndex(index);\n        },\n\n        _getNormalizedSelectCandidate: function(candidate) {\n            var that = this,\n                hasOptionLabel = that.optionLabel && that.optionLabel.length,\n                isIndex = typeof candidate === \"number\",\n                normalizedCandidate = candidate;\n\n            if (hasOptionLabel && isIndex) {\n                normalizedCandidate++;\n            }\n\n            return normalizedCandidate;\n        },\n\n        _move: function(e) {\n            var that = this;\n            var listView = that.listView;\n            var key = e.keyCode;\n            var down = key === keys.DOWN;\n            var isVirtual = that.options.virtual;\n            var dataItem;\n            var pressed;\n            var current;\n            var moveIndex;\n            var selectCandidate;\n\n            if (key === keys.UP || down) {\n                if (e.altKey) {\n                    that.toggle(down);\n                } else {\n                    if (!listView.bound() && !that.ul[0].firstChild) {\n                        if (!that._fetch) {\n                            that.dataSource.one(CHANGE, function() {\n                                that._fetch = false;\n                                that._move(e);\n                            });\n\n                            that._fetch = true;\n                            that._filterSource();\n                        }\n\n                        e.preventDefault();\n\n                        return true; //pressed\n                    }\n\n                    current = that._focus();\n\n                    if (!that._fetch && (!current || current.hasClass(KSELECTED))) {\n                        if (down) {\n                            moveIndex = that._nextItem();\n\n                            if ((isVirtual && moveIndex <= 0) || (!that._focus() && !moveIndex) ) {\n                                that._lastItem();\n                            }\n                        } else {\n                            moveIndex = that._prevItem();\n\n                            if ((isVirtual && moveIndex >= listView.dataSource.total() - 1) || (!that._focus() && !moveIndex)) {\n                                that._firstItem();\n                            }\n                        }\n                    }\n\n                    selectCandidate = that._getNormalizedSelectCandidate(that._get(that._focus()) || moveIndex || 0);\n\n                    that._select(selectCandidate, true).done(function() {\n                        var done = function() {\n                            if (!that.popup.visible()) {\n                                that._blur();\n                            }\n\n                            if (that._cascadedValue === null) {\n                                that._cascadedValue = that.value();\n                            } else {\n                                that._cascadedValue = that.dataItem() ? that.dataItem()[that.options.dataValueField] || that.dataItem() : null;\n                            }\n                        };\n\n                        if (that.trigger(SELECT, { dataItem: that._getNormalizedDataItem(selectCandidate), item: that._focus() })) {\n                            that._select(current).done(done);\n                        } else {\n                            done();\n                        }\n                    });\n                }\n\n                e.preventDefault();\n                pressed = true;\n            } else if (key === keys.ENTER || key === keys.TAB) {\n                if (that.popup.visible()) {\n                    e.preventDefault();\n                }\n\n                current = that._focus();\n                dataItem = that.dataItem();\n\n                if (!that.popup.visible() && (!dataItem || that.text() !== that._text(dataItem))) {\n                    current = null;\n                }\n\n                var activeFilter = that.filterInput && that.filterInput[0] === activeElement();\n                var selection;\n\n                if (current) {\n                    dataItem = listView.dataItemByIndex(listView.getElementIndex(current));\n                    var shouldTrigger = true;\n\n                    if (dataItem) {\n                        shouldTrigger = that._value(dataItem) !== List.unifyType(that.value(), typeof that._value(dataItem));\n                    }\n\n                    if (shouldTrigger && that.trigger(SELECT, { dataItem: dataItem, item: current })) {\n                        return;\n                    }\n\n                    selection = that._select(current);\n                } else if (that.input) {\n                    if (that._syncValueAndText() || that._isSelect) {\n                        that._accessor(that.input.val());\n                    }\n                    that.listView.value(that.input.val());\n                }\n\n                if (that._focusElement) {\n                    that._focusElement(that.wrapper);\n                }\n\n                if (activeFilter && key === keys.TAB) {\n                    that.wrapper.focusout();\n                } else {\n                    if (selection && typeof selection.done === \"function\") {\n                        selection.done(function() {\n                            that._blur();\n                        });\n                    } else {\n                        that._blur();\n                    }\n                }\n\n                that.close();\n                pressed = true;\n            } else if (key === keys.ESC) {\n                if (that.popup.visible()) {\n                    e.preventDefault();\n                }\n                that.close();\n                pressed = true;\n            } else if (that.popup.visible() && (key === keys.PAGEDOWN || key === keys.PAGEUP)) {\n                e.preventDefault();\n\n                var direction = key === keys.PAGEDOWN ? 1 : -1;\n                listView.scrollWith(direction * listView.screenHeight());\n\n                pressed = true;\n            }\n\n            return pressed;\n        },\n\n        _fetchData: function() {\n            var that = this;\n            var hasItems = !!that.dataSource.view().length;\n\n            if (that._request || that.options.cascadeFrom) {\n                return;\n            }\n\n            if (!that.listView.bound() && !that._fetch && !hasItems) {\n                that._fetch = true;\n                that.dataSource.fetch().done(function() {\n                    that._fetch = false;\n                });\n            }\n        },\n\n        _options: function(data, optionLabel, value) {\n            var that = this,\n                element = that.element,\n                htmlElement = element[0],\n                length = data.length,\n                options = \"\",\n                option,\n                dataItem,\n                dataText,\n                dataValue,\n                idx = 0;\n\n            if (optionLabel) {\n                options = optionLabel;\n            }\n\n            for (; idx < length; idx++) {\n                option = \"<option\";\n                dataItem = data[idx];\n                dataText = that._text(dataItem);\n                dataValue = that._value(dataItem);\n\n                if (dataValue !== undefined) {\n                    dataValue += \"\";\n\n                    if (dataValue.indexOf('\"') !== -1) {\n                        dataValue = dataValue.replace(quotRegExp, \"&quot;\");\n                    }\n\n                    option += ' value=\"' + dataValue + '\"';\n                }\n\n                option += \">\";\n\n                if (dataText !== undefined) {\n                    option += htmlEncode(dataText);\n                }\n\n                option += \"</option>\";\n                options += option;\n            }\n\n            element.html(options);\n\n            if (value !== undefined) {\n                htmlElement.value = value;\n                if (htmlElement.value && !value) {\n                    htmlElement.selectedIndex = -1;\n                }\n            }\n\n            if (htmlElement.selectedIndex !== -1) {\n                option = getSelectedOption(htmlElement);\n\n                if (option) {\n                    option.setAttribute(SELECTED, SELECTED);\n                }\n            }\n        },\n\n        _reset: function() {\n            var that = this,\n                element = that.element,\n                formId = element.attr(\"form\"),\n                form = formId ? $(\"#\" + formId) : element.closest(\"form\");\n\n            if (form[0]) {\n                that._resetHandler = function() {\n                    setTimeout(function() {\n                        that.value(that._initial);\n                    });\n                };\n\n                that._form = form.on(\"reset\", that._resetHandler);\n            }\n        },\n\n        _parentWidget: function() {\n            var name = this.options.name;\n\n            if (!this.options.cascadeFrom) {\n                return;\n            }\n\n            var parentElement = $(\"#\" + this.options.cascadeFrom);\n            var parent = parentElement.data(\"kendo\" + name);\n\n            if (!parent) {\n                for (var i = 0; i < alternativeNames[name].length; i += 1) {\n                    parent = parentElement.data(\"kendo\" + alternativeNames[name][i]);\n\n                    if (!!parent) {\n                        break;\n                    }\n                }\n            }\n\n            return parent;\n        },\n\n        _cascade: function() {\n            var that = this;\n            var options = that.options;\n            var cascade = options.cascadeFrom;\n            var parent;\n\n            if (cascade) {\n                parent = that._parentWidget();\n\n                if (!parent) {\n                    return;\n                }\n\n                that._cascadeHandlerProxy = that._cascadeHandler.bind(that);\n                that._cascadeFilterRequests = [];\n\n                options.autoBind = false;\n\n                parent.bind(\"set\", function() { //will cascade\n                    that.one(\"set\", function(e) { //get your value\n                        that._selectedValue = e.value || that._accessor();\n                    });\n                });\n\n                parent.first(CASCADE, that._cascadeHandlerProxy);\n\n                //refresh was called\n                if (parent.listView.bound()) {\n                    that._toggleCascadeOnFocus();\n                    that._cascadeSelect(parent);\n                } else {\n                    parent.one(DATA_BOUND, function() {\n                        that._toggleCascadeOnFocus();\n                        if (parent.popup.visible()) {\n                            parent._focused.trigger(FOCUS);\n                        }\n                    });\n\n                    if (!parent.value()) {\n                        that.enable(false);\n                    }\n                }\n            }\n        },\n\n        _toggleCascadeOnFocus: function() {\n            var that = this;\n            var parent = that._parentWidget();\n            var focusout = isIE && parent instanceof ui.DropDownList ? BLUR : FOCUSOUT;\n\n            parent._focused.add(parent.filterInput).on(FOCUS, function() {\n                parent.unbind(CASCADE, that._cascadeHandlerProxy);\n                parent.unbind(CHANGE, that._cascadeHandlerProxy);\n                parent.first(CHANGE, that._cascadeHandlerProxy);\n            });\n\n            parent._focused.add(parent.filterInput).on(focusout, function() {\n                parent.unbind(CHANGE, that._cascadeHandlerProxy);\n                parent.unbind(CASCADE, that._cascadeHandlerProxy);\n                parent.first(CASCADE, that._cascadeHandlerProxy);\n            });\n        },\n\n        _cascadeHandler: function(e) {\n            var parent = this._parentWidget();\n            var valueBeforeCascade = this.value();\n\n            this._userTriggered = e.userTriggered || parent._userTriggered;\n\n            if (this.listView.bound()) {\n                this._clearSelection(parent, true);\n            }\n\n            this._cascadeSelect(parent, valueBeforeCascade);\n        },\n\n        _cascadeChange: function(parent) {\n            var that = this;\n            var value = that._accessor() || that._selectedValue;\n\n            if (!that._cascadeFilterRequests.length) {\n                that._selectedValue = null;\n            }\n\n            if (that._userTriggered) {\n                that._clearSelection(parent, true);\n            } else if (value) {\n                if (value !== unifyType(that.listView.value()[0], typeof value)) {\n                    that.value(value);\n                }\n\n                if (!that.dataSource.view()[0] || that.selectedIndex === -1) {\n                    that._clearSelection(parent, true);\n                }\n            } else if (that.dataSource.flatView().length) {\n                that.select(that.options.index);\n            }\n\n            that.enable();\n            that._triggerCascade();\n            that._triggerChange();\n            that._userTriggered = false;\n        },\n\n        _cascadeSelect: function(parent, valueBeforeCascade) {\n            var that = this;\n            var dataItem = parent.dataItem();\n            var filterValue = dataItem ? dataItem[that.options.cascadeFromParentField] || parent._value(dataItem) : null;\n            var valueField = that.options.cascadeFromField || parent.options.dataValueField;\n            var expressions;\n\n            that._valueBeforeCascade = valueBeforeCascade !== undefined ? valueBeforeCascade : that.value();\n\n            if (filterValue || filterValue === 0) {\n                expressions = that.dataSource.filter() || {};\n                removeFiltersForField(expressions, valueField);\n\n                var handler = function() {\n                    var currentHandler = that._cascadeFilterRequests.shift();\n                    if (currentHandler) {\n                        that.unbind('dataBound', currentHandler);\n                    }\n\n                    currentHandler = that._cascadeFilterRequests[0];\n                    if (currentHandler) {\n                        that.first('dataBound', currentHandler);\n                    }\n\n                    that._cascadeChange(parent);\n                };\n\n                that._cascadeFilterRequests.push(handler);\n\n                if (that._cascadeFilterRequests.length === 1) {\n                    that.first('dataBound', handler);\n                }\n\n                that._cascading = true;\n                that._filterSource({\n                    field: valueField,\n                    operator: \"eq\",\n                    value: filterValue\n                });\n                that._cascading = false;\n            } else {\n                that.enable(false);\n                that._clearSelection(parent);\n                that._triggerCascade();\n                that._triggerChange();\n                that._userTriggered = false;\n            }\n        }\n    });\n\n    var STATIC_LIST_NS = \".StaticList\";\n\n    var StaticList = kendo.ui.DataBoundWidget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n\n            this.element.attr(\"role\", \"listbox\")\n                        .on(CLICK + STATIC_LIST_NS, \"li\", this._click.bind(this))\n                        .on(MOUSEENTER + STATIC_LIST_NS, \"li\", function() { $(this).addClass(HOVER); })\n                        .on(MOUSELEAVE + STATIC_LIST_NS, \"li\", function() { $(this).removeClass(HOVER); });\n\n            if (options && options.ariaLabel) {\n                this.element.attr(ARIA_LABEL, options.ariaLabel);\n            } else if (options && options.ariaLabelledBy) {\n                this.element.attr(ARIA_LABELLEDBY, options.ariaLabelledBy);\n            }\n\n            if (support.touch) {\n                this._touchHandlers();\n            }\n\n            if (this.options.selectable === \"multiple\") {\n                this.element.attr(ARIA_MULTISELECTABLE, true);\n            }\n\n            if (this.options.columns && this.options.columns.length) {\n                var thead = this.element.parent().find('.k-table-thead');\n                var row = $('<tr class=\"k-table-group-row\">' +\n                    '<th class=\"k-table-th\" colspan=\"' + this.options.columns.length + '\"></th>' +\n                '</tr>');\n\n                thead.append(row);\n\n                this.header = row.find(\".k-table-th\");\n\n                this.content = this.element.wrap(\"<div class='k-table-body k-table-scroller' unselectable='on'></div>\").parent();\n\n                this.element.addClass(TABLE_LIST);\n            } else {\n                this.content = this.element.wrap(\"<div class='k-list-content k-list-scroller' unselectable='on'></div>\").parent();\n                this.header = this.content.before('<div class=\"k-list-group-sticky-header\" style=\"display:none\"></div>').prev();\n                this.element.addClass(LIST_UL);\n            }\n\n            this.bound(false);\n\n            this._optionID = kendo.guid();\n\n            this._selectedIndices = [];\n\n            this._view = [];\n            this._dataItems = [];\n            this._values = [];\n\n            var value = this.options.value;\n\n            if (value) {\n                this._values = Array.isArray(value) ? value.slice(0) : [value];\n            }\n\n            this._getter();\n            this._templates();\n\n            this.setDataSource(this.options.dataSource);\n\n            this._createOnScrollProxy();\n        },\n\n        options: {\n            name: \"StaticList\",\n            dataValueField: null,\n            valuePrimitive: false,\n            selectable: true,\n            template: null,\n            groupTemplate: null,\n            fixedGroupTemplate: null,\n            ariaLabel: null,\n            ariaLabelledBy: null\n        },\n\n        events: [\n           CLICK,\n            CHANGE,\n           ACTIVATE,\n           DEACTIVATE,\n           DATA_BINDING,\n           DATA_BOUND,\n           SELECTED_ITEM_CHANGE\n        ],\n\n        setDataSource: function(source) {\n            var that = this;\n            var dataSource = source || {};\n            var value;\n\n            dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n            dataSource = kendo.data.DataSource.create(dataSource);\n\n            if (that.dataSource) {\n                that.dataSource.unbind(CHANGE, that._refreshHandler);\n\n                value = that.value();\n\n                that.value([]);\n                that.bound(false);\n\n                that.value(value);\n            } else {\n                that._refreshHandler = that.refresh.bind(that);\n            }\n\n            that.setDSFilter(dataSource.filter());\n\n            that.dataSource = dataSource.bind(CHANGE, that._refreshHandler);\n            that._fixedHeader();\n        },\n\n        _touchHandlers: function() {\n            var that = this;\n            var startY;\n            var endY;\n            var tapPosition = function(event) {\n                return (event.originalEvent || event).changedTouches[0].pageY;\n            };\n\n            that.element.on(\"touchstart\" + STATIC_LIST_NS, function(e) {\n                startY = tapPosition(e);\n            });\n\n            that.element.on(\"touchend\" + STATIC_LIST_NS, function(e) {\n                if (e.isDefaultPrevented()) {\n                    return;\n                }\n\n                endY = tapPosition(e);\n\n                if (Math.abs(endY - startY) < 10) {\n                    that._touchTriggered = true;\n                    that._triggerClick($(e.target).closest(ITEMSELECTOR).get(0));\n                }\n            });\n        },\n\n        skip: function() {\n            return this.dataSource.skip();\n        },\n\n        setOptions: function(options) {\n            Widget.fn.setOptions.call(this, options);\n\n            this._getter();\n            this._templates();\n            this._render();\n        },\n\n        destroy: function() {\n            this.element.off(STATIC_LIST_NS);\n\n            if (this._refreshHandler) {\n                this.dataSource.unbind(CHANGE, this._refreshHandler);\n            }\n\n            clearTimeout(this._scrollId);\n\n            Widget.fn.destroy.call(this);\n        },\n\n        dataItemByIndex: function(index) {\n            return this.dataSource.flatView()[index];\n        },\n\n        screenHeight: function() {\n            return this.content[0].clientHeight;\n        },\n\n        scrollToIndex: function(index) {\n            var item = this.element[0].children[index];\n\n            if (item) {\n                this.scroll(item);\n            }\n        },\n\n        scrollWith: function(value) {\n            this.content.scrollTop(this.content.scrollTop() + value);\n        },\n\n        scroll: function(item) {\n            if (!item) {\n                return;\n            }\n\n            if (item[0]) {\n                item = item[0];\n            }\n\n            var content = this.content[0],\n                itemOffsetTop = item.offsetTop,\n                itemOffsetHeight = item.offsetHeight,\n                contentScrollTop = content.scrollTop,\n                contentOffsetHeight = content.clientHeight,\n                bottomDistance = itemOffsetTop + itemOffsetHeight;\n\n                if (contentScrollTop > itemOffsetTop) {\n                    contentScrollTop = itemOffsetTop;\n                } else if (bottomDistance > (contentScrollTop + contentOffsetHeight)) {\n                    contentScrollTop = (bottomDistance - contentOffsetHeight);\n                }\n\n                content.scrollTop = contentScrollTop;\n        },\n\n        selectedDataItems: function(dataItems) {\n            if (dataItems === undefined) {\n                return this._dataItems.slice();\n            }\n\n            this._dataItems = dataItems;\n            this._values = this._getValues(dataItems);\n        },\n\n        _getValues: function(dataItems) {\n            var getter = this._valueGetter;\n\n            return $.map(dataItems, function(dataItem) {\n                return getter(dataItem);\n            });\n        },\n\n        focusNext: function() {\n            var current = this.focus();\n\n            if (!current) {\n                current = 0;\n            } else {\n                current = current.next();\n            }\n\n            this.focus(current);\n        },\n\n        focusPrev: function() {\n            var current = this.focus();\n\n            if (!current) {\n                current = this.element[0].children.length - 1;\n            } else {\n                current = current.prev();\n            }\n\n            this.focus(current);\n        },\n\n        focusFirst: function() {\n            this.focus(this.element[0].children[0]);\n        },\n\n        focusLast: function() {\n            this.focus(last(this.element[0].children));\n        },\n\n        focus: function(candidate) {\n            var that = this;\n            var id = that._optionID;\n            var hasCandidate;\n\n            if (candidate === undefined) {\n                return that._current;\n            }\n\n            candidate = last(that._get(candidate));\n            candidate = $(this.element[0].children[candidate]);\n\n            if (that._current) {\n                that._current\n                    .removeClass(FOCUSED)\n                    .removeAttr(ID);\n\n                that.trigger(DEACTIVATE);\n            }\n\n            hasCandidate = !!candidate[0];\n\n            if (hasCandidate) {\n                candidate.addClass(FOCUSED);\n                that.scroll(candidate);\n\n                candidate.attr(\"id\", id);\n            }\n\n            that._current = hasCandidate ? candidate : null;\n            that.trigger(ACTIVATE);\n        },\n\n        focusIndex: function() {\n            return this.focus() ? this.focus().index() : undefined;\n        },\n\n        skipUpdate: function(skipUpdate) {\n            this._skipUpdate = skipUpdate;\n        },\n\n        select: function(indices) {\n            var that = this;\n            var selectable = that.options.selectable;\n            var singleSelection = selectable !== \"multiple\" && selectable !== false;\n            var selectedIndices = that._selectedIndices;\n            var uiSelectedIndices = [this.element.find(\".k-selected\").index()];\n\n            var added = [];\n            var removed = [];\n            var result;\n\n            if (indices === undefined) {\n                return selectedIndices.slice();\n            }\n\n            indices = that._get(indices);\n\n            if (indices.length === 1 && indices[0] === -1) {\n                indices = [];\n            }\n\n            var deferred = $.Deferred().resolve();\n            var filtered = that.isFiltered();\n\n            if (filtered && !singleSelection && that._deselectFiltered(indices)) {\n                return deferred;\n            }\n\n            if (singleSelection && !filtered &&\n                $.inArray(last(indices), selectedIndices) !== -1 && $.inArray(last(indices), uiSelectedIndices) !== -1) {\n\n                if (that._dataItems.length && that._view.length) {\n                    that._dataItems = [that._view[selectedIndices[0]].item];\n                }\n\n                return deferred;\n            }\n\n            result = that._deselect(indices);\n\n            removed = result.removed;\n            indices = result.indices;\n\n            if (indices.length) {\n                if (singleSelection) {\n                    indices = [last(indices)];\n                }\n\n                added = that._select(indices);\n            }\n\n            if (added.length || removed.length) {\n                that._valueComparer = null;\n                that.trigger(CHANGE, {\n                    added: added,\n                    removed: removed\n                });\n            }\n\n            return deferred;\n        },\n\n        removeAt: function(position) {\n            this._selectedIndices.splice(position, 1);\n            this._values.splice(position, 1);\n            this._valueComparer = null;\n\n            return {\n                position: position,\n                dataItem: this._dataItems.splice(position, 1)[0]\n            };\n        },\n\n        setValue: function(value) {\n            value = Array.isArray(value) || value instanceof ObservableArray ? value.slice(0) : [value];\n\n            this._values = value;\n\n            this._valueComparer = null;\n        },\n\n        value: function(value) {\n            var that = this;\n            var deferred = that._valueDeferred;\n            var indices;\n\n            if (value === undefined) {\n                return that._values.slice();\n            }\n\n            that.setValue(value);\n\n            if (!deferred || deferred.state() === \"resolved\") {\n                that._valueDeferred = deferred = $.Deferred();\n            }\n\n            if (that.bound()) {\n                indices = that._valueIndices(that._values);\n\n                if (that.options.selectable === \"multiple\") {\n                    that.select(-1);\n                }\n\n                that.select(indices);\n\n                deferred.resolve();\n            }\n\n            that._skipUpdate = false;\n\n            return deferred;\n        },\n\n        items: function() {\n            return this.element.children(ITEMSELECTOR);\n        },\n\n        _click: function(e) {\n            if (this._touchTriggered)\n            {\n                this._touchTriggered = false;\n                return;\n            }\n\n            if (!e.isDefaultPrevented()) {\n                this._triggerClick(e.currentTarget);\n            }\n        },\n\n        _createOnScrollProxy: function() {\n            var onScrollProxy = function() {\n                var that = this;\n                clearTimeout(that._scrollId);\n\n                that._scrollId = setTimeout(function() {\n                    that._renderHeader();\n                }, 50);\n            };\n\n            this._onScroll = onScrollProxy.bind(this);\n        },\n\n        _triggerClick: function(item) {\n            if (!this.trigger(CLICK, { item: $(item) })) {\n                this.select(item);\n            }\n        },\n\n        _valueExpr: function(type, values) {\n            var that = this;\n            var idx = 0;\n\n            var body;\n            var comparer;\n            var normalized = [];\n\n            if (!that._valueComparer || that._valueType !== type) {\n                that._valueType = type;\n\n                for (; idx < values.length; idx++) {\n                    normalized.push(unifyType(values[idx], type));\n                }\n\n                body = \"for (var idx = 0; idx < \" + normalized.length + \"; idx++) {\" +\n                        \" if (current === values[idx]) {\" +\n                        \"   return idx;\" +\n                        \" }\" +\n                        \"} \" +\n                        \"return -1;\";\n\n                comparer = new Function(\"current\", \"values\", body);\n\n                that._valueComparer = function(current) {\n                    return comparer(current, normalized);\n                };\n            }\n\n            return that._valueComparer;\n        },\n\n        _dataItemPosition: function(dataItem, values) {\n            var value = this._valueGetter(dataItem);\n\n            var valueExpr = this._valueExpr(typeof value, values);\n\n            return valueExpr(value);\n        },\n\n        _getter: function() {\n            this._valueGetter = kendo.getter(this.options.dataValueField);\n        },\n\n        _deselect: function(indices) {\n            var that = this;\n            var children = that.element[0].children;\n            var selectable = that.options.selectable;\n            var selectedIndices = that._selectedIndices;\n            var dataItems = that._dataItems;\n            var values = that._values;\n            var removed = [];\n            var i = 0;\n            var j;\n\n            var index, selectedIndex;\n            var removedIndices = 0;\n\n            indices = indices.slice();\n\n            if (selectable === true || !indices.length) {\n                for (; i < selectedIndices.length; i++) {\n                    $(children[selectedIndices[i]]).removeClass(KSELECTED).attr(ARIA_SELECTED, false);\n\n                    removed.push({\n                        position: i,\n                        dataItem: dataItems[i]\n                    });\n                }\n\n                that._values = [];\n                that._dataItems = [];\n                that._selectedIndices = [];\n            } else if (selectable === \"multiple\") {\n                for (; i < indices.length; i++) {\n                    index = indices[i];\n\n                    if (!$(children[index]).hasClass(KSELECTED)) {\n                        continue;\n                    }\n\n                    for (j = 0; j < selectedIndices.length; j++) {\n                        selectedIndex = selectedIndices[j];\n\n                        if (selectedIndex === index) {\n                            $(children[selectedIndex]).removeClass(KSELECTED).attr(ARIA_SELECTED, false);\n                            var dataItem = this._view[index].item;\n                            var position = this._dataItemPosition(dataItem, this._values);\n\n                            removed.push({\n                                position: position,\n                                dataItem: dataItem\n                            });\n\n                            dataItems.splice(j, 1);\n                            selectedIndices.splice(j, 1);\n                            indices.splice(i, 1);\n                            values.splice(j, 1);\n\n                            removedIndices += 1;\n                            i -= 1;\n                            j -= 1;\n                            break;\n                        }\n                    }\n                }\n            }\n\n            return {\n                indices: indices,\n                removed: removed\n            };\n        },\n\n        _deselectFiltered: function(indices) {\n            var children = this.element[0].children;\n            var dataItem, index, position;\n            var removed = [];\n            var idx = 0;\n\n            for (; idx < indices.length; idx++) {\n                index = indices[idx];\n\n                dataItem = this._view[index].item;\n                position = this._dataItemPosition(dataItem, this._values);\n\n                if (position > -1) {\n                    removed.push(this.removeAt(position));\n                    $(children[index]).removeClass(KSELECTED);\n                }\n            }\n\n            if (removed.length) {\n                this.trigger(CHANGE, {\n                    added: [],\n                    removed: removed\n                });\n\n                return true;\n            }\n\n            return false;\n        },\n\n        _select: function(indices) {\n            var that = this;\n            var children = that.element[0].children;\n            var data = that._view;\n            var dataItem, index;\n            var added = [];\n            var idx = 0;\n\n            if (last(indices) !== -1) {\n                that.focus(indices);\n            }\n\n            for (; idx < indices.length; idx++) {\n                index = indices[idx];\n                dataItem = data[index];\n\n                if (index === -1 || !dataItem) {\n                    continue;\n                }\n\n                dataItem = dataItem.item;\n\n                that._selectedIndices.push(index);\n                that._dataItems.push(dataItem);\n                that._values.push(that._valueGetter(dataItem));\n\n                $(children[index]).addClass(KSELECTED).attr(ARIA_SELECTED, true);\n\n                added.push({\n                    dataItem: dataItem\n                });\n            }\n\n            return added;\n        },\n\n        getElementIndex: function(element) {\n            return $(element).data(\"offset-index\");\n        },\n\n        _get: function(candidate) {\n            if (typeof candidate === \"number\") {\n                candidate = [candidate];\n            } else if (!isArray(candidate)) {\n                candidate = this.getElementIndex(candidate);\n                candidate = [candidate !== undefined ? candidate : -1];\n            }\n\n            return candidate;\n        },\n\n        _template: function() {\n            var that = this;\n            var options = that.options;\n            var template = options.template;\n\n            if (!template) {\n                template = kendo.template('<li tabindex=\"-1\" role=\"option\" unselectable=\"on\" class=\"k-list-item\"><span class=\"k-list-item-text\">${' + kendo.expr(options.dataTextField, \"data\") + \"}</span></li>\", { useWithBlock: false });\n            } else {\n                template = kendo.template(template);\n                template = function(data) {\n                    return '<li tabindex=\"-1\" role=\"option\" unselectable=\"on\" class=\"k-list-item\">' + template(data) + \"</li>\";\n                };\n            }\n\n            return template;\n        },\n\n        _templates: function() {\n            var template;\n            var options = this.options;\n            var templates = {\n                template: options.template,\n                groupTemplate: options.groupTemplate,\n                fixedGroupTemplate: options.fixedGroupTemplate\n            };\n\n            if (options.columns) {\n                for (var i = 0; i < options.columns.length; i++) {\n                    var currentColumn = options.columns[i];\n                    var templateText = currentColumn.field ? currentColumn.field.toString() : TEXT;\n\n                    templates[\"column\" + i] = currentColumn.template || \"#: \" + templateText + \"#\";\n                }\n            }\n\n            for (var key in templates) {\n                template = templates[key];\n                if (template && typeof template !== \"function\") {\n                    templates[key] = kendo.template(template);\n                }\n            }\n\n            this.templates = templates;\n        },\n\n        _normalizeIndices: function(indices) {\n            var newIndices = [];\n            var idx = 0;\n\n            for (; idx < indices.length; idx++) {\n                if (indices[idx] !== undefined) {\n                    newIndices.push(indices[idx]);\n                }\n            }\n\n            return newIndices;\n        },\n\n        _valueIndices: function(values, indices) {\n            var data = this._view;\n            var idx = 0;\n            var index;\n\n            indices = indices ? indices.slice() : [];\n\n            if (!values.length) {\n                return [];\n            }\n\n            for (; idx < data.length; idx++) {\n                index = this._dataItemPosition(data[idx].item, values);\n\n                if (index !== -1) {\n                    indices[index] = idx;\n                }\n            }\n\n            return this._normalizeIndices(indices);\n        },\n\n        _firstVisibleItem: function() {\n            var element = this.element[0];\n            var content = this.content[0];\n            var scrollTop = content.scrollTop;\n            var itemHeight = $(element.children[0]).height();\n            var itemIndex = Math.floor(scrollTop / itemHeight) || 0;\n            var item = element.children[itemIndex] || element.lastChild;\n            var forward = item.offsetTop < scrollTop;\n\n            while (item) {\n                if (forward) {\n                    if ((item.offsetTop + itemHeight) > scrollTop || !item.nextSibling) {\n                        break;\n                    }\n\n                    item = item.nextSibling;\n                } else {\n                    if (item.offsetTop <= scrollTop || !item.previousSibling) {\n                        break;\n                    }\n\n                    item = item.previousSibling;\n                }\n            }\n\n            return this._view[$(item).data(\"offset-index\")];\n        },\n\n        _fixedHeader: function() {\n            if (this.isGrouped() && this.templates.fixedGroupTemplate) {\n                if (this.header.closest(GROUP_ROW_SEL).length) {\n                    this.header.closest(GROUP_ROW_SEL).show();\n                } else {\n                    this.header.show();\n                }\n\n                this.content.scroll(this._onScroll);\n            } else {\n                if (this.header.closest(GROUP_ROW_SEL).length) {\n                    this.header.closest(GROUP_ROW_SEL).hide();\n                } else {\n                    this.header.hide();\n                }\n\n                this.content.off(\"scroll\", this._onScroll);\n            }\n        },\n\n        _renderHeader: function() {\n            var template = this.templates.fixedGroupTemplate;\n            if (!template) {\n                return;\n            }\n\n            var visibleItem = this._firstVisibleItem();\n\n            if (visibleItem && visibleItem.group.toString().length) {\n                this.header.html(template(visibleItem.group));\n            }\n        },\n\n        _renderItem: function(context) {\n            var item = '<li tabindex=\"-1\" role=\"option\" unselectable=\"on\" ';\n\n            var dataItem = context.item;\n            var notFirstItem = context.index !== 0;\n            var selected = context.selected;\n            var isGrouped = this.isGrouped();\n            var hasColumns = this.options.columns && this.options.columns.length;\n            var altRow = context.index % 2 === 1 ? \" k-table-alt-row\" : \"\";\n\n            if (hasColumns) {\n                item += ('class=\"k-table-row' + altRow);\n            } else {\n                item += 'class=\"k-list-item';\n            }\n\n            if (notFirstItem && context.newGroup) {\n                item += ' k-first';\n            }\n\n            if (context.isLastGroupedItem && hasColumns) {\n                item += ' k-last';\n            }\n\n            if (selected) {\n                item += ' k-selected';\n            }\n\n            item += '\" aria-selected=\"' + (selected ? \"true\" : \"false\") + '\" data-offset-index=\"' + context.index + '\">';\n            if (hasColumns) {\n                item += this._renderColumns(dataItem);\n            } else {\n                item += '<span class=\"k-list-item-text\">';\n                item += this.templates.template(dataItem);\n                item += '</span>';\n            }\n\n            if (notFirstItem && context.newGroup) {\n                if (hasColumns) {\n                    item += '<span class=\"k-table-td k-table-group-td\"><span>' + this.templates.groupTemplate(context.group) + '</span></span>';\n                } else {\n                    item += '<div class=\"k-list-item-group-label\">' + this.templates.groupTemplate(context.group) + '</div>';\n                }\n            } else if (isGrouped && hasColumns) {\n                item += '<span class=\"k-table-td k-table-spacer-td\"></span>';\n            }\n\n            return item + \"</li>\";\n        },\n\n        _renderColumns: function(dataItem) {\n            var item = \"\";\n\n            for (var i = 0; i < this.options.columns.length; i++) {\n                var currentWidth = this.options.columns[i].width;\n                var currentWidthInt = parseInt(currentWidth, 10);\n                var widthStyle = '';\n\n                if (currentWidth && !isNaN(currentWidthInt)) {\n                    widthStyle += \"style='width:\";\n                    widthStyle += currentWidthInt;\n                    widthStyle += percentageUnitsRegex.test(currentWidth) ? \"%\" : \"px\";\n                    widthStyle += \";'\";\n                }\n                item += \"<span class='k-table-td' \" + widthStyle + \">\";\n                item += this.templates[\"column\" + i](dataItem);\n                item += \"</span>\";\n            }\n\n            return item;\n        },\n\n        _render: function() {\n            var html = \"\";\n\n            var i = 0;\n            var idx = 0;\n            var context;\n            var dataContext = [];\n            var view = this.dataSource.view();\n            var values = this.value();\n\n            var group, newGroup, j;\n            var isGrouped = this.isGrouped();\n\n            if (isGrouped) {\n                for (i = 0; i < view.length; i++) {\n                    group = view[i];\n                    newGroup = true;\n\n                    for (j = 0; j < group.items.length; j++) {\n                        context = {\n                            selected: this._selected(group.items[j], values),\n                            item: group.items[j],\n                            group: group.value,\n                            newGroup: newGroup,\n                            isLastGroupedItem: j === group.items.length - 1,\n                            index: idx };\n                        dataContext[idx] = context;\n                        idx += 1;\n\n                        html += this._renderItem(context);\n                        newGroup = false;\n                    }\n                }\n            } else {\n                for (i = 0; i < view.length; i++) {\n                    context = { selected: this._selected(view[i], values), item: view[i], index: i };\n\n                    dataContext[i] = context;\n\n                    html += this._renderItem(context);\n                }\n            }\n\n            this._view = dataContext;\n\n            this.element[0].innerHTML = html;\n\n            if (isGrouped && dataContext.length) {\n                this._renderHeader();\n            }\n        },\n\n        _selected: function(dataItem, values) {\n            var select = !this.isFiltered() || this.options.selectable === \"multiple\";\n            return select && this._dataItemPosition(dataItem, values) !== -1;\n        },\n\n        setDSFilter: function(filter) {\n            this._lastDSFilter = extend({}, filter);\n        },\n\n        isFiltered: function() {\n            if (!this._lastDSFilter) {\n                this.setDSFilter(this.dataSource.filter());\n            }\n\n            return !kendo.data.Query.compareFilters(this.dataSource.filter(), this._lastDSFilter);\n        },\n\n        refresh: function(e) {\n            var that = this;\n            var action = e && e.action;\n            var skipUpdateOnBind = that.options.skipUpdateOnBind;\n            var isItemChange = action === \"itemchange\";\n            var result;\n\n            that.trigger(DATA_BINDING);\n            that._angularItems(\"cleanup\");\n\n            that._fixedHeader();\n\n            that._render();\n\n            that.bound(true);\n\n            if (isItemChange || action === \"remove\") {\n                result = mapChangedItems(that._dataItems, e.items);\n\n                if (result.changed.length) {\n                    if (isItemChange) {\n                        that.trigger(SELECTED_ITEM_CHANGE, {\n                            items: result.changed\n                        });\n                    } else {\n                        that.value(that._getValues(result.unchanged));\n                    }\n                }\n            } else if (that.isFiltered() || that._skipUpdate || that._emptySearch) {\n                that.focus(0);\n                if (that._skipUpdate) {\n                    that._skipUpdate = false;\n                    that._selectedIndices = that._valueIndices(that._values, that._selectedIndices);\n                }\n            } else if (!skipUpdateOnBind && (!action || action === \"add\")) {\n                that.value(that._values);\n            }\n\n            if (that._valueDeferred) {\n                that._valueDeferred.resolve();\n            }\n\n            that._angularItems(\"compile\");\n            that.trigger(DATA_BOUND);\n        },\n\n        bound: function(bound) {\n            if (bound === undefined) {\n                return this._bound;\n            }\n\n            this._bound = bound;\n        },\n\n        isGrouped: function() {\n            return (this.dataSource.group() || []).length;\n        }\n    });\n\n    ui.plugin(StaticList);\n\n    function last(list) {\n        return list[list.length - 1];\n    }\n\n    function getSelectedOption(select) {\n        var index = select.selectedIndex;\n        return index > -1 ? select.options[index] : {};\n    }\n\n    function mapChangedItems(selected, itemsToMatch) {\n        var itemsLength = itemsToMatch.length;\n        var selectedLength = selected.length;\n        var dataItem;\n        var found;\n        var i, j;\n\n        var changed = [];\n        var unchanged = [];\n\n        if (selectedLength) {\n            for (i = 0; i < selectedLength; i++) {\n                dataItem = selected[i];\n                found = false;\n\n                for (j = 0; j < itemsLength; j++) {\n                    if (dataItem === itemsToMatch[j]) {\n                        found = true;\n                        changed.push({ index: i, item: dataItem });\n                        break;\n                    }\n                }\n\n                if (!found) {\n                    unchanged.push(dataItem);\n                }\n            }\n        }\n\n        return {\n            changed: changed,\n            unchanged: unchanged\n        };\n    }\n\n    function isValidFilterExpr(expression) {\n        if (!expression || $.isEmptyObject(expression)) {\n            return false;\n        }\n\n        if (expression.filters && !expression.filters.length) {\n            return false;\n        }\n\n        return true;\n    }\n\n    function removeFiltersForField(expression, field) {\n        var filters;\n        var found = false;\n\n        if (expression.filters) {\n            filters = $.grep(expression.filters, function(filter) {\n                found = removeFiltersForField(filter, field);\n                if (filter.filters) {\n                    return filter.filters.length;\n                } else {\n                    return filter.field != field;\n                }\n            });\n\n            if (!found && expression.filters.length !== filters.length) {\n                found = true;\n            }\n\n            expression.filters = filters;\n        }\n\n        return found;\n    }\n\n    kendo.cssProperties.registerPrefix(\"List\", \"k-list-\");\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","depends","hidden","$","window","kendo","jQuery","undefined","ui","outerHeight","_outerHeight","percentageUnitsRegex","Widget","keys","support","htmlEncode","activeElement","_activeElement","outerWidth","_outerWidth","ObservableArray","data","ID","CHANGE","FOCUSED","HOVER","KSELECTED","LOADING","LIST","TABLE","DATA_TABLE","TABLE_MD","LIST_UL","TABLE_LIST","FIXED_GROUP_HEADER","GROUP_LABEL","ITEMSELECTOR","OPEN","CLOSE","CASCADE","SELECT","CLICK","MOUSELEAVE","MOUSEENTER","ACTIVATE","DEACTIVATE","DATA_BINDING","DATA_BOUND","SELECTED_ITEM_CHANGE","SELECTED","REQUESTSTART","REQUESTEND","BLUR","FOCUS","FOCUSOUT","extend","isArray","Array","browser","HIDDENCLASS","WIDTH","TEXT","VALUE","isIE","msie","quotRegExp","alternativeNames","ComboBox","DropDownList","MultiColumnComboBox","UL_EL","LIST_EL","NO_DATA_EL","LIST_FOOTER_EL","TABLE_FOOTER_EL","MOUSEDOWN","LIST_SUFFIX","LISTBOX_SUFFIX","ARIA_LABELLEDBY","ARIA_LABEL","ARIA_ACTIVEDESCENDANT","ARIA_AUTOCOMPLETE","ARIA_CONTROLS","ARIA_LIVE","ARIA_EXPANDED","ARIA_HIDDEN","ARIA_BUSY","ARIA_MULTISELECTABLE","ARIA_SELECTED","GROUP_ROW_SEL","List","DataBoundWidget","init","element","options","that","this","fn","call","_isSelect","is","length","dataSource","dataTextField","dataValueField","_listSize","cssProperties","getValidClass","widget","propName","value","size","ul","attr","tabIndex","aria-hidden","list","addClass","append","guid","columns","removeClass","_columnsHeader","_header","_noData","_footer","_accessors","_initValue","valuePrimitive","footerTemplate","headerTemplate","noDataTemplate","messages","noData","clear","setOptions","enable","enabled","_renderFooter","_renderNoData","focus","_focused","trigger","readonly","_editable","disable","header","template","_angularElement","destroy","remove","parent","before","columnsHeader","colGroup","row","idx","currentColumn","title","field","columnsHeaderTemplate","currentWidth","width","currentWidthInt","parseInt","widthStyle","isNaN","test","prepend","angular","elements","appendTo","footer","footerEl","_listOptions","currentOptions","virtual","changeEventOption","change","_listChange","bind","listBoundHandler","_listBound","focusedElm","inputId","labelElm","labelledBy","_generateLabelId","autoBind","selectable","click","_click","activate","_activateItem","deactivate","_deactivateItem","dataBinding","dataBound","height","groupTemplate","fixedGroupTemplate","ariaLabel","ariaLabelledBy","listSize","expr","$angular","_initList","listOptions","selectedItemChange","listView","StaticList","VirtualList","_setListValue","done","_updateSelectionState","noop","_listMousedown","e","filterInput","target","preventDefault","_isFilterEnabled","filter","_hideClear","_clear","_showClear","_clearValue","_clearText","_accessor","_customOption","enforceMinLength","_filter","word","open","highlightFirst","_change","text","_clearFilter","bound","_filterSource","force","isMultiColumnFiltering","filterFields","logic","filters","expression","resetPageSettings","removed","removeFiltersForField","_clearFilterExpressions","Deferred","reject","promise","newExpression","push","_pushFilterExpression","isValidFilterExpr","concat","_cascading","setDSFilter","dataSourceState","page","pageSize","sort","group","aggregate","_mergeState","filtersToRemove","i","splice","action","html","instance","_toggleNoData","show","toggle","_toggleHeader","groupHeader","content","prev","children","first","_allowOpening","flatView","val","_old","_ignoreCase","model","reader","fields","type","ignoreCase","_focus","candidate","widgetOptions","fromFilter","_buildExpression","_open","accentFoldingFiltering","toLocaleLowerCase","toLowerCase","operator","_clearButton","clearTitle","role","clearButton","search","_inputValue","clearTimeout","_typingTimeout","minLength","_state","_emptySearch","trim","_searchByWord","current","items","ns","_unbindDataSource","off","popup","_form","_resetHandler","dataItem","index","selectedDataItems","getByUid","visible","add","removeAttr","getter","textField","valueField","_text","_value","_aria","autocomplete","suggest","aria-owns","aria-controls","_ariaLabel","_blur","close","_userTriggered","_isValueChanged","unifyType","selectedIndex","optionValue","_valueBeforeCascade","_oldIndex","isFiltered","_typing","typing","_data","view","_enable","disabled","_dataValue","_offsetHeight","offsetHeight","siblings","prevAll","each","_height","isMccb","offsetTop","popups","closest","hide","scrollHeight","_openHandler","_adjustListWidth","style","wrapper","computedStyle","computedWidth","getComputedStyle","parseFloat","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","css","fontFamily","autoWidth","minWidth","whiteSpace","_closeHandler","_focusItem","noFocusedItem","last","select","scrollToIndex","_calculateGroupPadding","li","padding","direction","display","scrollbar","parents","_calculatePopupHeight","_calculateColumnsHeaderPadding","isRtl","_refreshScroll","enableYScroll","overflowX","overflowY","_resizePopup","one","_popup","wrap","Popup","anchor","animation","autosize","on","_toggleHover","currentTarget","toggleClass","_toggle","preventFocus","touchEnabled","mobileOS","touch","MSPointers","pointers","_prevent","_triggerCascade","_cascadeTriggered","_cascadedValue","userTriggered","_triggerChange","unbind","_requestStartHandler","_requestEndHandler","_errorHandler","requireValueMapper","hasValue","valueMapper","Error","toString","Boolean","Number","inArray","node","parentNode","Select","_initial","setDataSource","_dataSource","_initialIndex","_current","fetch","_parentWidget","_cascadeSelect","_select","_cascadeValue","_accessorInput","_accessorSelect","getSelectedOption","selected","_custom","_syncValueAndText","custom","_hideBusy","_busy","_arrowIcon","_showBusy","isDefaultPrevented","_request","setTimeout","_requestEnd","DataSource","create","_firstItem","focusFirst","_lastItem","focusLast","_nextItem","focusNext","_prevItem","focusPrev","_getNormalizedDataItem","isIndex","hasOptionLabel","optionLabel","getElementIndex","dataItemByIndex","_getNormalizedSelectCandidate","normalizedCandidate","_move","key","keyCode","down","DOWN","isVirtual","pressed","moveIndex","selectCandidate","UP","altKey","firstChild","_fetch","hasClass","total","_get","item","ENTER","TAB","activeFilter","selection","shouldTrigger","input","_focusElement","focusout","ESC","PAGEDOWN","PAGEUP","scrollWith","screenHeight","_fetchData","hasItems","cascadeFrom","_options","htmlElement","option","dataText","dataValue","indexOf","replace","setAttribute","_reset","formId","form","parentElement","_cascade","cascade","_cascadeHandlerProxy","_cascadeHandler","_cascadeFilterRequests","_selectedValue","_toggleCascadeOnFocus","valueBeforeCascade","_clearSelection","_cascadeChange","filterValue","cascadeFromParentField","cascadeFromField","expressions","handler","currentHandler","shift","STATIC_LIST_NS","_touchHandlers","thead","find","_optionID","_selectedIndices","_view","_dataItems","_values","slice","_getter","_templates","_createOnScrollProxy","events","source","_refreshHandler","refresh","_fixedHeader","startY","endY","tapPosition","event","originalEvent","changedTouches","pageY","Math","abs","_touchTriggered","_triggerClick","get","skip","_render","_scrollId","clientHeight","scroll","scrollTop","itemOffsetTop","itemOffsetHeight","contentScrollTop","contentOffsetHeight","bottomDistance","dataItems","_getValues","_valueGetter","map","next","hasCandidate","focusIndex","skipUpdate","_skipUpdate","indices","singleSelection","selectedIndices","uiSelectedIndices","added","result","deferred","resolve","filtered","_deselectFiltered","_deselect","_valueComparer","removeAt","position","setValue","_valueDeferred","state","_valueIndices","onScrollProxy","_renderHeader","_onScroll","_valueExpr","values","body","comparer","normalized","_valueType","Function","_dataItemPosition","valueExpr","j","removedIndices","_template","useWithBlock","templates","templateText","_normalizeIndices","newIndices","_firstVisibleItem","itemHeight","itemIndex","floor","lastChild","forward","nextSibling","previousSibling","isGrouped","visibleItem","_renderItem","context","notFirstItem","hasColumns","altRow","newGroup","isLastGroupedItem","_renderColumns","dataContext","_selected","innerHTML","_lastDSFilter","Query","compareFilters","skipUpdateOnBind","isItemChange","_angularItems","mapChangedItems","changed","unchanged","_bound","itemsToMatch","itemsLength","selectedLength","found","isEmptyObject","grep","plugin","registerPrefix","amd","a1","a2","a3"],"mappings":"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"}