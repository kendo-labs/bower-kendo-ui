{"version":3,"file":"kendo.selectable.min.js","sources":["kendo.selectable.js"],"sourcesContent":["(function(f, define){\n    define('kendo.selectable',[ \"kendo.core\", \"kendo.userevents\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"selectable\",\n    name: \"Selectable\",\n    category: \"framework\",\n    depends: [ \"core\", \"userevents\" ],\n    advanced: true\n};\n\n(function ($, undefined) {\n    var kendo = window.kendo,\n        Widget = kendo.ui.Widget,\n        abs = Math.abs,\n        ARIASELECTED = \"aria-selected\",\n        SELECTED = \"k-state-selected\",\n        ACTIVE = \"k-state-selecting\",\n        SELECTABLE = \"k-selectable\",\n        CHANGE = \"change\",\n        NS = \".kendoSelectable\",\n        UNSELECT = \"unselect\",\n        UNSELECTING = \"k-state-unselecting\",\n        INPUTSELECTOR = \"input,a,textarea,.k-multiselect-wrap,select,button,.k-button>span,.k-button>img,span.k-icon.k-i-arrow-60-down,span.k-icon.k-i-arrow-60-up,label.k-checkbox-label.k-no-text,.k-icon.k-i-collapse,.k-icon.k-i-expand,span.k-numeric-wrap,.k-focusable\",\n        msie = kendo.support.browser.msie,\n        supportEventDelegation = false,\n        extend = $.extend;\n\n        (function($) {\n            (function() {\n                $('<div class=\"parent\"><span></span></div>')\n                .on(\"click\", \">*\", function() {\n                    supportEventDelegation = true;\n                })\n                .find(\"span\")\n                .trigger(\"click\")\n                .end()\n                .off();\n            })();\n        })($);\n\n    var Selectable = Widget.extend({\n        init: function(element, options) {\n            var that = this,\n                multiple,\n                dragToSelect;\n\n            Widget.fn.init.call(that, element, options);\n\n            that._marquee = $(\"<div class='k-marquee'><div class='k-marquee-color'></div></div>\");\n            that._lastActive = null;\n            that.element.addClass(SELECTABLE);\n\n            that.relatedTarget = that.options.relatedTarget;\n\n            multiple = that.options.multiple;\n            dragToSelect = that.options.dragToSelect;\n\n            that.userEvents = new kendo.UserEvents(that.element, {\n                global: true,\n                allowSelection: true,\n                filter: (!supportEventDelegation ? \".\" + SELECTABLE + \" \" : \"\") + that.options.filter,\n                tap: that._tap.bind(that),\n                touchAction: multiple ? \"none\" : \"pan-x pan-y\"\n            });\n\n            if (multiple) {\n                if(dragToSelect) {\n                    that.userEvents\n                        .bind(\"start\", that._start.bind(that))\n                        .bind(\"move\", that._move.bind(that))\n                        .bind(\"end\", that._end.bind(that));\n                }\n                that.userEvents\n                   .bind(\"select\", that._select.bind(that));\n            }\n        },\n\n        events: [CHANGE, UNSELECT],\n\n        options: {\n            name: \"Selectable\",\n            filter: \">*\",\n            inputSelectors: INPUTSELECTOR,\n            multiple: false,\n            dragToSelect: true,\n            relatedTarget: $.noop,\n            ignoreOverlapped: false,\n            addIdToRanges: false\n        },\n\n        _isElement: function(target) {\n            var elements = this.element;\n            var idx, length = elements.length, result = false;\n\n            target = target[0];\n\n            for (idx = 0; idx < length; idx ++) {\n                if (elements[idx] === target) {\n                    result = true;\n                    break;\n                }\n            }\n\n            return result;\n        },\n\n        _tap: function(e) {\n            var target = $(e.target),\n                that = this,\n                ctrlKey = e.event.ctrlKey || e.event.metaKey,\n                multiple = that.options.multiple,\n                shiftKey = multiple && e.event.shiftKey,\n                selectedClass = that.options.selectedClass || SELECTED,\n                selected,\n                whichCode = e.event.which,\n                buttonCode = e.event.button;\n\n            //in case of hierarchy or right-click\n            if (!that._isElement(target.closest(\".\" + SELECTABLE)) || whichCode && whichCode == 3 || buttonCode && buttonCode == 2) {\n                return;\n            }\n\n            if (!this._allowSelection(e.event.target)) {\n                return;\n            }\n\n            selected = target.hasClass(selectedClass);\n            if (!multiple || !ctrlKey) {\n                that.clear();\n            }\n\n            target = target.add(that.relatedTarget(target));\n\n            if (shiftKey) {\n                that.selectRange(that._firstSelectee(), target, e);\n            } else {\n                if (selected && ctrlKey) {\n                    that._unselect(target);\n                    that._notify(CHANGE, e);\n                } else {\n                    that.value(target, e);\n                }\n\n                that._lastActive = that._downTarget = target;\n            }\n        },\n\n        _start: function(e) {\n            var that = this,\n                target = $(e.target),\n                selectedClass = that.options.selectedClass || SELECTED,\n                selected = target.hasClass(selectedClass),\n                currentElement,\n                ctrlKey = e.event.ctrlKey || e.event.metaKey;\n\n            if (!this._allowSelection(e.event.target)) {\n                return;\n            }\n\n            that._downTarget = target;\n\n            //in case of hierarchy\n            if (!that._isElement(target.closest(\".\" + SELECTABLE))) {\n                that.userEvents.cancel();\n                return;\n            }\n\n            if (that.options.useAllItems) {\n                that._items = that.element.find(that.options.filter);\n            } else {\n                currentElement = target.closest(that.element);\n                that._items = currentElement.find(that.options.filter);\n            }\n\n            e.sender.capture();\n\n            that._marquee\n                .appendTo(document.body)\n                .css({\n                    left: e.x.client + 1,\n                    top: e.y.client + 1,\n                    width: 0,\n                    height: 0\n                });\n\n            if (!ctrlKey) {\n                that.clear();\n            }\n\n            target = target.add(that.relatedTarget(target));\n            if (selected) {\n                that._selectElement(target, true);\n                if (ctrlKey) {\n                    target.addClass(UNSELECTING);\n                }\n            }\n        },\n\n        _move: function(e) {\n            var that = this,\n                position = {\n                    left: e.x.startLocation > e.x.location ? e.x.location : e.x.startLocation,\n                    top: e.y.startLocation > e.y.location ? e.y.location : e.y.startLocation,\n                    width: abs(e.x.initialDelta),\n                    height: abs(e.y.initialDelta)\n                };\n\n            that._marquee.css(position);\n\n            that._invalidateSelectables(position, (e.event.ctrlKey || e.event.metaKey));\n\n            e.preventDefault();\n        },\n\n        _end: function(e) {\n            var that = this,\n            rangeSelectedAttr = kendo.attr(\"range-selected\"),\n            uid = kendo.guid();\n\n            that._marquee.remove();\n\n            that._unselect(that.element\n                .find(that.options.filter + \".\" + UNSELECTING))\n                .removeClass(UNSELECTING);\n\n\n            var target = that.element.find(that.options.filter + \".\" + ACTIVE);\n            target = target.add(that.relatedTarget(target));\n\n            if (that.options.addIdToRanges) {\n                for (var i = 0; i < that._currentlyActive.length; i++) {\n                    $(that._currentlyActive[i]).attr(rangeSelectedAttr, uid);\n                }\n            }\n\n            that.value(target, e);\n            that._lastActive = that._downTarget;\n            that._items = null;\n        },\n\n        _invalidateSelectables: function(position, ctrlKey) {\n            var idx,\n                length,\n                target = this._downTarget[0],\n                items = this._items,\n                selectedClass = this.options.selectedClass || SELECTED,\n                related,\n                toSelect;\n\n            this._currentlyActive = [];\n\n            for (idx = 0, length = items.length; idx < length; idx ++) {\n                toSelect = items.eq(idx);\n                related = toSelect.add(this.relatedTarget(toSelect));\n\n                if (collision(toSelect, position)) {\n                    if(toSelect.hasClass(selectedClass)) {\n                        if(ctrlKey && target !== toSelect[0]) {\n                            related.removeClass(selectedClass).addClass(UNSELECTING);\n                        }\n                    } else if (!toSelect.hasClass(ACTIVE) && !toSelect.hasClass(UNSELECTING) && !this._collidesWithActiveElement(related, position)) {\n                        related.addClass(ACTIVE);\n                    }\n                    this._currentlyActive.push(related[0]);\n                } else {\n                    if (toSelect.hasClass(ACTIVE)) {\n                        related.removeClass(ACTIVE);\n                    } else if(ctrlKey && toSelect.hasClass(UNSELECTING)) {\n                        related.removeClass(UNSELECTING).addClass(selectedClass);\n                    }\n                }\n            }\n        },\n\n        _collidesWithActiveElement: function (element, marqueeRect) {\n            if (!this.options.ignoreOverlapped) {\n                return false;\n            }\n\n            var activeElements = this._currentlyActive;\n            var elemRect = element[0].getBoundingClientRect();\n            var activeElementRect;\n            var collision = false;\n            var isRtl = kendo.support.isRtl(element);\n            var leftRight = isRtl ? \"right\" : \"left\";\n            var tempRect = {};\n\n            marqueeRect.right = marqueeRect.left + marqueeRect.width;\n            marqueeRect.bottom = marqueeRect.top + marqueeRect.height;\n\n            for (var i = 0; i < activeElements.length; i++) {\n                activeElementRect = activeElements[i].getBoundingClientRect();\n                if (overlaps(elemRect, activeElementRect)) {\n                    tempRect[leftRight] = leftRight === \"left\" ? activeElementRect.right : activeElementRect.left;\n                    elemRect = extend({}, elemRect, tempRect);\n                    if (elemRect.left > elemRect.right) {\n                        return true;\n                    }\n                    collision = !overlaps(elemRect, marqueeRect);\n                }\n            }\n            return collision;\n        },\n\n        value: function(val, e) {\n            var that = this,\n                selectElement = that._selectElement.bind(that);\n\n            if(val) {\n                val.each(function() {\n                    selectElement(this);\n                });\n\n                that._notify(CHANGE, e);\n                return;\n            }\n\n            return that.element.find(that.options.filter + \".\" + (that.options.selectedClass || SELECTED));\n        },\n\n        selectedRanges: function () {\n            var that = this;\n            var rangeSelectedAttr = kendo.attr(\"range-selected\");\n            var map = {};\n\n            that.element.find(\"[\" + rangeSelectedAttr + \"]\").each(function (_, elem) {\n                var rangeId = $(elem).attr(rangeSelectedAttr);\n                var mapLocation = map[rangeId];\n\n                if (!mapLocation) {\n                    mapLocation = map[rangeId] = [];\n                }\n\n                mapLocation.push($(elem));\n            });\n\n            return map;\n        },\n\n        selectedSingleItems: function () {\n            var that = this;\n            var rangeSelectedAttr = kendo.attr(\"range-selected\");\n\n            return that.element.find(that.options.filter + \".\" + (that.options.selectedClass || SELECTED) + \":not([\" + rangeSelectedAttr + \"])\").toArray().map(function (elem) {\n                return $(elem);\n            });\n        },\n\n        _firstSelectee: function() {\n            var that = this,\n                selected;\n\n            if(that._lastActive !== null) {\n                return that._lastActive;\n            }\n\n            selected = that.value();\n            return selected.length > 0 ?\n                    selected[0] :\n                    that.element.find(that.options.filter)[0];\n        },\n\n        _selectElement: function(element, preventNotify) {\n            var toSelect = $(element),\n                selectedClass = this.options.selectedClass || SELECTED,\n                isPrevented =  !preventNotify && this._notify(\"select\", { element: element });\n\n            toSelect.removeClass(ACTIVE);\n            if(!isPrevented) {\n                 toSelect.addClass(selectedClass);\n\n                if (this.options.aria) {\n                    toSelect.attr(ARIASELECTED, true);\n                }\n            }\n        },\n\n        _notify: function(name, args) {\n            args = args || { };\n            return this.trigger(name, args);\n        },\n\n        _unselect: function(element) {\n            if (this.trigger(UNSELECT, { element: element})) {\n                return;\n            }\n\n            var rangeSelectedAttr = kendo.attr(\"range-selected\");\n\n            element.removeClass(this.options.selectedClass || SELECTED).removeAttr(rangeSelectedAttr);\n\n            if (this.options.aria) {\n                element.attr(ARIASELECTED, false);\n            }\n\n            return element;\n        },\n\n        _select: function(e) {\n            if (this._allowSelection(e.event.target)) {\n                if (!msie || (msie && !$(kendo._activeElement()).is(this.options.inputSelectors))) {\n                    e.preventDefault();\n                }\n            }\n        },\n\n        _allowSelection: function(target) {\n            if ($(target).is(this.options.inputSelectors)) {\n                this.userEvents.cancel();\n                this._downTarget = null;\n                return false;\n            }\n\n            return true;\n        },\n\n        resetTouchEvents: function() {\n            this.userEvents.cancel();\n        },\n\n        clear: function() {\n            var items = this.element.find(this.options.filter + \".\" + (this.options.selectedClass || SELECTED));\n            this._unselect(items);\n        },\n\n        selectRange: function(start, end, e) {\n            var that = this,\n                idx,\n                tmp,\n                items;\n\n            that.clear();\n\n            if (that.element.length > 1) {\n                items = that.options.continuousItems();\n            }\n\n            if (!items || !items.length) {\n                items = that.element.find(that.options.filter);\n            }\n\n            start = $.inArray($(start)[0], items);\n            end = $.inArray($(end)[0], items);\n\n            if (start > end) {\n                tmp = start;\n                start = end;\n                end = tmp;\n            }\n\n            if (!that.options.useAllItems) {\n                end += that.element.length - 1;\n            }\n\n            for (idx = start; idx <= end; idx ++ ) {\n                that._selectElement(items[idx]);\n            }\n\n            that._notify(CHANGE, e);\n        },\n\n        destroy: function() {\n            var that = this;\n\n            Widget.fn.destroy.call(that);\n\n            that.element.off(NS);\n\n            that.userEvents.destroy();\n\n            that._marquee = that._lastActive = that.element = that.userEvents = null;\n        }\n    });\n\n    Selectable.parseOptions = function(selectable) {\n        var selectableMode = selectable.mode || selectable;\n        var asLowerString = typeof selectableMode === \"string\" && selectableMode.toLowerCase();\n        return {\n            multiple: asLowerString && asLowerString.indexOf(\"multiple\") > -1,\n            cell: asLowerString && asLowerString.indexOf(\"cell\") > -1\n        };\n    };\n\n    function collision(element, position) {\n        if (!element.is(\":visible\")) {\n            return false;\n        }\n\n        var elementPosition = kendo.getOffset(element),\n            right = position.left + position.width,\n            bottom = position.top + position.height;\n\n        elementPosition.right = elementPosition.left + kendo._outerWidth(element);\n        elementPosition.bottom = elementPosition.top + kendo._outerHeight(element);\n\n        return !(elementPosition.left > right||\n            elementPosition.right < position.left ||\n            elementPosition.top > bottom ||\n            elementPosition.bottom < position.top);\n    }\n\n    function overlaps(firstRect, secondRect) {\n        return !(firstRect.right <= secondRect.left ||\n            firstRect.left >= secondRect.right ||\n            firstRect.bottom <= secondRect.top ||\n            firstRect.top >= secondRect.bottom);\n    }\n\n    kendo.ui.plugin(Selectable);\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","depends","advanced","$","window","kendo","jQuery","undefined","Widget","ui","abs","Math","ARIASELECTED","SELECTED","ACTIVE","SELECTABLE","CHANGE","NS","UNSELECT","UNSELECTING","INPUTSELECTOR","msie","support","browser","supportEventDelegation","extend","Selectable","on","find","trigger","end","off","init","element","options","that","this","multiple","dragToSelect","fn","call","_marquee","_lastActive","addClass","relatedTarget","userEvents","UserEvents","global","allowSelection","filter","tap","_tap","bind","touchAction","_start","_move","_end","_select","events","inputSelectors","noop","ignoreOverlapped","addIdToRanges","_isElement","target","elements","idx","length","result","e","ctrlKey","event","metaKey","shiftKey","selectedClass","selected","whichCode","which","buttonCode","button","closest","_allowSelection","hasClass","clear","add","selectRange","_firstSelectee","_unselect","_notify","value","_downTarget","currentElement","cancel","useAllItems","_items","sender","capture","appendTo","document","body","css","left","x","client","top","y","width","height","_selectElement","position","startLocation","location","initialDelta","_invalidateSelectables","preventDefault","rangeSelectedAttr","attr","uid","guid","remove","removeClass","i","_currentlyActive","items","related","toSelect","eq","collision","_collidesWithActiveElement","push","marqueeRect","activeElements","elemRect","getBoundingClientRect","activeElementRect","isRtl","leftRight","tempRect","right","bottom","overlaps","val","selectElement","each","selectedRanges","map","_","elem","rangeId","mapLocation","selectedSingleItems","toArray","preventNotify","isPrevented","aria","args","removeAttr","_activeElement","is","resetTouchEvents","start","tmp","continuousItems","inArray","destroy","elementPosition","getOffset","_outerWidth","_outerHeight","firstRect","secondRect","parseOptions","selectable","selectableMode","mode","asLowerString","toLowerCase","indexOf","cell","plugin","amd","a1","a2","a3"],"mappings":"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"}