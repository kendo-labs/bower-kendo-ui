{"version":3,"file":"kendo.listbox.min.js","sources":["kendo.listbox.js"],"sourcesContent":["\n(function(f, define) {\n    define('kendo.listbox',[ \"kendo.draganddrop\", \"kendo.data\", \"kendo.selectable\" ], f);\n})(function() {\n\nvar __meta__ = {\n    id: \"listbox\",\n    name: \"ListBox\",\n    category: \"web\",\n    depends: [\"draganddrop\", \"data\", \"selectable\"]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo;\n    var kendoAttr = kendo.attr;\n    var data = kendo.data;\n    var keys = kendo.keys;\n    var kendoTemplate = kendo.template;\n    var Widget = kendo.ui.Widget;\n    var DataSource = data.DataSource;\n    var Selectable = kendo.ui.Selectable;\n    var DataBoundWidget = kendo.ui.DataBoundWidget;\n    var Class = kendo.Class;\n\n    var extend = $.extend;\n    var noop = $.noop;\n\n    var DASH = \"-\";\n    var DOT = \".\";\n    var SPACE = \" \";\n    var HASH = \"#\";\n\n    var KENDO_LISTBOX = \"kendoListBox\";\n    var NS = DOT + KENDO_LISTBOX;\n    var DISABLED_STATE_CLASS = \"k-disabled\";\n    var SELECTED_STATE_CLASS = \"k-selected\";\n    var ENABLED_ITEM_SELECTOR = \".k-list-item:not(.k-disabled)\";\n    var ENABLED_ITEMS_SELECTOR = \".k-list-ul:not(.k-disabled) >\" + ENABLED_ITEM_SELECTOR;\n    var TOOLBAR_CLASS = \"k-listbox-toolbar\";\n    var TOOL_SELECTOR = \"li > a.k-button:not(.k-disabled)\";\n    var FOCUSED_CLASS = \"k-focus\";\n    var DRAG_CLUE_CLASS = \"k-drag-clue\";\n    var DROP_HINT_CLASS = \"k-drop-hint\";\n    var LIST_CLASS = \"k-list-ul\";\n    var LIST_SELECTOR = \".k-list-ul\";\n\n    var CLICK = \"click\" + NS;\n    var KEYDOWN = \"keydown\" + NS;\n    var BLUR = \"blur\" + NS;\n    var outerWidth = kendo._outerWidth;\n    var outerHeight = kendo._outerHeight;\n    var CHANGE = \"change\";\n    var DATABOUND = \"dataBound\";\n    var ADD = \"add\";\n    var REMOVE = \"remove\";\n    var REORDER = \"reorder\";\n    var MOVE_UP = \"moveUp\";\n    var MOVE_DOWN = \"moveDown\";\n    var TRANSFER_TO = \"transferTo\";\n    var TRANSFER_FROM = \"transferFrom\";\n    var TRANSFER_ALL_TO = \"transferAllTo\";\n    var TRANSFER_ALL_FROM = \"transferAllFrom\";\n    var DRAGGEDCLASS = \"k-ghost\";\n    var UNIQUE_ID = \"uid\";\n    var ID = \"id\";\n    var TABINDEX = \"tabindex\";\n    var COMMAND = \"command\";\n\n    var MOVE_UP_OFFSET = -1;\n    var MOVE_DOWN_OFFSET = 1;\n    var DRAGSTART = \"dragstart\";\n    var DRAG = \"drag\";\n    var DROP = \"drop\";\n    var DRAGEND = \"dragend\";\n    var DEFAULT_FILTER = \"ul.k-list-ul>li.k-list-item\";\n\n    var RIGHT = \"right\";\n    var BOTTOM = \"bottom\";\n\n    var TOOLBAR_POSITION_CLASS_NAMES = [\n        TOOLBAR_CLASS + DASH + \"left\",\n        TOOLBAR_CLASS + DASH + RIGHT,\n        TOOLBAR_CLASS + DASH + \"top\",\n        TOOLBAR_CLASS + DASH + BOTTOM\n    ];\n\n    function getSortedDomIndices(items) {\n        var indices = $.map(items, function(item) {\n            return $(item).index();\n        });\n\n        return indices;\n    }\n\n    function isUndefined(value) {\n        return (typeof value === \"undefined\");\n    }\n\n    function defaultHint(element) {\n        return element.clone()\n            .attr('class', '')\n            .addClass(DRAG_CLUE_CLASS);\n    }\n\n    function defaultPlaceholder() {\n        return $('<li>').addClass(DROP_HINT_CLASS);\n    }\n\n    var ListBox = DataBoundWidget.extend({\n        init: function(element, options) {\n            var that = this;\n            Widget.fn.init.call(that, element, options);\n\n            that._wrapper();\n            that._list();\n            that._ariaLabel(that._getList());\n            element = that.element.attr(\"multiple\", \"multiple\").hide();\n\n            if (element[0] && !that.options.dataSource) {\n                that.options.dataTextField = that.options.dataTextField || \"text\";\n                that.options.dataValueField = that.options.dataValueField || \"value\";\n            }\n            that._templates();\n            that._selectable();\n            that._dataSource();\n            that._createToolbar();\n            that._createDraggable();\n            that._createNavigatable();\n        },\n\n        destroy: function() {\n            var that = this;\n\n            DataBoundWidget.fn.destroy.call(that);\n            if (!isNaN(that._listTabIndex)) {\n                that._getList().off();\n                that._listTabIndex = null;\n            }\n            that._unbindDataSource();\n            that._destroySelectable();\n            that._destroyToolbar();\n            that.wrapper.off(NS);\n            if (that._target) {\n                that._target = null;\n            }\n            if (that._draggable) {\n                that._draggable.destroy();\n                that.placeholder = null;\n            }\n\n            kendo.destroy(that.element);\n        },\n\n        setOptions: function(options) {\n            Widget.fn.setOptions.call(this, options);\n            this._templates();\n            this._dataSource();\n        },\n\n        events: [\n            CHANGE,\n            DATABOUND,\n            ADD,\n            REMOVE,\n            REORDER,\n            DRAGSTART,\n            DRAG,\n            DROP,\n            DRAGEND\n        ],\n\n        options: {\n            name: \"ListBox\",\n            autoBind: true,\n            template: \"\",\n            dataTextField: \"\",\n            dataValueField: \"\",\n            selectable: \"single\",\n            draggable: null,\n            dropSources: [],\n            connectWith: \"\",\n            navigatable: true,\n            toolbar: {\n                position: RIGHT,\n                tools: []\n            },\n            messages: {\n                tools: {\n                    remove: \"Delete\",\n                    moveUp: \"Move Up\",\n                    moveDown: \"Move Down\",\n                    transferTo: \"Transfer To\",\n                    transferFrom: \"Transfer From\",\n                    transferAllTo: \"Transfer All To\",\n                    transferAllFrom: \"Transfer All From\"\n                }\n            }\n        },\n\n        add: function(dataItems) {\n            var that = this;\n            var items = dataItems && dataItems.length ? dataItems : [dataItems];\n            var itemsLength = items.length;\n            var list = that._getList();\n            var i;\n\n            that._unbindDataSource();\n            that._unbindDataChange();\n            for (i = 0; i < itemsLength; i++) {\n                that._addItem(items[i], list);\n            }\n            that._bindDataChange();\n            that._bindDataSource();\n            that._syncElement();\n        },\n\n        _addItem: function(dataItem, list) {\n            var that = this;\n            var item = $(that.templates.itemTemplate({ item: dataItem, r: that.templates.itemContent }));\n\n            that._setItemId(item, dataItem.uid);\n\n            item.appendTo(list);\n\n            if (typeof dataItem === typeof \"\") {\n                that.dataSource._data.push(dataItem);\n            } else {\n                that.dataSource.add(dataItem);\n            }\n        },\n\n        _addItemAt: function(dataItem, index) {\n            var that = this;\n            var item = $(that.templates.itemTemplate({ item: dataItem, r: that.templates.itemContent }));\n            that._unbindDataSource();\n            if (typeof dataItem === typeof \"\") {\n                that._insertElementAt(item, index);\n                that.dataSource._data.push(dataItem);\n            } else {\n                that._setItemId(item, dataItem.uid);\n                that._insertElementAt(item, index);\n                that.dataSource.add(dataItem);\n            }\n            that._bindDataSource();\n            that._syncElement();\n        },\n\n        _insertElementAt: function(item, index) {\n            var that = this;\n            var list = that._getList();\n\n            if (index > 0) {\n                $(item).insertAfter(list.children().eq(index - 1));\n            } else {\n                $(list).prepend(item);\n            }\n        },\n\n        _createNavigatable: function() {\n            var that = this;\n            var options = that.options;\n\n            if (options.navigatable) {\n                that._getList().on(CLICK, ENABLED_ITEM_SELECTOR, that._click.bind(that))\n                            .on(KEYDOWN, that._keyDown.bind(that))\n                            .on(BLUR, that._blur.bind(that));\n            }\n        },\n\n        _getTabIndex: function() {\n            var that = this;\n            var tabindex;\n\n            if (!isNaN(that._listTabIndex))\n            {\n                return that._listTabIndex;\n            }\n\n            tabindex = that.element.attr(TABINDEX);\n            that._listTabIndex = !isNaN(tabindex) ? tabindex : 0;\n\n            that.element.removeAttr(TABINDEX);\n\n            return that._listTabIndex;\n        },\n\n        _blur: function() {\n            if (this._target) {\n                this._target.removeClass(FOCUSED_CLASS);\n                this._getList().removeAttr(\"aria-activedescendant\");\n            }\n            this._target = null;\n        },\n\n        _click: function(e) {\n            var that = this;\n            var target = $(e.currentTarget);\n            var oldTarget = that._target;\n            var activeEl = kendo._activeElement();\n            var isContained = $.contains(that.wrapper[0], activeEl);\n\n            if (oldTarget) {\n                oldTarget.removeClass(FOCUSED_CLASS);\n            }\n\n            that._target = target;\n            target.addClass(FOCUSED_CLASS);\n            that._getList().attr(\"aria-activedescendant\", target.attr(ID));\n\n            if (that._getList()[0] !== kendo._activeElement() && (!isContained || !isInputElement(activeEl))) {\n                that.focus();\n            }\n        },\n\n        _getNavigatableItem: function(key) {\n            var that = this;\n            var current;\n\n            if (!that._target) {\n                current = that.items().filter(ENABLED_ITEM_SELECTOR).first();\n            } else {\n                current = that._target;\n            }\n\n            if (key === keys.UP && that._target) {\n                current = that._target.prevAll(ENABLED_ITEM_SELECTOR).first();\n            }\n\n            if (key === keys.DOWN && that._target) {\n                current = that._target.nextAll(ENABLED_ITEM_SELECTOR).first();\n            }\n\n            return current.length ? current : null;\n        },\n\n        _scrollIntoView: function(item) {\n            if (!item) {\n                return;\n            }\n\n            if (item[0]) {\n                item = item[0];\n            }\n\n            var list = this._getList().parent()[0];\n            var itemOffsetTop = item.offsetTop;\n            var contentScrollTop = list.scrollTop;\n            var contentOffsetHeight = list.clientHeight;\n            var bottomDistance = itemOffsetTop + item.offsetHeight;\n\n            if (contentScrollTop > itemOffsetTop) {\n                contentScrollTop = itemOffsetTop;\n            } else if (bottomDistance > (contentScrollTop + contentOffsetHeight)) {\n                contentScrollTop = (bottomDistance - contentOffsetHeight);\n            }\n\n            list.scrollTop = contentScrollTop;\n        },\n\n        _keyDown: function(e) {\n            var that = this;\n            var key = e.keyCode;\n            var current = that._getNavigatableItem(key);\n            var shouldPreventDefault;\n\n            if (that._target) {\n                that._target.removeClass(FOCUSED_CLASS);\n            }\n\n            if (!(e.shiftKey && !e.ctrlKey && (key === keys.DOWN || key === keys.UP))) {\n                that._shiftSelecting = false;\n            }\n\n            if (key == keys.DELETE) {\n                that._executeCommand(REMOVE);\n                if (that._target) {\n                    that._target.removeClass(FOCUSED_CLASS);\n                    that._getList().removeAttr(\"aria-activedescendant\");\n                    that._target = null;\n                }\n                shouldPreventDefault = true;\n            } else if (key === keys.DOWN || key === keys.UP) {\n                if (!current) {\n                    e.preventDefault();\n                    return;\n                }\n                if (e.shiftKey && !e.ctrlKey) {\n                    if (!that._shiftSelecting) {\n                        that.clearSelection();\n                        that._shiftSelecting = true;\n                    }\n                    if (that._target && current.hasClass(\"k-selected\")) {\n                        that._target.removeClass(SELECTED_STATE_CLASS);\n                    } else if (that.options.selectable == \"single\") {\n                       that.select(current);\n                    } else {\n                       that.select(current.add(that._target));\n                    }\n                    that.trigger(CHANGE);\n                } else if (e.shiftKey && e.ctrlKey) {\n                    that._executeCommand(key === keys.DOWN ? MOVE_DOWN : MOVE_UP);\n                    that._scrollIntoView(that._target);\n                    e.preventDefault();\n                    return;\n                } else if (!e.shiftKey && !e.ctrlKey) {\n                    if (that.options.selectable === \"multiple\") {\n                        that.clearSelection();\n                    }\n                    that.select(current);\n                    that.trigger(CHANGE);\n                }\n\n                that._target = current;\n                if (that._target) {\n                    that._target.addClass(FOCUSED_CLASS);\n                    that._scrollIntoView(that._target);\n                    that._getList().attr(\"aria-activedescendant\", that._target.attr(ID));\n                } else {\n                    that._getList().removeAttr(\"aria-activedescendant\");\n                }\n                shouldPreventDefault = true;\n            } else if (key == keys.SPACEBAR) {\n                if (e.ctrlKey && that._target) {\n                   if (that._target.hasClass(SELECTED_STATE_CLASS)) {\n                       that._target.removeClass(SELECTED_STATE_CLASS);\n                   } else {\n                       that.select(that._target);\n                   }\n                    that.trigger(CHANGE);\n                } else {\n                   that.clearSelection();\n                   that.select(that._target);\n                   that.trigger(CHANGE);\n                }\n                shouldPreventDefault = true;\n            } else if (e.ctrlKey && key == keys.RIGHT) {\n                if (e.shiftKey) {\n                   that._executeCommand(TRANSFER_ALL_TO);\n                } else {\n                   that._executeCommand(TRANSFER_TO);\n                }\n                that._target = that.select().length ? that.select() : null;\n                shouldPreventDefault = true;\n            } else if (e.ctrlKey && key == keys.LEFT) {\n                if (e.shiftKey) {\n                   that._executeCommand(TRANSFER_ALL_FROM);\n                } else {\n                   that._executeCommand(TRANSFER_FROM);\n                }\n                shouldPreventDefault = true;\n            }\n\n            if (shouldPreventDefault) {\n                e.preventDefault();\n            }\n        },\n\n        focus: function() {\n            kendo.focusElement(this._getList());\n        },\n\n        _createDraggable: function() {\n            var that = this;\n            var draggable = that.options.draggable;\n            var hint;\n\n            if (draggable) {\n                hint = draggable.hint;\n                if (!that.options.selectable) {\n                    throw new Error(\"Dragging requires selection to be enabled\");\n                }\n\n                if (!hint) {\n                    hint = defaultHint;\n                }\n\n                that._draggable = new kendo.ui.Draggable(that.wrapper, {\n                    filter: draggable.filter ? draggable.filter : DEFAULT_FILTER,\n                    hint: kendo.isFunction(hint) ? hint : $(hint),\n                    dragstart: that._dragstart.bind(that),\n                    dragcancel: that._clear.bind(that),\n                    drag: that._drag.bind(that),\n                    dragend: that._dragend.bind(that)\n                });\n            }\n        },\n\n        _dragstart: function(e) {\n            var that = this;\n            var draggedElement = that.draggedElement = e.currentTarget;\n            var placeholder = that.options.draggable.placeholder;\n            var dataItem = that.dataItem(draggedElement);\n            var eventData = { dataItems: dataItem, items: $(draggedElement), draggableEvent: e };\n\n            if (that.options.draggable.enabled === false) {\n                e.preventDefault();\n                return;\n            }\n\n            if (!placeholder) {\n                placeholder = defaultPlaceholder;\n            }\n\n            that.placeholder = kendo.isFunction(placeholder) ? $(placeholder.call(that, draggedElement)) : $(placeholder);\n\n            if (draggedElement.is(DOT + DISABLED_STATE_CLASS)) {\n                e.preventDefault();\n            } else {\n                if (that.trigger(DRAGSTART, eventData)) {\n                    e.preventDefault();\n                } else {\n                    that.clearSelection();\n                    that.select(draggedElement);\n                    draggedElement.addClass(DRAGGEDCLASS);\n                }\n            }\n        },\n\n        _clear: function() {\n            this.draggedElement.removeClass(DRAGGEDCLASS);\n            this.placeholder.remove();\n        },\n\n        _findElementUnderCursor: function(e) {\n            var elementUnderCursor = kendo.elementUnderCursor(e);\n            var draggable = e.sender;\n\n            if ($.contains(draggable.hint[0], elementUnderCursor) || draggable.hint[0] === elementUnderCursor) {\n                draggable.hint.hide();\n                elementUnderCursor = kendo.elementUnderCursor(e);\n                draggable.hint.show();\n            }\n\n            return elementUnderCursor;\n        },\n\n        _findTarget: function(e) {\n            var that = this;\n            var element = that._findElementUnderCursor(e);\n            var elementNode = $(element);\n            var list = that._getList();\n            var items;\n            var node;\n\n            if ($.contains(list[0], element)) {\n                items = that.items();\n                element = elementNode.is(\"li\") ? element : elementNode.closest(\"li\")[0];\n                node = items.filter(element)[0] || items.has(element)[0];\n                if (node) {\n                    node = $(node);\n                    return !node.hasClass(DISABLED_STATE_CLASS) ? { element: node, listBox: that } : null;\n                } else {\n                    return null;\n                }\n            } else if (list[0] == element || list.parent()[0] == element) {\n                return { element: $(list), appendToBottom: true, listBox: that };\n            } else {\n                return that._searchConnectedListBox(elementNode);\n            }\n        },\n\n        _getElementCenter: function(element) {\n            var center = element.length ? kendo.getOffset(element) : null;\n            if (center) {\n                center.top += outerHeight(element) / 2;\n                center.left += outerWidth(element) / 2;\n            }\n\n            return center;\n        },\n\n        _searchConnectedListBox: function(element) {\n            var connectedListBox;\n            var items;\n            var node;\n            var originalElement = element;\n            var closestContainer;\n\n            if (element.hasClass(\"k-list-scroller k-selectable\")) {\n                closestContainer = element;\n            } else {\n                closestContainer = element.closest(\".k-list-scroller.k-selectable\");\n            }\n\n            if (closestContainer.length) {\n                connectedListBox = closestContainer.parent().find(\"[data-role='listbox']\").getKendoListBox();\n            } else {\n                return null;\n            }\n\n            if (connectedListBox && $.inArray(this.element[0].id, connectedListBox.options.dropSources) !== -1) {\n                items = connectedListBox.items();\n                element = element.is(\"li\") ? element[0] : element.closest(\"li\")[0];\n                node = items.filter(element)[0] || items.has(element)[0];\n                if (node) {\n                    node = $(node);\n                    return !node.hasClass(DISABLED_STATE_CLASS) ? { element: node, listBox: connectedListBox } : null;\n                } else if (!items.length ||\n                            originalElement.hasClass(\"k-list-scroller k-selectable\") ||\n                            originalElement.hasClass(\"k-list-content\")) {\n                    return { element: connectedListBox._getList(), listBox: connectedListBox, appendToBottom: true };\n                } else {\n                    return null;\n                }\n            }\n            return null;\n        },\n\n        _drag: function(e) {\n            var that = this;\n            var draggedElement = that.draggedElement;\n            var target = that._findTarget(e);\n            var cursorOffset = { left: e.x.location, top: e.y.location };\n            var dataItem = that.dataItem(draggedElement);\n            var eventData = { dataItems: [dataItem], items: $(draggedElement), draggableEvent: e };\n            var targetCenter;\n            var offsetDelta;\n            var direction;\n\n            if (that.trigger(DRAG, eventData)) {\n                e.preventDefault();\n                return;\n            }\n\n            if (target) {\n                targetCenter = this._getElementCenter(target.element);\n\n                offsetDelta = {\n                    left: Math.round(cursorOffset.left - targetCenter.left),\n                    top: Math.round(cursorOffset.top - targetCenter.top)\n                };\n\n                if (target.appendToBottom) {\n                    that._movePlaceholder(target, null , draggedElement);\n                    return;\n                }\n\n                if (offsetDelta.top < 0) {\n                    direction = \"prev\";\n                } else if (offsetDelta.top > 0) {\n                    direction = \"next\";\n                }\n\n                if (direction) {\n                    if (target.element[0] != that.placeholder[0]) {\n                        that._movePlaceholder(target, direction, draggedElement);\n                    }\n                }\n             }\n             else if (that.placeholder.parent().length) {\n                that.placeholder.remove();\n             }\n        },\n\n        _movePlaceholder: function(target, direction, draggedElement) {\n            var that = this;\n            var placeholder = that.placeholder;\n            var draggableOptions = target.listBox.options.draggable;\n\n            if (placeholder.parent().length) {\n                that.placeholder.remove();\n                if (draggableOptions && draggableOptions.placeholder) {\n                    that.placeholder = kendo.isFunction(draggableOptions.placeholder) ? $(draggableOptions.placeholder.call(that, draggedElement)) : $(draggableOptions.placeholder);\n                } else {\n                    that.placeholder = $(defaultPlaceholder.call(that, draggedElement));\n                }\n            }\n\n            if (!direction) {\n                target.element.append(that.placeholder);\n            } else if (direction === \"prev\") {\n                target.element.before(that.placeholder);\n            } else if (direction === \"next\") {\n                target.element.after(that.placeholder);\n            }\n        },\n\n        _dragend: function(e) {\n            var that = this;\n            var draggedItem = that.draggedElement;\n            var items = that.items();\n            var placeholderIndex = items.not(that.draggedElement).index(that.placeholder);\n            var draggedIndex = items.not(that.placeholder).index(that.draggedElement);\n            var dataItem = that.dataItem(draggedItem);\n            var eventData = { dataItems: [dataItem], items: $(draggedItem) };\n            var connectedListBox = that.placeholder.closest(\".k-widget.k-listbox\").find(\"[data-role='listbox']\").getKendoListBox();\n\n            if (that.trigger(DROP, extend({}, eventData, { draggableEvent: e }))) {\n                e.preventDefault();\n                this._clear();\n                return;\n            }\n\n            if (placeholderIndex >= 0) {\n                if (placeholderIndex !== draggedIndex && !that.trigger(REORDER, extend({}, eventData, { offset: placeholderIndex - draggedIndex }))) {\n                    draggedItem.removeClass(DRAGGEDCLASS);\n                    that.reorder(draggedItem, placeholderIndex);\n                }\n            } else if (connectedListBox) {\n                if (!that.trigger(REMOVE, eventData)) {\n                    that.remove($(draggedItem));\n                }\n\n                if (!connectedListBox.trigger(ADD, eventData)) {\n                    connectedListBox._addItemAt(dataItem, connectedListBox.items().index(that.placeholder));\n                }\n            }\n\n            that._clear();\n            that._draggable.dropped = true;\n\n            that.trigger(DRAGEND, extend({}, eventData, { draggableEvent: e }));\n\n            that._updateToolbar();\n            that._updateAllToolbars();\n        },\n\n        reorder: function(item, index) {\n            var that = this;\n            var dataSource = that.dataSource;\n            var dataItem = that.dataItem(item);\n            var dataItemAtIndex = dataSource.at(index);\n            var itemAtIndex = that.items()[index];\n            var listItem = $(item);\n\n            if (dataItem && itemAtIndex && dataItemAtIndex) {\n                that._removeElement(listItem);\n                that._insertElementAt(listItem, index);\n                that._updateToolbar();\n            }\n        },\n\n        remove: function(items) {\n            var that = this;\n            var listItems = that._getItems(items);\n            var itemsLength = listItems.length;\n            var i;\n\n            that._unbindDataSource();\n            that._unbindDataChange();\n            for (i = 0; i < itemsLength; i++) {\n                that._removeItem($(listItems[i]));\n            }\n            that._bindDataChange();\n            that._bindDataSource();\n            that._syncElement();\n            that._updateToolbar();\n            that._updateAllToolbars();\n        },\n\n        _removeItem: function(item) {\n            var that = this;\n            var dataSource = that.dataSource;\n            var dataItem = that.dataItem(item);\n            var transport = dataSource.transport;\n\n            if (!dataItem || !dataSource) {\n                return;\n            }\n            if (typeof dataItem === typeof \"\") {\n                var data = dataSource._data;\n                for (var i = 0; i < data.length; i++) {\n                    if (dataItem === data[i]) {\n                        data[i] = data[data.length - 1];\n                        data.pop();\n                        break;\n                    }\n                }\n            } else {\n                dataSource.remove(dataItem);\n                if (transport && (transport.destroy || (transport.options || {}).destroy) &&\n                    (!dataItem.isNew || !dataItem.isNew())) {\n                    dataSource._destroyed.push(dataItem);\n                }\n            }\n            that._removeElement(item);\n        },\n\n        _removeElement: function(item) {\n            kendo.destroy(item);\n            $(item).off().remove();\n        },\n\n        dataItem: function(element) {\n            var uniqueIdAttr = kendoAttr(UNIQUE_ID);\n            var uid = $(element).attr(uniqueIdAttr) || $(element).closest(\"[\" + uniqueIdAttr + \"]\").attr(uniqueIdAttr);\n            if (uid) {\n                return this.dataSource.getByUid(uid);\n            }\n            else {\n                return $(element).find(\".k-list-item-text\").html();\n            }\n        },\n\n        _dataItems: function(items) {\n            var dataItems = [];\n            var listItems = $(items);\n            var itemsLength = listItems.length;\n            var i;\n\n            for (i = 0; i < itemsLength; i++) {\n                dataItems.push(this.dataItem(listItems.eq(i)));\n            }\n\n            return dataItems;\n        },\n\n        items: function() {\n            var list = this._getList();\n            return list.children();\n        },\n\n        select: function(items) {\n            var that = this;\n            var selectable = that.selectable;\n            var enabledItems;\n\n            if (isUndefined(items)) {\n                return selectable.value();\n            }\n\n            enabledItems = that.items().filter(items).filter(ENABLED_ITEMS_SELECTOR);\n\n            if (!selectable.options.multiple) {\n                selectable.clear();\n                enabledItems = enabledItems.first();\n            }\n\n            return selectable.value(enabledItems);\n        },\n\n        clearSelection: function() {\n            var that = this;\n            var selectable = that.selectable;\n\n            if (selectable) {\n                selectable.clear();\n            }\n        },\n\n        enable: function(items, enable) {\n            var that = this;\n            var enabled = isUndefined(enable) ? true : !!enable;\n            var listItems = that._getItems(items);\n            var itemsLength = listItems.length;\n            var i;\n\n            for (i = 0; i < itemsLength; i++) {\n                that._enableItem($(listItems[i]), enabled);\n            }\n\n            that._updateAllToolbars();\n        },\n\n        _enableItem: function(item, enable) {\n            var that = this;\n            var dataItem = that.dataItem(item);\n\n            if (dataItem) {\n                if (enable) {\n                    $(item).removeClass(DISABLED_STATE_CLASS);\n                } else {\n                    $(item)\n                        .addClass(DISABLED_STATE_CLASS)\n                        .removeClass(SELECTED_STATE_CLASS);\n                }\n            }\n        },\n\n        setDataSource: function(dataSource) {\n            var that = this;\n\n            that.options.dataSource = dataSource;\n\n            that._dataSource();\n        },\n\n        _dataSource: function() {\n            var that = this;\n            var options = that.options;\n            var dataSource = options.dataSource || {};\n\n            dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n            dataSource.select = that.element;\n            dataSource.fields = [\n                { field: options.dataTextField },\n                { field: options.dataValueField }];\n\n            that._unbindDataSource();\n            that.dataSource = DataSource.create(dataSource);\n            that._bindDataSource();\n\n            if (that.options.autoBind) {\n                that.wrapper.attr(\"aria-busy\", true);\n                that.dataSource.fetch();\n            }\n        },\n\n        _bindDataChange: function() {\n            var dataSource = this.dataSource;\n            if (dataSource._data && dataSource._changeHandler) {\n                dataSource._data.bind(CHANGE, dataSource._changeHandler);\n                dataSource._data.trigger(CHANGE);\n            }\n        },\n\n        _unbindDataChange: function() {\n            var dataSource = this.dataSource;\n            if (dataSource._data && dataSource._changeHandler) {\n                dataSource._data.unbind(CHANGE, dataSource._changeHandler);\n            }\n        },\n\n        _bindDataSource: function() {\n            var that = this;\n            var dataSource = that.dataSource;\n\n            that._dataChangeHandler = that.refresh.bind(that);\n\n            if (dataSource) {\n                dataSource.bind(CHANGE, that._dataChangeHandler);\n            }\n        },\n\n        _unbindDataSource: function() {\n            var that = this;\n            var dataSource = that.dataSource;\n\n            if (dataSource) {\n                dataSource.unbind(CHANGE, that._dataChangeHandler);\n            }\n        },\n\n        _wrapper: function() {\n            var that = this,\n                element = that.element,\n                wrapper = element.parent(\"div.k-listbox\");\n\n            if (!wrapper[0]) {\n                wrapper = element.wrap('<div class=\"k-widget k-listbox\" unselectable=\"on\" />').parent();\n                wrapper[0].style.cssText = element[0].style.cssText;\n                wrapper[0].title = element[0].title;\n                $('<div class=\"k-list-scroller\"><div class=\"k-list k-list-md\"><div class=\"k-list-content\"></div></div></div>').insertBefore(element);\n            }\n\n            that.wrapper = wrapper.addClass(element[0].className).css(\"display\", \"\");\n            that._innerWrapper = $(wrapper[0].firstChild);\n        },\n\n        _list: function() {\n            var that = this,\n                list = $(\"<ul class='\" + LIST_CLASS + \"' role='listbox'></ul>\"),\n                selectable = that.options.selectable,\n                selectableOptions = Selectable.parseOptions(selectable);\n\n            if (selectableOptions.multiple) {\n                list.attr(\"aria-multiselectable\", \"true\");\n            }\n\n            list.appendTo(that.wrapper.find(\".k-list-content\"));\n\n            if (that.options.navigatable) {\n                that._getList().attr(TABINDEX, that._getTabIndex());\n            }\n        },\n\n        _templates: function() {\n            var that = this;\n            var options = this.options;\n            var template;\n\n            if (options.template && typeof options.template == \"string\") {\n                template = kendo.template(options.template);\n            } else if (!options.template) {\n                template = kendo.template('${' + kendo.expr(options.dataTextField, \"data\") + \"}\", { useWithBlock: false });\n            } else {\n                template = options.template;\n            }\n\n            that.templates = {\n                itemTemplate: kendo.template(\"# var item = data.item, r = data.r; # <li class='k-list-item' role='option' aria-selected='false'><span class='k-list-item-text'>#=r(item)#</span></li>\", { useWithBlock: false }),\n                itemContent: template,\n                toolbar: \"<div class='\" + TOOLBAR_CLASS + \"'></div>\"\n            };\n        },\n\n        refresh: function() {\n            var that = this;\n            var view = that.dataSource.view();\n            var template = that.templates.itemTemplate;\n            var html = \"\";\n\n            for (var idx = 0; idx < view.length; idx++) {\n                html += template({ item: view[idx], r: that.templates.itemContent });\n            }\n            that._getList().html(html);\n            that._setItemIds();\n            that._createToolbar();\n            that._syncElement();\n            that._updateToolbar();\n            that._updateAllToolbars();\n            that.trigger(DATABOUND);\n\n            that.wrapper.attr(\"aria-busy\", false);\n        },\n\n        _syncElement: function() {\n            var options = \"\";\n            var view = this.dataSource.view();\n            for (var idx = 0; idx < view.length; idx++) {\n                options += this._option(view[idx][this.options.dataValueField] || view[idx], view[idx][this.options.dataTextField] || view[idx], true);\n            }\n            this.element.html(options);\n        },\n\n        _option: function(dataValue, dataText) {\n            var option = \"<option\";\n\n            if (dataValue !== undefined) {\n                dataValue += \"\";\n\n                if (dataValue.indexOf('\"') !== -1) {\n                    dataValue = dataValue.replace(/\"/g, \"&quot;\");\n                }\n\n                option += ' value=\"' + dataValue + '\"';\n            }\n            option += \" selected>\";\n\n            if (dataText !== undefined) {\n                option += kendo.htmlEncode(dataText);\n            }\n\n            return option += \"</option>\";\n        },\n\n        _setItemId: function(item, id) {\n            if (!item.length) {\n                return;\n            }\n\n            item.attr(kendoAttr(UNIQUE_ID), id).attr(ID, id);\n        },\n\n        _setItemIds: function() {\n            var that = this;\n            var items = that.items();\n            var view = that.dataSource.view();\n            var viewLength = view.length;\n            var i;\n\n            for (i = 0; i < viewLength; i++) {\n                that._setItemId(items.eq(i), view[i].uid);\n            }\n        },\n\n        _selectable: function() {\n            var that = this;\n            var selectable = that.options.selectable;\n            var selectableOptions = Selectable.parseOptions(selectable);\n\n            that.selectable = new Selectable(that._innerWrapper, {\n                aria: true,\n                selectedClass: \"k-selected\",\n                multiple: selectableOptions.multiple,\n                filter: ENABLED_ITEM_SELECTOR,\n                change: that._onSelect.bind(that)\n            });\n        },\n\n        _onSelect: function() {\n            var that = this;\n\n            that._updateToolbar();\n            that._updateAllToolbars();\n            that.trigger(CHANGE);\n        },\n\n        _destroySelectable: function() {\n            var that = this;\n\n            if (that.selectable && that.selectable.element) {\n                that.selectable.destroy();\n                that.selectable = null;\n            }\n        },\n\n        _getList: function() {\n            return this.wrapper.find(LIST_SELECTOR);\n        },\n\n        _getItems: function(items) {\n            return this.items().filter(items);\n        },\n\n        _createToolbar: function() {\n            var that = this;\n            var toolbarOptions = that.options.toolbar;\n            var position = toolbarOptions.position || RIGHT;\n            var toolbarInsertion = position === BOTTOM ? \"insertAfter\" : \"insertBefore\";\n            var tools = toolbarOptions.tools || [];\n            var messages = that.options.messages;\n\n            that._destroyToolbar();\n            that.wrapper.removeClass(TOOLBAR_POSITION_CLASS_NAMES.join(SPACE));\n\n            if (tools.length && tools.length > 0) {\n                var toolbarElement = $(that.templates.toolbar)[toolbarInsertion](that._innerWrapper);\n                that.toolbar = new ToolBar(toolbarElement, extend({}, toolbarOptions, { listBox: that, messages: messages }));\n                that.wrapper.addClass(TOOLBAR_CLASS + DASH + position);\n            }\n        },\n\n        _destroyToolbar: function() {\n            var that = this;\n\n            if (that.toolbar) {\n                that.toolbar.destroy();\n                that.toolbar = null;\n            }\n        },\n\n        _executeCommand: function(commandName) {\n            var that = this;\n            var command = CommandFactory.current.create(commandName, { listBox: that });\n\n            if (command) {\n                command.execute();\n                that._updateToolbar();\n                that._updateAllToolbars();\n            }\n        },\n\n        _updateToolbar: function() {\n            var toolbar = this.toolbar;\n\n            if (toolbar) {\n                toolbar._updateToolStates();\n            }\n        },\n\n        _updateAllToolbars: function() {\n            var listBoxElements = $(\"select[data-role='listbox']\");\n            var elementsLength = listBoxElements.length;\n            var listBox;\n            var i;\n\n            for (i = 0; i < elementsLength; i++) {\n                listBox = $(listBoxElements[i]).data(KENDO_LISTBOX);\n\n                if (listBox) {\n                    listBox._updateToolbar();\n                }\n            }\n        }\n    });\n\n    kendo.ui.plugin(ListBox);\n\n    var CommandFactory = Class.extend({\n        init: function() {\n            this._commands = [];\n        },\n\n        register: function(commandName, commandType) {\n            this._commands.push({\n                commandName: commandName,\n                commandType: commandType\n            });\n        },\n\n        create: function(commandName, options) {\n            var commands = this._commands;\n            var itemsLength = commands.length;\n            var name = commandName ? commandName.toLowerCase() : \"\";\n            var match;\n            var command;\n            var i;\n\n            for (i = 0; i < itemsLength; i++) {\n                command = commands[i];\n\n                if (command.commandName.toLowerCase() === name) {\n                    match = command;\n                    break;\n                }\n            }\n\n            if (match) {\n                return new match.commandType(options);\n            }\n        }\n    });\n    CommandFactory.current = new CommandFactory();\n\n    var ListBoxCommand = Class.extend({\n        init: function(options) {\n            var that = this;\n\n            that.options = extend({}, that.options, options);\n            that.listBox = that.options.listBox;\n        },\n\n        options: {\n            listBox: null\n        },\n\n        getItems: function() {\n            return $(this.listBox.select());\n        },\n\n        execute: noop,\n        canExecute: noop\n    });\n\n    var RemoveItemsCommand = ListBoxCommand.extend({\n        execute: function() {\n            var that = this;\n            var listBox = that.listBox;\n            var items = that.getItems();\n\n            if (!listBox.trigger(REMOVE, { dataItems: listBox._dataItems(items), items: items })) {\n                listBox.remove(items);\n            }\n        },\n\n        canExecute: function() {\n            return this.listBox.select().length > 0;\n        }\n    });\n    CommandFactory.current.register(REMOVE, RemoveItemsCommand);\n\n    var MoveItemsCommand = ListBoxCommand.extend({\n        execute: function() {\n            var that = this;\n\n            if (that.canExecute()) {\n                that.moveItems();\n            }\n        },\n\n        canExecute: noop,\n\n        moveItems: function() {\n            var that = this;\n            var listBox = that.listBox;\n            var options = that.options;\n            var items = that.getItems();\n            var offset = options.offset;\n            var indecesInDom = getSortedDomIndices(items);\n            var movedItems = $.makeArray(items.sort(that.itemComparer));\n            var moveAction = options.moveAction;\n            var movedItem;\n\n            if (!listBox.trigger(REORDER, { dataItems: listBox._dataItems(movedItems), items: $(movedItems), offset: offset })) {\n                while (movedItems.length > 0 && indecesInDom.length > 0) {\n                    movedItem = movedItems[moveAction]();\n\n                    listBox.reorder(movedItem, indecesInDom[moveAction]() + offset);\n                }\n            }\n        },\n\n        options: {\n            offset: 0,\n            moveAction: \"pop\"\n        },\n\n        itemComparer: function(item1, item2) {\n            var indexItem1 = $(item1).index();\n            var indexItem2 = $(item2).index();\n\n            if (indexItem1 === indexItem2) {\n                return 0;\n            } else {\n                return (indexItem1 > indexItem2 ? 1 : (-1));\n            }\n        }\n    });\n\n    var MoveUpItemsCommand = MoveItemsCommand.extend({\n        options: {\n            offset: MOVE_UP_OFFSET,\n            moveAction: \"shift\"\n        },\n\n        canExecute: function() {\n            var items = this.getItems();\n            var domIndices = getSortedDomIndices(items);\n\n            return (domIndices.length > 0 && domIndices[0] > 0);\n        }\n    });\n    CommandFactory.current.register(MOVE_UP, MoveUpItemsCommand);\n\n    var MoveDownItemsCommand = MoveItemsCommand.extend({\n        options: {\n            offset: MOVE_DOWN_OFFSET,\n            moveAction: \"pop\"\n        },\n\n        canExecute: function() {\n            var that = this;\n            var items = that.getItems();\n            var domIndices = getSortedDomIndices(items);\n\n            return (domIndices.length > 0 && $(domIndices).last()[0] < (that.listBox.items().length - 1));\n        }\n    });\n    CommandFactory.current.register(MOVE_DOWN, MoveDownItemsCommand);\n\n    var TransferItemsCommand = ListBoxCommand.extend({\n        options: {\n            filter: ENABLED_ITEM_SELECTOR\n        },\n\n        execute: function() {\n            var that = this;\n            var sourceListBox = that.getSourceListBox();\n            var items = that.getItems().filter(that.options.filter);\n            var dataItems = sourceListBox ? sourceListBox._dataItems(items) : [];\n            var destinationListBox = that.getDestinationListBox();\n            var updatedSelection = that.getUpdatedSelection(items);\n\n            if (destinationListBox && items.length > 0) {\n                if (!destinationListBox.trigger(ADD, { dataItems: dataItems, items: items })) {\n                    destinationListBox.add(dataItems);\n                }\n\n                if (!sourceListBox.trigger(REMOVE, { dataItems: dataItems, items: items })) {\n                    sourceListBox.remove(items);\n                    that.updateSelection(updatedSelection);\n                }\n            }\n        },\n\n        getUpdatedSelection: function(items) {\n\n            if (items.length !== 1) {\n                return null;\n            }\n            var that = this;\n            var itemFilter = that.options.filter;\n            var sourceListBox = that.getSourceListBox();\n            var lastEnabledItem = sourceListBox ? sourceListBox.items().filter(itemFilter).last() : null;\n            var containsLastItem = $(items).filter(lastEnabledItem).length > 0;\n            var itemToSelect = containsLastItem ? $(items).prevAll(itemFilter)[0] : $(items).nextAll(itemFilter)[0];\n\n            if (itemToSelect) {\n                return itemToSelect;\n            } else {\n                return null;\n            }\n        },\n\n        updateSelection: function(item) {\n            var sourceListBox = this.getSourceListBox();\n\n            if (sourceListBox && item) {\n                sourceListBox.select($(item));\n                sourceListBox.selectable.trigger(CHANGE);\n                sourceListBox._scrollIntoView(item);\n            }\n        },\n\n        getSourceListBox: noop,\n        getDestinationListBox: noop\n    });\n\n    var TransferItemsToCommand = TransferItemsCommand.extend({\n        canExecute: function() {\n            var sourceListBox = this.getSourceListBox();\n\n            return (sourceListBox ? sourceListBox.select().length > 0 : false);\n        },\n\n        getSourceListBox: function() {\n            return this.listBox;\n        },\n\n        getDestinationListBox: function() {\n            var sourceListBox = this.getSourceListBox();\n            return sourceListBox && sourceListBox.options.connectWith ? $(HASH + sourceListBox.options.connectWith).data(KENDO_LISTBOX) : null;\n        },\n\n        getItems: function() {\n            var sourceListBox = this.getSourceListBox();\n            return sourceListBox ? $(sourceListBox.select()) : $();\n        }\n    });\n    CommandFactory.current.register(TRANSFER_TO, TransferItemsToCommand);\n\n    var TransferItemsFromCommand = TransferItemsCommand.extend({\n        canExecute: function() {\n            var sourceListBox = this.getSourceListBox();\n\n            return (sourceListBox ? sourceListBox.select().length > 0 : false);\n        },\n\n        getSourceListBox: function() {\n            var destinationListBox = this.getDestinationListBox();\n            return (destinationListBox && destinationListBox.options.connectWith) ? $(HASH + destinationListBox.options.connectWith).data(KENDO_LISTBOX) : null;\n        },\n\n        getDestinationListBox: function() {\n            return this.listBox;\n        },\n\n        getItems: function() {\n            var sourceListBox = this.getSourceListBox();\n            return sourceListBox ? $(sourceListBox.select()) : $();\n        }\n    });\n    CommandFactory.current.register(TRANSFER_FROM, TransferItemsFromCommand);\n\n    var TransferAllItemsToCommand = TransferItemsToCommand.extend({\n        canExecute: function() {\n            var sourceListBox = this.getSourceListBox();\n\n            return (sourceListBox ? sourceListBox.wrapper.find(ENABLED_ITEMS_SELECTOR).length > 0 : false);\n        },\n\n        getItems: function() {\n            var sourceListBox = this.getSourceListBox();\n            return sourceListBox ? sourceListBox.items() : $();\n        },\n\n        getUpdatedSelection: noop,\n        updateSelection: noop\n    });\n    CommandFactory.current.register(TRANSFER_ALL_TO, TransferAllItemsToCommand);\n\n    var TransferAllItemsFromCommand = TransferItemsFromCommand.extend({\n        canExecute: function() {\n            var sourceListBox = this.getSourceListBox();\n\n            return (sourceListBox ? sourceListBox.wrapper.find(ENABLED_ITEMS_SELECTOR).length > 0 : false);\n        },\n\n        getItems: function() {\n            var sourceListBox = this.getSourceListBox();\n            return sourceListBox ? sourceListBox.items() : $();\n        },\n\n        getUpdatedSelection: noop,\n        updateSelection: noop\n    });\n    CommandFactory.current.register(TRANSFER_ALL_FROM, TransferAllItemsFromCommand);\n\n    var ToolBar = Class.extend({\n        init: function(element, options) {\n            var that = this;\n\n            that.element = $(element).addClass(TOOLBAR_CLASS);\n            that.options = extend({}, that.options, options);\n            that.listBox = that.options.listBox;\n\n            that._initTemplates();\n            that._createTools();\n            that._updateToolStates();\n            that._attachEventHandlers();\n        },\n\n        destroy: function() {\n            var that = this;\n\n            that._detachEventHandlers();\n            kendo.destroy(that.element);\n            that.element.remove();\n            that.element = null;\n        },\n\n        options: {\n            position: RIGHT,\n            tools: []\n        },\n\n        _initTemplates: function() {\n            this.templates = {\n                tool: kendoTemplate(\n                    \"<li>\" +\n                        \"<a href='\\\\\\\\#' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button' data-command='#= command #' title='#= text #' aria-label='#= text #' role='button'>\" +\n                            \"<span class='k-button-icon k-icon #= iconClass #'></span>\" +\n                        \"</a>\" +\n                    \"</li>\")\n            };\n        },\n\n        _createTools: function() {\n            var that = this;\n            var tools = that.options.tools;\n            var toolsLength = tools.length;\n            var toolsMessages = that.options.messages.tools;\n            var toolList = that._createToolList();\n            var tool;\n            var i;\n\n            for (i = 0; i < toolsLength; i++) {\n                tool = extend({}, ToolBar.defaultTools[tools[i]], { text: toolsMessages[tools[i]] });\n\n                if (tool) {\n                    toolList.append($(that.templates.tool(tool)));\n                }\n            }\n\n            that.element.append(toolList);\n        },\n\n        _createToolList: function() {\n            return $(\"<ul class='k-reset' />\");\n        },\n\n        _attachEventHandlers: function() {\n            var that = this;\n\n            that.element.on(CLICK, TOOL_SELECTOR, that._onToolClick.bind(that));\n        },\n\n        _detachEventHandlers: function() {\n            this.element.off(NS).find(\"*\").off(NS);\n        },\n\n        _onToolClick: function(e) {\n            e.preventDefault();\n\n            this._executeToolCommand($(e.currentTarget).data(COMMAND));\n        },\n\n        _executeToolCommand: function(command) {\n            var that = this;\n            var listBox = that.listBox;\n\n            if (listBox) {\n                listBox._executeCommand(command);\n            }\n        },\n\n        _updateToolStates: function() {\n            var that = this;\n            var tools = that.options.tools;\n            var toolsLength = tools.length;\n            var i;\n\n            for (i = 0; i < toolsLength; i++) {\n                that._updateToolState(tools[i]);\n            }\n        },\n\n        _updateToolState: function(toolName) {\n            var that = this;\n            var command = CommandFactory.current.create(toolName, { listBox: that.listBox });\n            var tool = that.element.find(\"[data-command='\" + toolName + \"']\");\n            var toolElement = tool[0];\n\n            if (toolElement && command && command.canExecute) {\n                if (command.canExecute()) {\n                    tool.removeClass(DISABLED_STATE_CLASS).removeAttr(TABINDEX);\n                } else {\n                    tool.addClass(DISABLED_STATE_CLASS).attr(TABINDEX, \"-1\");\n                }\n            }\n        }\n    });\n\n    ToolBar.defaultTools = {\n        remove: {\n            command: REMOVE,\n            iconClass: \"k-i-x\"\n        },\n        moveUp: {\n            command: MOVE_UP,\n            iconClass: \"k-i-arrow-60-up\"\n        },\n        moveDown: {\n            command: MOVE_DOWN,\n            iconClass: \"k-i-arrow-60-down\"\n        },\n        transferTo: {\n            command: TRANSFER_TO,\n            iconClass: \"k-i-arrow-60-right\"\n        },\n        transferFrom: {\n            command: TRANSFER_FROM,\n            iconClass: \"k-i-arrow-60-left\"\n        },\n        transferAllTo: {\n            command: TRANSFER_ALL_TO,\n            iconClass: \"k-i-arrow-double-60-right\"\n        },\n        transferAllFrom: {\n            command: TRANSFER_ALL_FROM,\n            iconClass: \"k-i-arrow-double-60-left\"\n        }\n    };\n\n    extend(ListBox, {\n        ToolBar: ToolBar\n    });\n\n    function isInputElement(element) {\n        return $(element).is(\":button,a,:input,a>.k-icon,textarea,span.k-select,span.k-icon,span.k-link,label.k-checkbox-label,.k-input,.k-multiselect-wrap,.k-picker-wrap,.k-picker-wrap>.k-selected-color,.k-tool-icon,.k-dropdownlist\");\n    }\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","depends","$","window","kendo","jQuery","undefined","kendoAttr","attr","data","keys","kendoTemplate","template","Widget","ui","DataSource","Selectable","DataBoundWidget","Class","extend","noop","DASH","DOT","SPACE","HASH","KENDO_LISTBOX","NS","DISABLED_STATE_CLASS","SELECTED_STATE_CLASS","ENABLED_ITEM_SELECTOR","ENABLED_ITEMS_SELECTOR","TOOLBAR_CLASS","TOOL_SELECTOR","FOCUSED_CLASS","DRAG_CLUE_CLASS","DROP_HINT_CLASS","LIST_CLASS","LIST_SELECTOR","CLICK","KEYDOWN","BLUR","outerWidth","_outerWidth","outerHeight","_outerHeight","CHANGE","DATABOUND","ADD","REMOVE","REORDER","MOVE_UP","MOVE_DOWN","TRANSFER_TO","TRANSFER_FROM","TRANSFER_ALL_TO","TRANSFER_ALL_FROM","DRAGGEDCLASS","UNIQUE_ID","ID","TABINDEX","COMMAND","MOVE_UP_OFFSET","MOVE_DOWN_OFFSET","DRAGSTART","DRAG","DROP","DRAGEND","DEFAULT_FILTER","RIGHT","BOTTOM","TOOLBAR_POSITION_CLASS_NAMES","getSortedDomIndices","items","indices","map","item","index","isUndefined","value","defaultHint","element","clone","addClass","defaultPlaceholder","ListBox","init","options","that","this","fn","call","_wrapper","_list","_ariaLabel","_getList","hide","dataSource","dataTextField","dataValueField","_templates","_selectable","_dataSource","_createToolbar","_createDraggable","_createNavigatable","destroy","isNaN","_listTabIndex","off","_unbindDataSource","_destroySelectable","_destroyToolbar","wrapper","_target","_draggable","placeholder","setOptions","events","autoBind","selectable","draggable","dropSources","connectWith","navigatable","toolbar","position","tools","messages","remove","moveUp","moveDown","transferTo","transferFrom","transferAllTo","transferAllFrom","add","dataItems","length","itemsLength","list","i","_unbindDataChange","_addItem","_bindDataChange","_bindDataSource","_syncElement","dataItem","templates","itemTemplate","r","itemContent","_setItemId","uid","appendTo","_data","push","_addItemAt","_insertElementAt","insertAfter","children","eq","prepend","on","_click","bind","_keyDown","_blur","_getTabIndex","tabindex","removeAttr","removeClass","e","target","currentTarget","oldTarget","activeEl","_activeElement","isContained","contains","isInputElement","focus","_getNavigatableItem","key","current","filter","first","UP","prevAll","DOWN","nextAll","_scrollIntoView","parent","itemOffsetTop","offsetTop","contentScrollTop","scrollTop","contentOffsetHeight","clientHeight","bottomDistance","offsetHeight","keyCode","shouldPreventDefault","shiftKey","ctrlKey","_shiftSelecting","DELETE","_executeCommand","preventDefault","clearSelection","hasClass","select","trigger","SPACEBAR","LEFT","focusElement","hint","Error","Draggable","isFunction","dragstart","_dragstart","dragcancel","_clear","drag","_drag","dragend","_dragend","draggedElement","eventData","draggableEvent","enabled","is","_findElementUnderCursor","elementUnderCursor","sender","show","_findTarget","elementNode","node","closest","has","listBox","appendToBottom","_searchConnectedListBox","_getElementCenter","center","getOffset","top","left","connectedListBox","originalElement","closestContainer","find","getKendoListBox","inArray","cursorOffset","x","location","y","targetCenter","offsetDelta","direction","Math","round","_movePlaceholder","draggableOptions","append","before","after","draggedItem","placeholderIndex","not","draggedIndex","offset","reorder","dropped","_updateToolbar","_updateAllToolbars","dataItemAtIndex","at","itemAtIndex","listItem","_removeElement","listItems","_getItems","_removeItem","transport","pop","isNew","_destroyed","uniqueIdAttr","getByUid","html","_dataItems","enabledItems","multiple","clear","enable","_enableItem","setDataSource","Array","isArray","fields","field","create","fetch","_changeHandler","unbind","_dataChangeHandler","refresh","wrap","style","cssText","title","insertBefore","className","css","_innerWrapper","firstChild","selectableOptions","parseOptions","expr","useWithBlock","view","idx","_setItemIds","_option","dataValue","dataText","option","indexOf","replace","htmlEncode","viewLength","aria","selectedClass","change","_onSelect","toolbarOptions","toolbarInsertion","join","toolbarElement","ToolBar","commandName","command","CommandFactory","execute","_updateToolStates","listBoxElements","elementsLength","plugin","_commands","register","commandType","commands","toLowerCase","match","ListBoxCommand","getItems","canExecute","RemoveItemsCommand","MoveItemsCommand","moveItems","indecesInDom","movedItems","makeArray","sort","itemComparer","moveAction","movedItem","item1","item2","indexItem1","indexItem2","MoveUpItemsCommand","domIndices","MoveDownItemsCommand","last","TransferItemsCommand","sourceListBox","getSourceListBox","destinationListBox","getDestinationListBox","updatedSelection","getUpdatedSelection","updateSelection","itemFilter","lastEnabledItem","containsLastItem","itemToSelect","TransferItemsToCommand","TransferItemsFromCommand","TransferAllItemsToCommand","TransferAllItemsFromCommand","_initTemplates","_createTools","_attachEventHandlers","_detachEventHandlers","tool","toolsLength","toolsMessages","toolList","_createToolList","defaultTools","text","_onToolClick","_executeToolCommand","_updateToolState","toolName","toolElement","iconClass","amd","a1","a2","a3"],"mappings":"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"}